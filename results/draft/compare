eta =  0.1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    1         5.69      0.2837     0.2793     0.4472     4.4721
    2        10.76      0.2849     0.2805     0.4472     4.4721
    3        15.85      0.2859     0.2816     0.4472     4.4721
    4        20.94      0.2874     0.283      0.4472     4.4721
    5        26.05      0.2888     0.2844     0.4472     4.4721

iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    1         5.64      0.2813     0.277      0.0447     4.4721
    2        10.66      0.2814     0.2771     0.0447     4.4721
    3         15.7      0.2815     0.2772     0.0447     4.4721
    4        20.74      0.2816     0.2773     0.0447     4.4721
    5        25.77      0.2818     0.2775     0.0447     4.4721
    6        30.82      0.2819     0.2776     0.0447     4.4721
    7        35.86      0.282      0.2777     0.0447     4.4721
    8        40.97      0.2821     0.2778     0.0447     4.4721



 /home/duc/Documents/Research/SSVI-TF/venv/bin/python3 /home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_2D_robust.py
Generating synthetic data ...
Generating synthetic data took:  0.07375407218933105
Tensor dimensions:  [50, 50]
Optimization metrics:
Using Ada Delta with window size =  5
Mean update scheme:  N
Covariance update :  S
k1 samples =  128  k2 samples =  64
eta =  1  cov eta =  1  sigma eta =  1 ### changing eta
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    50       29.79      0.2775     0.2748     4.4721       0
   100       59.29      0.2257     0.2233     1.4327       0
   150       88.63      0.1967     0.1944     0.8191       0
   200       117.94     0.1788     0.1764     0.3162       0
   250       147.28     0.1655     0.163      0.2402       0
   300       176.69     0.1551     0.1527     0.1947       0
   350       206.31     0.1466     0.1442     0.1611       0
   400       235.69     0.1396     0.1371      0.14        0
   450       265.14     0.1335     0.131      0.1227       0
   500       294.66     0.1282     0.1257     0.1076       0
   550       324.3      0.1235     0.121      0.0968       0
   600       354.07     0.1192     0.1168     0.0899       0



Generating synthetic data ...
Generating synthetic data took:  0.07460355758666992
Tensor dimensions:  [50, 50]
Optimization metrics:
Using Ada Delta with window size =  5
Mean update scheme:  N
Covariance update :  S
k1 samples =  128  k2 samples =  64
eta =  1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    50       30.09      0.2775     0.2748     4.4721       0
   100       59.76      0.2257     0.2233     1.4327       0
Switching to ada grad with eta =  0.9
   150        89.5      0.1937     0.1915     2.846        0
   200       119.25     0.0496     0.0496     2.846        0
   250       149.5      0.0542     0.0566     2.6139       0
   300       179.62     0.1029     0.1077     2.843        0
   350       209.67     0.2254     0.2352     2.8447       0


/home/duc/Documents/Research/SSVI-TF/venv/bin/python3 /home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_2D_robust.py
Generating synthetic data ...
Generating synthetic data took:  0.07490658760070801
Tensor dimensions:  [50, 50]
Optimization metrics:
Using Ada Delta with window size =  5
Mean update scheme:  N
Covariance update :  S
k1 samples =  128  k2 samples =  64
eta =  1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    50       30.14      0.2775     0.2748     4.4721       0
   100       59.73      0.2257     0.2233     1.4327       0
Switching to ada grad with eta =  0.5
   150       89.21      0.1952     0.1929     1.5811       0
   200       118.84     0.106      0.1036     1.5811       0
   250       149.05     0.0799     0.0784     0.7096       0
   300       179.26     0.0672     0.0662     0.5898       0
   350       209.42      0.06      0.0595     1.0609       0
   400       239.6      0.0563     0.0563     1.4695       0
   450       269.8      0.0546     0.056      1.5461       0
   500       300.01     0.0574     0.0601     1.5515       0
   550       330.45     0.0753     0.0795     1.5639       0
   600       360.67     0.1177     0.1223     1.565        0
   650       390.68     0.1848     0.1928     1.5675       0
   700       420.5      0.2784     0.2886     1.5641       0
   750       449.97     0.3872     0.3988     1.5623       0
   800       479.45     0.5027     0.5152     1.5575       0
   850       508.95     0.6226     0.6356     1.5521       0
   900       538.48     0.7456     0.7593     1.5497       0
   950       568.17     0.8716     0.8859     1.5364       0
   1000      597.82     1.0003     1.0153     1.5187       0
   1050      627.37     1.1316     1.1471     1.4968       0
   1100      656.97     1.2653     1.2815     1.4765       0
   1150      686.5      1.4012     1.4181     1.4566       0
   1200      716.03     1.5394     1.5568     1.4344       0
   1250      745.55     1.6796     1.6977     1.4163       0
   1300      775.41     1.8218     1.8406     1.3976       0
   1350      805.1      1.9659     1.9853     1.3788       0
   1400      834.73     2.1119     2.1319     1.3627       0
   1450      864.4      2.2596     2.2804     1.3453       0
   1500      894.0      2.4091     2.4305     1.3255       0
   1550      923.63     2.5602     2.5822     1.3107       0
   1600      953.24     2.7128     2.7356     1.296        0
   1650      982.81     2.8671     2.8905     1.282        0
   1700     1012.38     3.0228     3.0469     1.2675       0
   1750     1041.85      3.18      3.2048     1.2536       0
   1800      1071.5     3.3385     3.364      1.2402       0
   1850     1101.17     3.4985     3.5246     1.2287       0
   1900     1130.67     3.6597     3.6866     1.2149       0
   1950     1160.25     3.8222     3.8498     1.2036       0
   2000     1189.75     3.9859     4.0142     1.1915       0
   2050     1219.26     4.1508     4.1798     1.1805       0
   2100     1248.81     4.3169     4.3466     1.1696       0
   2150      1278.5     4.4841     4.5146     1.1574       0
   2200     1308.13     4.6524     4.6836     1.1477       0
   2250     1337.72     4.8218     4.8537     1.1362       0
   2300      1367.3     4.9922     5.0248     1.126        0
   2350     1397.01     5.1637     5.197      1.117        0
   2400     1426.47     5.3361     5.3702     1.1093       0
   2450     1455.93     5.5095     5.5443      1.1         0
   2500     1485.48     5.6838     5.7193      1.09        0
   2550     1514.98     5.8591     5.8953     1.0808       0
   2600     1544.62     6.0352     6.0722     1.0722       0
   2650     1574.13     6.2122     6.2499     1.0639       0
   2700     1603.85      6.39      6.4284     1.0534       0
   2750      1633.4     6.5686     6.6078     1.0459       0
   2800     1662.89     6.7481     6.788      1.0399       0
   2850      1692.4     6.9283     6.969      1.0314       0
   2900     1722.08     7.1093     7.1508     1.0235       0
   2950     1752.06     7.2911     7.3333     1.0169       0
   3000     1781.57     7.4735     7.5165     1.009        0
   3050     1811.25     7.6567     7.7004     1.0026       0
   3100     1840.78     7.8405     7.885      0.9939       0
   3150     1870.45     8.0251     8.0704     0.9876       0
   3200     1900.27     8.2104     8.2564     0.9819       0
   3250      1930.2     8.3963     8.443      0.9754       0
   3300     1959.63     8.5828     8.6303     0.968        0
   3350     1989.21     8.7699     8.8182     0.9618       0
   3400     2018.75     8.9577     9.0068     0.9551       0
   3450     2048.19     9.1461     9.1959     0.9491       0
   3500     2077.78     9.3351     9.3856     0.943        0
   3550     2107.32     9.5246     9.576      0.9374       0
   3600     2136.98     9.7146     9.7668     0.9322       0
   3650     2166.66     9.9053     9.9582     0.9267       0
   3700     2196.44    10.0964    10.1501     0.9194       0
   3750     2226.13    10.2881    10.3426     0.9158       0
   3800     2255.65    10.4803    10.5355     0.9097       0
   3850     2285.24     10.673     10.729     0.9048       0
   3900     2314.82    10.8662     10.923     0.8987       0
   3950     2344.39    11.0599    11.1175     0.8932       0
   4000     2374.04    11.2541    11.3125     0.8888       0
   4050     2403.57    11.4487    11.5079     0.8837       0
   4100     2433.06    11.6438    11.7038     0.8783       0
   4150     2462.63    11.8394    11.9001     0.8739       0
   4200     2492.16    12.0354    12.0969     0.8688       0
   4250     2521.74    12.2318    12.2942     0.8645       0
   4300     2551.34    12.4287    12.4918     0.8611       0
   4350     2580.85    12.6259    12.6899     0.8565       0
   4400     2610.43    12.8236    12.8884     0.8518       0
   4450     2640.01    13.0218    13.0873     0.8464       0
   4500     2669.73    13.2203    13.2866     0.8422       0
   4550     2699.22    13.4191    13.4863     0.8376       0
   4600     2728.81    13.6184    13.6863     0.8338       0
   4650      2758.4    13.8181    13.8868     0.8296       0
   4700     2788.14    14.0181    14.0876     0.8253       0
   4750     2817.83    14.2185    14.2888     0.8222       0
   4800     2847.52    14.4192    14.4904     0.8173       0
   4850     2877.01    14.6203    14.6923     0.8139       0
   4900     2906.51    14.8218    14.8945     0.8096       0
   4950     2936.24    15.0235    15.0971     0.806        0
   5000     2965.79    15.2257      15.3      0.8018       0
   5050     2995.37    15.4281    15.5033     0.799        0
   5100     3025.18    15.6309    15.7069     0.7941       0
   5150      3054.7     15.834    15.9108     0.7916       0
   5200     3084.21    16.0374     16.115     0.787        0
   5250     3113.71    16.2411    16.3195     0.7838       0
   5300     3143.39    16.4451    16.5243     0.7801       0
   5350     3173.08    16.6494    16.7294     0.7767       0
   5400     3202.77     16.854    16.9349     0.7729       0
   5450     3232.33    17.0589    17.1406     0.7704       0
   5500     3261.97    17.2641    17.3466     0.7667       0
   5550     3291.44    17.4696    17.5529     0.7635       0
   5600     3320.99    17.6753    17.7595     0.7599       0
   5650      3350.5    17.8814    17.9663     0.7568       0
   5700     3380.04    18.0877    18.1734     0.7533       0
   5750     3409.62    18.2942    18.3808     0.7501       0
   5800      3439.4     18.501    18.5884     0.7468       0
   5850     3469.06    18.7081    18.7963     0.7443       0
   5900     3498.64    18.9154    19.0044     0.7412       0
   5950     3528.41     19.123    19.2128     0.7381       0
   6000     3557.93    19.3308    19.4215     0.736        0
   6050     3587.49    19.5389    19.6304     0.7321       0
   6100     3616.99    19.7472    19.8395     0.7295       0
   6150     3646.75    19.9557    20.0489     0.7262       0
   6200     3676.33    20.1645    20.2585     0.7242       0
   6250     3705.87    20.3735    20.4683     0.7208       0
   6300     3735.57    20.5827    20.6783     0.7179       0
   6350     3765.25    20.7922    20.8886     0.7154       0
   6400      3794.9    21.0018    21.0991     0.7131       0
   6450      3824.7    21.2117    21.3098     0.7097       0
   6500     3854.35    21.4218    21.5208     0.7079       0
   6550     3883.87    21.6321    21.7319     0.7051       0
   6600     3913.54    21.8426    21.9432     0.7023       0
   6650      3943.1    22.0533    22.1548     0.6992       0
   6700      3972.6    22.2643    22.3665     0.6975       0
   6750     4002.21    22.4754    22.5785     0.6939       0
   6800     4031.76    22.6868    22.7907     0.6919       0
   6850     4061.41    22.8983    23.0031     0.6903       0
   6900     4091.22     23.11     23.2156     0.6874       0
   6950     4120.76     23.322    23.4284     0.6853       0
   7000     4150.26     23.534    23.6413     0.6823       0
   7050     4179.87    23.7463    23.8545     0.6797       0
   7100     4209.45    23.9588    24.0678     0.6771       0
   7150     4239.03    24.1714    24.2812     0.6749       0
   7200     4268.56    24.3843    24.4949     0.6729       0
   7250     4298.09    24.5973    24.7088     0.6707       0
   7300     4327.74    24.8105    24.9228     0.6687       0
   7350     4357.26    25.0239     25.137     0.6666       0
   7400      4386.8    25.2374    25.3514     0.6638       0
   7450      4416.3    25.4511    25.5659     0.6611       0
   7500     4445.85     25.665    25.7806     0.6597       0
   7550     4475.34     25.879    25.9955     0.6573       0
   7600     4504.99    26.0932    26.2105     0.655        0
   7650     4534.51    26.3075    26.4257     0.6532       0
   7700     4564.07     26.522    26.6411     0.6509       0
   7750     4593.62    26.7367    26.8566     0.6493       0
   7800     4623.21    26.9515    27.0722     0.6474       0
   7850     4652.77    27.1665    27.2881     0.6452       0
   7900      4682.4    27.3817    27.5041     0.6429       0
   7950     4712.18     27.597    27.7202     0.6408       0
   8000     4741.85    27.8124    27.9365     0.6393       0
   8050     4771.54     28.028    28.1529     0.6367       0
   8100     4801.14    28.2437    28.3694     0.6344       0
   8150     4830.78    28.4595    28.5861     0.6325       0
   8200     4860.51    28.6755     28.803     0.6309       0
   8250     4890.23    28.8916     29.02      0.6294       0
   8300     4919.91    29.1079    29.2371     0.6269       0
   8350     4949.53    29.3244    29.4544     0.6253       0
   8400     4979.11    29.5409    29.6717     0.6237       0
   8450     5008.68    29.7576    29.8893     0.6218       0
   8500     5038.17    29.9744     30.107     0.6195       0
   8550      5067.8    30.1914    30.3248     0.6184       0
   8600     5097.37    30.4085    30.5427     0.6168       0
   8650     5126.89    30.6257    30.7608     0.6148       0
   8700     5156.41     30.843     30.979     0.6125       0
   8750     5185.98    31.0605    31.1973     0.6107       0
   8800      5215.7    31.2781    31.4157     0.6095       0
   8850     5245.34    31.4958    31.6343     0.6076       0
   8900     5274.97    31.7136     31.853     0.6052       0
   8950     5304.55    31.9316    32.0718     0.6044       0
   9000     5334.18    32.1496    32.2907     0.6024       0
   9050     5363.68    32.3678    32.5097     0.6003       0
   9100      5393.2    32.5861    32.7289     0.599        0
   9150      5422.8    32.8046    32.9482     0.5978       0
   9200      5452.6    33.0231    33.1676     0.5954       0
   9250     5482.17    33.2418    33.3871     0.5943       0
   9300     5511.89    33.4605    33.6067     0.5929       0
   9350     5541.49    33.6794    33.8264     0.5905       0
   9400     5571.19    33.8984    34.0463     0.5891       0
   9450     5600.84    34.1175    34.2662     0.5881       0
   9500     5630.49    34.3368    34.4863     0.586        0
   9550     5659.98    34.5561    34.7065     0.5846       0
   9600     5689.57    34.7755    34.9267     0.5832       0
   9650     5719.37     34.995    35.1471     0.5815       0
   9700     5748.99    35.2146    35.3676     0.5805       0
   9750     5778.59    35.4344    35.5882     0.579        0
   9800     5808.21    35.6542    35.8089     0.5774       0
   9850     5837.72    35.8742    36.0297     0.5763       0
   9900     5867.37    36.0942    36.2506     0.5745       0
   9950     5896.86    36.3144    36.4716     0.5728       0
  10000     5926.47    36.5346    36.6927     0.5716       0
  10050     5956.21     36.755    36.9139     0.5702       0
  10100     5985.75    36.9754    37.1352     0.5684       0
  10150      6015.3    37.1959    37.3566     0.5673       0
  10200     6044.78    37.4166    37.5781     0.5658       0
  10250     6074.66    37.6373    37.7997     0.5643       0
  10300     6104.41    37.8581    38.0214     0.5629       0
  10350     6134.01     38.079    38.2431     0.5614       0
  10400     6163.55      38.3     38.4649     0.5601       0
  10450     6193.18     38.521    38.6869     0.5587       0
  10500     6222.81    38.7422    38.9089     0.5577       0
  10550     6252.32    38.9635     39.131     0.5561       0
  10600     6282.12    39.1848    39.3532     0.5545       0
  10650     6311.63    39.4062    39.5755     0.5534       0
  10700     6341.16    39.6278    39.7979     0.5526       0
  10750     6370.77    39.8494    40.0204     0.5511       0
  10800     6400.38    40.0711    40.2429     0.5495       0
  10850     6430.07    40.2928    40.4656     0.5486       0
  10900     6459.59    40.5147    40.6883     0.5469       0
  10950     6489.19    40.7367    40.9111     0.5463       0
  11000     6518.71    40.9587     41.134     0.5443       0
  11050     6548.22    41.1808     41.357     0.5432       0
  11100     6577.91     41.403    41.5801     0.5421       0
  11150     6607.45    41.6253    41.8032     0.5411       0
  11200     6636.95    41.8476    42.0264     0.5401       0
  11250     6666.46    42.0701    42.2497     0.5383       0
  11300      6696.1    42.2926    42.4731     0.5373       0
  11350     6725.68    42.5152    42.6965     0.536        0
  11400     6755.35    42.7378     42.92      0.5347       0
  11450     6784.93    42.9606    43.1437     0.5338       0
  11500     6814.51    43.1834    43.3673     0.5324       0
  11550     6844.02    43.4063    43.5911     0.5313       0
  11600     6873.58    43.6292    43.8149     0.5299       0
  11650     6903.26    43.8522    44.0388     0.5288       0
  11700     6933.07    44.0753    44.2627     0.5276       0
  11750     6962.93    44.2985    44.4868     0.5266       0
  11800      6992.7    44.5218    44.7109     0.5254       0
  11850     7022.32    44.7451    44.9351     0.5239       0
  11900      7052.0    44.9685    45.1594     0.5235       0
  11950     7081.47     45.192    45.3837     0.5221       0
  12000     7111.11    45.4155    45.6081     0.5213       0
  12050     7140.88    45.6391    45.8326     0.5201       0
  12100     7170.57    45.8628    46.0571     0.5191       0
  12150     7200.16    46.0865    46.2817     0.5179       0
  12200     7229.86    46.3103    46.5064     0.5164       0
  12250     7259.59    46.5342    46.7311     0.5155       0
  12300     7289.08    46.7581    46.9559     0.5143       0
  12350      7318.6    46.9821    47.1808     0.5138       0
  12400     7348.11    47.2062    47.4057     0.5126       0
  12450     7377.62    47.4303    47.6307     0.5111       0
  12500     7407.13    47.6545    47.8558     0.5102       0
  12550     7436.72    47.8788    48.0809     0.5092       0
  12600     7466.26    48.1031    48.3061     0.5081       0
  12650      7495.9    48.3275    48.5314     0.507        0
  12700     7525.72     48.552    48.7567     0.5062       0
  12750     7555.22    48.7765    48.9821     0.5053       0
  12800     7584.82    49.0011    49.2076     0.5047       0
  12850     7614.32    49.2257    49.4331     0.5034       0
  12900     7643.85    49.4504    49.6586     0.502        0
  12950     7673.38    49.6752    49.8843     0.5017       0
  13000     7702.86      49.9     50.1099     0.5001       0
  13050     7732.35    50.1249    50.3357     0.4992       0
  13100     7761.89    50.3498    50.5615     0.4981       0
  13150     7791.57    50.5748    50.7873     0.4975       0
  13200     7821.13    50.7999    51.0133     0.4966       0
  13250     7850.67     51.025    51.2393     0.4958       0
  13300     7880.27    51.2502    51.4653     0.4944       0
  13350     7909.93    51.4754    51.6914     0.4933       0
  13400     7939.44    51.7006    51.9175     0.4924       0
  13450     7969.16     51.926    52.1438     0.4916       0
  13500     7998.73    52.1514     52.37      0.4908       0
  13550     8028.43    52.3768    52.5963     0.4901       0
  13600     8058.28    52.6023    52.8227     0.4889       0
  13650     8087.92    52.8279    53.0491     0.488        0
  13700     8117.44    53.0535    53.2756     0.487        0
  13750     8146.96    53.2792    53.5022     0.4862       0
  13800     8176.48    53.5049    53.7288     0.485        0
  13850     8205.99    53.7307    53.9554     0.4845       0
  13900     8235.58    53.9565    54.1821     0.4837       0
  13950     8265.14    54.1824    54.4089     0.4828       0
  14000     8294.66    54.4083    54.6357     0.4818       0
  14050     8324.43    54.6343    54.8625     0.481        0
  14100     8354.13    54.8603    55.0894     0.4799       0
  14150     8383.77    55.0864    55.3164     0.4793       0
  14200     8413.45    55.3125    55.5434     0.4782       0
  14250     8443.12    55.5387    55.7705     0.4775       0
  14300      8473.0     55.765    55.9976     0.4764       0
  14350     8502.56    55.9913    56.2247     0.476        0
  14400      8532.1    56.2176    56.4519     0.4748       0
  14450     8561.59     56.444    56.6792     0.4738       0
  14500     8591.16    56.6704    56.9065     0.4732       0
  14550     8620.68    56.8969    57.1339     0.4728       0
  14600     8650.21    57.1235    57.3613     0.4714       0
  14650     8679.79     57.35     57.5887     0.4704       0
  14700     8709.51    57.5766    57.8162     0.4697       0
  14750     8739.01    57.8033    58.0438     0.4688       0
  14800     8768.56     58.03     58.2714     0.4685       0
  14850     8798.02    58.2568     58.499     0.4675       0
  14900     8827.56    58.4836    58.7267     0.4667       0
  14950     8857.21    58.7104    58.9544     0.4659       0
  15000     8886.76    58.9373    59.1822     0.465        0
  15050     8916.44    59.1643     59.41      0.4641       0
  15100     8945.94    59.3913    59.6378     0.4633       0
  15150     8975.49    59.6183    59.8657     0.4623       0
  15200     9005.01    59.8454    60.0937     0.462        0
  15250     9034.62    60.0725    60.3217     0.4611       0
  15300     9064.16    60.2996    60.5497     0.4601       0
  15350     9093.89    60.5269    60.7778     0.4596       0
  15400      9123.5    60.7541     61.006     0.4589       0
  15450     9153.11    60.9814    61.2341     0.4577       0
  15500      9182.8    61.2088    61.4624     0.4572       0
  15550     9212.42    61.4361    61.6906     0.4562       0
  15600     9241.94    61.6636    61.9189     0.4558       0
  15650     9271.57     61.891    62.1472     0.4551       0
  15700     9301.12    62.1185    62.3756     0.4542       0
  15750     9330.73    62.3461     62.604     0.4535       0
  15800     9360.42    62.5736    62.8325     0.4527       0
  15850     9390.09    62.8012     63.061     0.4522       0
  15900     9419.67    63.0289    63.2895     0.4513       0
  15950     9449.22    63.2566    63.5181     0.4505       0
  16000     9478.73    63.4844    63.7467     0.4496       0
  16050      9508.2    63.7121    63.9754     0.4494       0
  16100     9537.86     63.94     64.2041     0.4484       0
  16150     9567.41    64.1678    64.4328     0.4479       0
  16200     9597.12    64.3957    64.6616     0.4472       0
  16250     9626.67    64.6237    64.8904     0.4464       0
  16300     9656.52    64.8517    65.1193     0.4454       0
  16350     9686.02    65.0797    65.3482     0.445        0
  16400     9715.55    65.3077    65.5771     0.4444       0
  16450     9745.16    65.5358    65.8061     0.4434       0
  16500     9774.69    65.7639    66.0351     0.4428       0
  16550      9804.5    65.9921    66.2641     0.4419       0
  16600     9834.23    66.2203    66.4932     0.4414       0
  16650     9863.88    66.4486    66.7223     0.4406       0
  16700     9893.45    66.6768    66.9515      0.44        0
  16750     9922.95    66.9052    67.1807     0.4395       0
  16800     9952.61    67.1335    67.4099     0.4388       0
  16850     9982.12    67.3619    67.6392     0.4383       0
  16900     10011.7    67.5903    67.8685     0.4374       0
  16950     10041.23   67.8188    68.0978     0.4366       0
  17000     10070.79   68.0473    68.3272     0.4362       0
  17050     10100.37   68.2758    68.5566     0.4355       0
  17100     10130.04   68.5044     68.786     0.4348       0
  17150     10159.76    68.733    69.0155     0.4339       0
  17200     10189.26   68.9616     69.245     0.4333       0
  17250     10218.8    69.1903    69.4746     0.4329       0
  17300     10248.46    69.419    69.7042     0.432        0
  17350     10277.97   69.6477    69.9338     0.4317       0
  17400     10307.49   69.8765    70.1634     0.4309       0
  17450     10336.95   70.1053    70.3931     0.4304       0
  17500     10366.46   70.3341    70.6228     0.4297       0
  17550     10395.99    70.563    70.8526     0.429        0
  17600     10425.49   70.7919    71.0824     0.4283       0
  17650     10455.16   71.0209    71.3122     0.4276       0
  17700     10484.91   71.2498    71.5421     0.4271       0
  17750     10514.63   71.4789    71.7719     0.4263       0
  17800     10544.36   71.7079    72.0018     0.4255       0
  17850     10574.3    71.9369    72.2318     0.4252       0
  17900     10604.0     72.166    72.4618     0.4245       0
  17950     10633.5    72.3952    72.6918     0.4239       0
  18000     10662.98   72.6243    72.9218     0.4234       0
  18050     10692.58   72.8535    73.1519     0.4228       0
  18100     10722.26   73.0827     73.382     0.4222       0
  18150     10751.93    73.312    73.6121     0.4217       0
  18200     10781.64   73.5413    73.8423     0.4209       0
  18250     10811.21   73.7706    74.0725     0.4204       0
  18300     10841.06     74.0     74.3027      0.42        0
  18350     10870.57   74.2293     74.533     0.4193       0
  18400     10900.03   74.4588    74.7633     0.4186       0
  18450     10929.65   74.6882    74.9936     0.4182       0
  18500     10959.21   74.9177     75.224     0.4174       0
  18550     10988.76   75.1472    75.4544     0.4172       0
  18600     11018.33   75.3767    75.6848     0.4163       0
  18650     11047.8    75.6063    75.9152     0.4159       0
  18700     11077.36   75.8359    76.1457     0.4152       0
  18750     11106.87   76.0655    76.3762     0.4147       0
  18800     11136.47   76.2951    76.6067     0.4143       0
  18850     11166.23   76.5248    76.8373     0.4137       0
  18900     11195.89   76.7545    77.0679     0.4131       0
  18950     11225.43   76.9843    77.2985     0.4124       0
  19000     11254.98    77.214    77.5292     0.4118       0
  19050     11284.46   77.4438    77.7599     0.4113       0
  19100     11314.21   77.6737    77.9906     0.4109       0
  19150     11343.78   77.9035    78.2213     0.4101       0
  19200     11373.44   78.1334    78.4521     0.4096       0
  19250     11403.19   78.3633    78.6829     0.4093       0
  19300     11432.74   78.5933    78.9137     0.4086       0
  19350     11462.29   78.8232    79.1445     0.4082       0
  19400     11491.89   79.0532    79.3754     0.4075       0
  19450     11521.51   79.2832    79.6063     0.407        0
  19500     11551.28   79.5133    79.8373     0.4063       0
  19550     11581.04   79.7434    80.0682     0.4058       0
  19600     11610.82   79.9734    80.2992     0.4052       0
  19650     11640.47   80.2036    80.5302     0.4048       0
  19700     11670.27   80.4337    80.7612     0.4044       0
  19750     11699.97   80.6639    80.9923     0.4038       0
  19800     11729.7    80.8941    81.2233     0.4031       0
  19850     11759.41   81.1243    81.4545     0.4027       0
  19900     11789.06   81.3546    81.6856     0.4019       0
  19950     11818.74   81.5848    81.9167     0.4018       0
  20000     11848.36   81.8151    82.1479     0.4011       0
  20050     11877.93   82.0455    82.3791     0.4007       0
  20100     11907.41   82.2758    82.6104      0.4         0
  20150     11937.17   82.5062    82.8417     0.3993       0
  20200     11966.77   82.7366     83.073     0.3993       0
  20250     11996.38   82.9671    83.3043     0.3985       0
  20300     12026.08   83.1975    83.5356     0.3981       0
  20350     12055.8     83.428     83.767     0.3976       0
  20400     12085.36   83.6585    83.9984     0.397        0
  20450     12114.88    83.889    84.2298     0.3965       0
  20500     12144.49   84.1196    84.4612     0.396        0

 /home/duc/Documents/Research/SSVI-TF/venv/bin/python3 /home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_2D_robust.py
Generating synthetic data ...
Generating synthetic data took:  0.07800412178039551
Tensor dimensions:  [50, 50]
Optimization metrics:
Using Ada Delta with window size =  5
Mean update scheme:  N
Covariance update :  S
k1 samples =  128  k2 samples =  64
eta =  1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    50       30.27      0.2775     0.2748     4.4721       0
   100       60.27      0.2257     0.2233     1.4327       0
   150       90.33      0.1967     0.1944     0.8191       0
   200       120.17     0.1772     0.1749     0.5427       0
Switching to ada grad with eta =  0.1
   250       150.01     0.1624     0.1603     0.3918       0
   300       179.92     0.1443     0.1421     0.3162       0
   350       209.82     0.1313     0.129      0.2365       0
   400       239.72     0.1214     0.1191     0.1883       0
   450       269.75     0.1135     0.1112     0.1549       0
   500       299.76     0.107      0.1046     0.1293       0
   550       330.12     0.1015     0.0992     0.1122       0
   600       360.29     0.0967     0.0945     0.1013       0
   650       390.56     0.0926     0.0904     0.089        0
   700       420.73     0.0889     0.0868     0.0801       0
   750       450.97     0.0856     0.0836     0.074        0
   800       481.17     0.0827     0.0807     0.0797       0
   850       511.33     0.0799     0.078      0.084        0
   900       541.57     0.0775     0.0757     0.0977       0
   950       571.98     0.0752     0.0736     0.1098       0
   1000      602.25     0.0732     0.0716     0.1148       0
   1050      632.68     0.0713     0.0698     0.1313       0
   1100      663.05     0.0696     0.0682     0.1373       0
   1150      693.41     0.0681     0.0667     0.1568       0
   1200      723.74     0.0667     0.0654     0.1704       0
   1250      754.04     0.0654     0.0642     0.1883       0
   1300      784.34     0.0642     0.0631     0.2047       0
   1350      815.01     0.0631     0.0621     0.2173       0
   1400      845.39     0.0621     0.0612     0.2156       0
   1450      875.71     0.0612     0.0603     0.2251       0
   1500      906.0      0.0603     0.0595     0.2258       0
   1550      936.29     0.0595     0.0588     0.2233       0
   1600      966.72     0.0588     0.0581     0.2275       0
   1650      997.15     0.0581     0.0574     0.2323       0
   1700     1027.53     0.0575     0.0569     0.2245       0
   1750     1057.91     0.0569     0.0564     0.231        0
   1800     1088.25     0.0564     0.0559     0.2291       0
   1850     1118.64     0.0559     0.0556     0.2214       0
   1900     1148.98     0.0555     0.0553     0.2205       0
   1950     1179.41     0.0551     0.0551     0.2232       0
   2000     1209.97     0.0548     0.0549     0.2223       0
   2050     1240.47     0.0546     0.0548     0.2179       0
   2100     1271.01     0.0543     0.0548     0.2157       0
   2150     1301.41     0.0542     0.0548     0.2188       0
   2200     1332.13     0.0541     0.055      0.2292       0
   2250      1362.8     0.0541     0.0552     0.2287       0
   2300     1393.42     0.0542     0.0555     0.2345       0
   2350     1423.87     0.0545     0.056      0.2383       0
   2400     1454.57     0.0549     0.0568     0.2388       0
   2450     1485.03     0.0556     0.0577     0.236        0
   2500     1515.57     0.0567     0.0589     0.2401       0
   2550     1545.93     0.0581     0.0605     0.2375       0
   2600     1576.35     0.0599     0.0625     0.2393       0
   2650     1606.87     0.0621     0.0649     0.2362       0
   2700      1637.3     0.0648     0.0678     0.2372       0
   2750      1667.8     0.0681     0.0712     0.2439       0
   2800     1698.22     0.072      0.0751     0.2435       0
   2850     1728.58     0.0763     0.0796     0.2465       0
   2900     1758.93     0.0811     0.0845     0.2533       0
   2950     1789.34     0.0865      0.09      0.2434       0
   3000     1819.63     0.0923     0.0959     0.2468       0
   3050     1849.92     0.0986     0.1024     0.2452       0
   3100     1880.31     0.1054     0.1095     0.2456       0
   3150     1910.69     0.1126     0.1171     0.2447       0
   3200     1941.04     0.1204     0.1252     0.2478       0
   3250     1971.45     0.1287     0.1339     0.2426       0
   3300      2001.7     0.1374     0.1433     0.2451       0
   3350     2031.92     0.1467     0.1532     0.2418       0
   3400     2061.95     0.1567     0.1638     0.2372       0
   3450     2092.14     0.1674     0.175      0.2373       0
   3500     2122.19     0.1788     0.1868     0.2369       0
   3550     2152.13     0.1909     0.1992     0.2415       0
   3600      2182.1     0.2035     0.2122     0.2392       0
   3650     2212.27     0.2167     0.2256     0.2389       0
   3700     2242.28     0.2303     0.2395     0.2376       0
   3750     2272.19     0.2444     0.2537     0.2385       0
   3800     2302.21     0.2587     0.2681     0.2364       0
   3850     2332.03     0.2732     0.2827     0.2363       0
   3900      2362.0     0.2879     0.2975     0.2333       0
   3950     2392.03     0.3027     0.3124     0.2347       0
   4000     2421.89     0.3175     0.3274     0.2366       0
   4050     2451.76     0.3324     0.3424     0.2332       0
   4100     2481.61     0.3473     0.3575     0.2323       0
   4150     2511.35     0.3624     0.3726     0.2316       0
   4200     2541.11     0.3774     0.3877     0.2298       0
   4250     2570.84     0.3925     0.4028     0.2274       0
   4300     2600.58     0.4076     0.4179     0.2268       0
   4350     2630.28     0.4226     0.433      0.223        0
   4400     2659.98     0.4377     0.4481     0.2243       0
   4450     2689.71     0.4527     0.4632     0.2224       0
   4500     2719.75     0.4677     0.4782     0.2195       0
   4550     2749.53     0.4826     0.4932     0.219        0
   4600     2779.35     0.4975     0.5081     0.2212       0
   4650     2809.23     0.5124     0.523      0.2202       0
   4700     2838.95     0.5272     0.5379     0.2184       0
   4750     2868.88     0.542      0.5527     0.2173       0
   4800     2898.59     0.5568     0.5675     0.2181       0
   4850     2928.41     0.5715     0.5823     0.2189       0
   4900     2958.36     0.5861     0.597      0.2155       0
   4950     2988.18     0.6007     0.6116     0.2122       0
   5000     3017.89     0.6153     0.6262     0.2084       0
   5050     3047.62     0.6299     0.6408     0.208        0
   5100     3077.48     0.6443     0.6553     0.2062       0
   5150     3107.25     0.6588     0.6698     0.2027       0
   5200     3137.04     0.6732     0.6842     0.2013       0
   5250     3166.97     0.6875     0.6986     0.2009       0
   5300     3196.95     0.7018     0.713      0.1975       0
   5350     3226.73     0.7161     0.7273     0.1973       0
   5400      3256.5     0.7303     0.7416     0.1947       0
   5450     3286.43     0.7445     0.7558     0.193        0
   5500     3316.33     0.7587      0.77      0.1916       0
   5550     3346.17     0.7728     0.7842      0.19        0
   5600     3376.24     0.7869     0.7983     0.1874       0
   5650     3406.17     0.8009     0.8124     0.1866       0
   5700     3436.03     0.8149     0.8265     0.1844       0
   5750     3465.69     0.8289     0.8405     0.1816       0
   5800     3495.39     0.8428     0.8544     0.1812       0
   5850      3525.3     0.8567     0.8684     0.1788       0
   5900     3555.09     0.8706     0.8823     0.1784       0
   5950      3584.9     0.8844     0.8961     0.1772       0
   6000     3614.76     0.8982      0.91      0.1773       0
   6050     3644.62     0.9119     0.9238     0.1742       0
   6100     3674.43     0.9257     0.9375     0.173        0
   6150      3704.3     0.9393     0.9513     0.1715       0
   6200      3734.2     0.953      0.965      0.1701       0
   6250     3763.94     0.9666     0.9786     0.1692       0
   6300     3793.63     0.9802     0.9923     0.1673       0
   6350     3823.43     0.9938     1.0059     0.1664       0
   6400     3853.17     1.0073     1.0194     0.1663       0
   6450     3883.02     1.0208     1.033      0.1641       0
   6500     3912.94     1.0342     1.0465     0.1634       0
   6550      3943.0     1.0477      1.06      0.1631       0
   6600     3972.97     1.0611     1.0734     0.1615       0
   6650     4002.81     1.0745     1.0868     0.1592       0
   6700     4032.61     1.0878     1.1002     0.1588       0
   6750     4062.36     1.1011     1.1136     0.1572       0
   6800     4092.21     1.1144     1.1269     0.1566       0
   6850     4121.99     1.1277     1.1403     0.1562       0
   6900     4151.78     1.141      1.1535     0.1546       0
   6950     4181.57     1.1542     1.1668     0.154        0
   7000     4211.37     1.1673      1.18      0.1538       0
   7050     4241.42     1.1805     1.1932     0.1523       0
   7100     4271.27     1.1936     1.2064     0.1508       0
   7150     4300.98     1.2068     1.2196     0.1503       0
   7200      4331.1     1.2198     1.2327     0.1498       0
   7250     4360.93     1.2329     1.2458     0.1493       0
   7300     4390.75     1.246      1.2589     0.1477       0
   7350     4420.59     1.259      1.272      0.1472       0
   7400     4450.36     1.272      1.285      0.1466       0
   7450      4480.2     1.285      1.298      0.1452       0
   7500     4509.93     1.2979     1.311      0.1454       0
   7550     4539.72     1.3108     1.324      0.1442       0
   7600     4569.44     1.3237     1.337      0.1436       0
   7650     4599.24     1.3366     1.3499     0.1425       0
   7700      4629.0     1.3495     1.3628     0.1412       0
   7750     4658.73     1.3623     1.3757     0.1416       0
   7800     4688.62     1.3751     1.3885     0.1405       0
   7850     4718.42     1.3879     1.4014     0.1393       0
   7900     4748.14     1.4007     1.4142     0.1393       0
   7950     4777.99     1.4135     1.427      0.1378       0
   8000     4807.84     1.4262     1.4398     0.1382       0
   8050     4837.71     1.439      1.4526     0.1371       0
   8100     4867.59     1.4516     1.4653     0.1361       0
   8150     4897.36     1.4643     1.478      0.1354       0
   8200     4927.21     1.477      1.4907     0.1343       0
   8250     4956.97     1.4896     1.5034     0.1352       0
   8300     4986.69     1.5022     1.5161     0.1337       0
   8350     5016.38     1.5149     1.5288     0.1332       0
   8400     5046.06     1.5274     1.5414     0.1325       0
   8450     5075.75      1.54      1.554      0.1327       0
   8500     5105.53     1.5526     1.5666     0.1314       0
   8550     5135.47     1.5651     1.5792     0.1317       0
   8600     5165.37     1.5776     1.5918     0.1299       0
   8650     5195.28     1.5901     1.6043     0.1295       0
   8700     5225.19     1.6026     1.6168     0.1292       0
   8750     5254.96     1.6151     1.6293     0.1288       0
   8800     5284.66     1.6275     1.6418     0.1275       0
   8850     5314.41      1.64      1.6543     0.1282       0
   8900     5344.13     1.6524     1.6668     0.1271       0
   8950     5373.86     1.6648     1.6792     0.1266       0
   9000     5403.68     1.6772     1.6917     0.1258       0
   9050     5433.45     1.6896     1.7041     0.1256       0
   9100      5463.3     1.7019     1.7165     0.1254       0
   9150     5493.06     1.7143     1.7289     0.1249       0
   9200     5522.99     1.7266     1.7413     0.124        0
   9250     5552.76     1.7389     1.7536     0.1238       0
   9300     5582.56     1.7512     1.766      0.1228       0
   9350     5612.28     1.7635     1.7783     0.1224       0
   9400     5642.07     1.7758     1.7906     0.1221       0
   9450     5671.96     1.7881     1.8029     0.1214       0
   9500     5701.73     1.8003     1.8152     0.1214       0
   9550     5731.45     1.8125     1.8275     0.1207       0
   9600     5761.17     1.8248     1.8398     0.1205       0
   9650      5790.9     1.837      1.852      0.1199       0
   9700     5820.76     1.8492     1.8643     0.1195       0
   9750     5850.49     1.8613     1.8765     0.1196       0
   9800      5880.3     1.8735     1.8887     0.1186       0
   9850     5910.07     1.8857     1.9009     0.1193       0
   9900     5939.89     1.8978     1.9131     0.1182       0
   9950     5969.74     1.9099     1.9253     0.1176       0
  10000      5999.6     1.9221     1.9374     0.1169       0
  10050     6029.44     1.9342     1.9496     0.1168       0
  10100     6059.21     1.9463     1.9617     0.1164       0
  10150      6089.0     1.9583     1.9738     0.1159       0
  10200     6118.71     1.9704     1.986      0.1154       0
  10250     6148.54     1.9825     1.9981     0.1153       0
  10300     6178.26     1.9945     2.0101     0.1151       0
  10350     6208.09     2.0065     2.0222     0.1144       0
  10400     6237.84     2.0186     2.0343     0.1143       0
  10450     6267.56     2.0306     2.0463     0.1138       0
  10500     6297.33     2.0426     2.0584     0.1133       0
  10550     6327.03     2.0546     2.0704     0.1128       0
  10600     6356.74     2.0665     2.0824     0.1124       0
  10650     6386.44     2.0785     2.0944     0.1121       0
  10700     6416.29     2.0905     2.1064     0.1118       0
  10750     6446.18     2.1024     2.1184     0.112        0
  10800     6476.02     2.1143     2.1304     0.1115       0
  10850     6506.05     2.1263     2.1424     0.1115       0
  10900     6535.85     2.1382     2.1543     0.1107       0
  10950     6565.77     2.1501     2.1663     0.1103       0
  11000     6595.51     2.162      2.1782     0.1099       0
  11050     6625.35     2.1739     2.1901     0.1091       0
  11100     6655.28     2.1857     2.2021     0.1094       0
  11150     6685.04     2.1976     2.214      0.1092       0
  11200     6714.76     2.2094     2.2259     0.1094       0
  11250     6744.42     2.2213     2.2378     0.1082       0
  11300     6774.11     2.2331     2.2496     0.1084       0
  11350     6803.89     2.245      2.2615     0.1079       0
  11400     6833.69     2.2568     2.2734     0.1076       0
  11450     6863.68     2.2686     2.2852     0.1071       0
  11500     6893.56     2.2804     2.2971     0.1066       0
  11550     6923.56     2.2922     2.3089     0.1066       0
  11600     6953.39     2.3039     2.3207     0.1063       0
  11650     6983.47     2.3157     2.3325     0.1059       0
  11700      7013.3     2.3275     2.3443     0.1054       0
  11750     7043.15     2.3392     2.3561     0.1056       0
  11800     7072.94     2.351      2.3679     0.1052       0
  11850     7102.72     2.3627     2.3797     0.1047       0
  11900     7132.53     2.3744     2.3914     0.1043       0
  11950     7162.42     2.3861     2.4032     0.1042       0
  12000      7192.2     2.3978     2.415      0.104        0
  12050     7221.99     2.4095     2.4267     0.1037       0
  12100     7251.84     2.4212     2.4384     0.1034       0
  12150     7281.65     2.4329     2.4502     0.1028       0
  12200     7311.56     2.4446     2.4619     0.1027       0
  12250     7341.45     2.4562     2.4736     0.1027       0
  12300     7371.24     2.4679     2.4853     0.1024       0
  12350     7401.03     2.4796     2.497      0.102        0
  12400     7430.81     2.4912     2.5087     0.1022       0
  12450     7460.79     2.5028     2.5203     0.1016       0
  12500     7490.56     2.5145     2.532      0.1013       0
  12550     7520.38     2.5261     2.5437     0.1006       0
  12600     7550.37     2.5377     2.5553     0.1009       0
  12650     7580.22     2.5493     2.567      0.1004       0
  12700     7610.01     2.5609     2.5786     0.1002       0
  12750      7639.8     2.5725     2.5902     0.1003       0
  12800     7669.62     2.5841     2.6019     0.0997       0
  12850     7699.42     2.5956     2.6135     0.0997       0
  12900     7729.24     2.6072     2.6251     0.0993       0
  12950     7759.11     2.6188     2.6367     0.0989       0
  13000     7789.03     2.6303     2.6483     0.0987       0
  13050     7818.91     2.6419     2.6599     0.0986       0
  13100     7848.74     2.6534     2.6715     0.0983       0
  13150      7878.5     2.6649     2.683      0.0984       0
  13200      7908.4     2.6764     2.6946     0.098        0
  13250     7938.25     2.688      2.7062     0.0973       0
  13300     7967.95     2.6995     2.7177     0.0974       0
  13350     7997.75     2.711      2.7293     0.0972       0
  13400     8027.49     2.7225     2.7408     0.0971       0
  13450     8057.27     2.734      2.7523     0.0967       0
  13500      8087.0     2.7454     2.7639     0.097        0
  13550     8116.73     2.7569     2.7754     0.0965       0
  13600     8146.58     2.7684     2.7869     0.0959       0
  13650     8176.61     2.7799     2.7984     0.096        0
  13700     8206.56     2.7913     2.8099     0.0958       0
  13750     8236.31     2.8028     2.8214     0.0959       0
  13800     8266.07     2.8142     2.8329     0.0953       0
  13850      8295.9     2.8256     2.8444     0.0951       0
  13900     8325.73     2.8371     2.8558     0.0948       0
  13950     8355.52     2.8485     2.8673     0.0949       0
  14000     8385.38     2.8599     2.8788     0.0945       0
  14050     8415.14     2.8713     2.8902     0.0945       0
  14100     8445.02     2.8827     2.9017     0.0943       0
  14150      8475.0     2.8941     2.9131     0.0939       0
  14200     8504.82     2.9055     2.9245     0.0937       0
  14250     8534.55     2.9169     2.936      0.0933       0
  14300     8564.33     2.9283     2.9474     0.0932       0
  14350     8594.07     2.9397     2.9588     0.0931       0
  14400     8623.76     2.9511     2.9702     0.0931       0
  14450     8653.54     2.9624     2.9816     0.0925       0
  14500     8683.37     2.9738     2.9931     0.0928       0
  14550     8713.16     2.9851     3.0045     0.0924       0
  14600     8742.89     2.9965     3.0158     0.0923       0
  14650     8772.64     3.0078     3.0272     0.0919       0
  14700     8802.46     3.0192     3.0386     0.0918       0
  14750     8832.38     3.0305      3.05      0.0916       0
  14800     8862.18     3.0418     3.0614     0.0914       0
  14850     8891.92     3.0532     3.0727     0.0909       0
  14900     8921.71     3.0645     3.0841     0.0913       0
  14950     8951.44     3.0758     3.0954     0.091        0
  15000     8981.16     3.0871     3.1068     0.0909       0
  15050      9011.0     3.0984     3.1181     0.0903       0
  15100     9040.82     3.1097     3.1294     0.0901       0
  15150     9070.58     3.121      3.1408     0.0901       0
  15200     9100.33     3.1322     3.1521     0.0901       0
  15250     9130.09     3.1435     3.1634     0.0899       0
  15300      9159.8     3.1548     3.1747     0.0897       0
  15350     9189.64     3.1661     3.1861     0.0895       0
  15400      9219.5     3.1773     3.1974     0.0894       0
  15450     9249.22     3.1886     3.2087     0.089        0
  15500     9278.93     3.1998      3.22      0.0887       0
  15550     9308.62     3.2111     3.2312     0.0888       0
  15600     9338.41     3.2223     3.2425     0.0887       0
  15650     9368.23     3.2336     3.2538     0.0885       0
  15700     9398.01     3.2448     3.2651     0.0882       0
  15750     9427.82     3.256      3.2764     0.0882       0
Traceback (most recent call last):
  File "/home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_2D_robust.py", line 34, in <module>
    factorizer.factorize(report=50)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_interface.py", line 98, in factorize
    self.update_natural_param_batch(dim, col, iteration)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_interface.py", line 147, in update_natural_param_batch
    di, Di, si = self.estimate_di_Di_si_complete_conditional_batch(dim, i, coords, ys, m, S)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 152, in estimate_di_Di_si_complete_conditional_batch
    return self.estimate_di_Di_si_batch(dim, i, coords, ys, m, S)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 66, in estimate_di_Di_si_batch
    di, Di, si = self.approximate_di_Di_si_with_second_layer_samplings(ys, mean_batch, vjs_batch, ws_batch)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 106, in approximate_di_Di_si_with_second_layer_samplings
    - 1/p[k] * np.outer(v[k]*p2[k], v[k]*p2[k]))
KeyboardInterrupt

Process finished with exit code 1

/home/duc/Documents/Research/SSVI-TF/venv/bin/python3 /home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_3D_robust.py
Generating synthetic data ...
Generating synthetic data took:  3.344759225845337
Switching to ada grad with eta =  0.1
Tensor dimensions:  [50, 50, 50]
Optimization metrics:
Using Ada Delta with window size =  10
Mean update scheme:  N
Covariance update :  S
k1 samples =  128  k2 samples =  64
eta =  0.1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    50       139.2      0.3282     0.3236     0.3162       0
   100       277.42     0.3749     0.3701     0.3074       0
   150       415.6      0.4226     0.4175     0.3043       0
   200       553.75     0.4712     0.4659     0.292        0
   250       691.81     0.521      0.5156     0.2943       0
   300       829.92     0.5717     0.566      0.2897       0
   350       967.65     0.6232     0.6174     0.291        0
   400      1105.34     0.6755     0.6695     0.2859       0
   450      1243.05     0.7285     0.7223     0.2859       0
   500      1380.66     0.7821     0.7757     0.2836       0
   550      1518.17     0.8361     0.8295     0.2797       0
   600       1656.4     0.8906     0.8839     0.2711       0
   650      1794.89     0.9456     0.9387     0.2787       0
   700      1933.54     1.0013     0.9942     0.2719       0
   750      2071.31     1.0575     1.0502     0.2709       0
   800       2208.9     1.1142     1.1067     0.2578       0
   850       2346.5     1.1714     1.1637     0.2544       0
   900      2484.23     1.229      1.2211     0.2586       0
   950      2622.22     1.2873     1.2793     0.256        0
   1000      2760.3     1.346      1.3378     0.2498       0
   1050     2898.22     1.4053     1.3968     0.2522       0
   1100     3036.08     1.4652     1.4565     0.2454       0
   1150     3173.96     1.5255     1.5167      0.25        0
   1200     3311.54     1.5863     1.5772     0.2429       0
   1250     3449.32     1.6477     1.6384     0.241        0
   1300     3587.12     1.7094     1.6999     0.2342       0
   1350     3724.79     1.7717     1.762      0.2361       0
   1400     3862.65     1.8345     1.8246     0.2359       0
   1450     4000.16     1.8976     1.8875     0.228        0
   1500     4137.67     1.9613     1.951      0.2319       0
   1550     4275.21     2.0255     2.015      0.2253       0
   1600     4412.89     2.0903     2.0795     0.2232       0
   1650     4550.51     2.1554     2.1445     0.2222       0
   1700     4687.96     2.2209     2.2098     0.2207       0
   1750     4825.76     2.2869     2.2755     0.2219       0
   1800     4963.28     2.3533     2.3417     0.2219       0
   1850     5101.03     2.4202     2.4083     0.2167       0
   1900     5238.82     2.4877     2.4756     0.2132       0
   1950     5376.62     2.5554     2.5431     0.2097       0
   2000     5514.22     2.6237     2.6112     0.2125       0
   2050     5652.05     2.6922     2.6795     0.2098       0
   2100     5789.75     2.7613     2.7483     0.2066       0
   2150     5927.79     2.8309     2.8177     0.2081       0
   2200     6065.83     2.901      2.8875     0.2081       0
   2250     6203.89     2.9714     2.9577     0.2029       0
   2300     6341.98     3.0423     3.0284     0.2025       0
   2350     6479.84     3.1136     3.0995     0.1994       0
   2400      6617.5     3.1854     3.171      0.1982       0
   2450     6755.12     3.2577     3.243      0.1983       0
   2500     6892.94     3.3304     3.3154     0.1961       0
   2550     7030.52     3.4034     3.3882     0.1962       0
   2600     7168.19     3.4768     3.4614     0.1951       0
   2650     7305.76     3.5507     3.535      0.1949       0
   2700     7443.34     3.625      3.6091     0.1916       0
   2750     7580.97     3.6998     3.6836     0.1927       0
   2800     7718.57     3.7749     3.7585     0.1906       0
   2850     7856.16     3.8505     3.8338     0.188        0
   2900     7993.72     3.9265     3.9095     0.1885       0
   2950     8131.36     4.0029     3.9857     0.188        0
   3000     8268.88     4.0798     4.0624     0.1872       0
   3050     8406.52     4.1571     4.1393     0.1854       0
   3100     8544.08     4.2348     4.2168     0.1865       0
   3150     8682.12     4.3129     4.2947     0.1827       0
   3200     8819.87     4.3914     4.3729     0.1838       0
   3250     8957.25     4.4703     4.4515     0.1806       0
   3300     9094.75     4.5496     4.5305     0.1803       0
   3350     9232.34     4.6293      4.61      0.1786       0
   3400      9369.8     4.7094     4.6898     0.1784       0
   3450     9507.49     4.7899     4.7701     0.1777       0
   3500     9645.28     4.8708     4.8507     0.1765       0
   3550     9782.96     4.9521     4.9317     0.1755       0
   3600     9921.21     5.0338     5.0131     0.175        0
   3650     10059.1     5.116      5.095      0.1759       0
   3700     10196.66    5.1985     5.1773     0.1737       0
   3750     10334.52    5.2815     5.2599     0.1727       0
   3800     10472.24    5.3649     5.343      0.1717       0
   3850     10610.18    5.4486     5.4265     0.1716       0
   3900     10747.82    5.5327     5.5103     0.1704       0
   3950     10885.38    5.6172     5.5945     0.1699       0
   4000     11023.03    5.7021     5.6791     0.1705       0
   4050     11160.66    5.7874     5.7641     0.1678       0
   4100     11298.28    5.8731     5.8495     0.1693       0
   4150     11435.8     5.9592     5.9353     0.1671       0
   4200     11573.6     6.0456     6.0214     0.166        0
   4250     11711.35    6.1324     6.1079     0.1655       0
   4300     11848.93    6.2196     6.1949     0.1651       0
   4350     11986.56    6.3072     6.2821     0.164        0
   4400     12124.16    6.3951     6.3698     0.1638       0
   4450     12261.74    6.4835     6.4579     0.1622       0
   4500     12399.44    6.5723     6.5463     0.1626       0
   4550     12537.66    6.6614     6.6351     0.1628       0
   4600     12675.87    6.7509     6.7243     0.1613       0
   4650     12813.58    6.8408     6.8139     0.1616       0
   4700     12951.15    6.9311     6.9039     0.1609       0
   4750     13088.67    7.0217     6.9942     0.1595       0
   4800     13226.52    7.1127     7.0849     0.1589       0
   4850     13364.53    7.2041     7.176      0.159        0
   4900     13502.51    7.2958     7.2674     0.1575       0
   4950     13640.61    7.3879     7.3592     0.1575       0
   5000     13778.32    7.4804     7.4514     0.1561       0
   5050     13915.98    7.5733     7.5439     0.1564       0
   5100     14053.46    7.6665     7.6368     0.1554       0
   5150     14191.05    7.7601      7.73      0.1553       0
   5200     14328.73    7.8541     7.8237     0.1545       0
   5250     14466.27    7.9483     7.9177     0.1539       0
   5300     14604.09    8.0431     8.0121     0.1533       0
   5350     14742.1     8.1381     8.1068     0.1531       0
   5400     14879.91    8.2335     8.2018     0.1521       0
   5450     15017.81    8.3293     8.2973     0.152        0
   5500     15155.87    8.4255     8.3932     0.1516       0
   5550     15294.08    8.522      8.4894     0.1506       0
   5600     15431.68    8.6189     8.5859     0.1504       0
   5650     15569.36    8.7161     8.6828      0.15        0
   5700     15707.16    8.8137      8.78      0.1497       0
   5750     15844.69    8.9116     8.8776     0.1489       0
   5800     15982.39    9.0099     8.9756     0.1486       0
   5850     16120.02    9.1086     9.0739     0.1482       0
   5900     16257.73    9.2075     9.1725     0.1474       0
   5950     16395.34    9.3069     9.2715     0.1478       0
   6000     16532.89    9.4066     9.3709     0.1467       0
   6050     16670.58    9.5067     9.4706     0.1462       0
   6100     16808.3     9.607      9.5706     0.1457       0
   6150     16946.47    9.7078     9.671      0.1459       0
   6200     17083.96    9.8089     9.7718     0.1447       0
   6250     17221.53    9.9103     9.8729     0.1444       0
   6300     17359.31   10.0122     9.9744     0.1445       0
   6350     17496.99   10.1143    10.0762     0.1445       0
   6400     17636.53   10.2168    10.1783     0.1435       0
   6450     17774.43   10.3196    10.2808     0.1425       0
   6500     17912.03   10.4228    10.3836     0.1424       0
   6550     18049.68   10.5263    10.4867     0.1419       0
   6600     18187.33   10.6301    10.5901     0.1415       0
   6650     18325.0    10.7343     10.694     0.1414       0
   6700     18462.63   10.8389    10.7982     0.1409       0
   6750     18600.22   10.9437    10.9027     0.1403       0
   6800     18737.61    11.049    11.0076     0.1406       0
   6850     18875.23   11.1546    11.1128     0.1397       0
   6900     19012.92   11.2605    11.2184     0.1391       0
   6950     19150.46   11.3667    11.3242     0.139        0
   7000     19287.96   11.4733    11.4304     0.1386       0
   7050     19425.72   11.5802     11.537     0.138        0
   7100     19563.34   11.6874    11.6438     0.1378       0
   7150     19700.94    11.795     11.751     0.1374       0
   7200     19838.65   11.9029    11.8585     0.1369       0
   7250     19976.52   12.0111    11.9664     0.1366       0
   7300     20114.38   12.1197    12.0746     0.1363       0
   7350     20252.15   12.2286    12.1831     0.1361       0
   7400     20390.14   12.3378     12.292     0.1358       0
   7450     20528.2    12.4473    12.4011     0.1356       0
   7500     20665.82   12.5572    12.5106     0.1352       0
   7550     20803.37   12.6674    12.6204     0.1345       0
   7600     20941.0    12.7779    12.7306     0.1343       0
   7650     21078.47   12.8888    12.8411     0.1342       0
   7700     21216.08     13.0     12.9519     0.1336       0
   7750     21353.67   13.1115     13.063     0.1331       0
   7800     21491.12   13.2234    13.1745     0.133        0
   7850     21628.65   13.3356    13.2863     0.1326       0
   7900     21766.15   13.4481    13.3984     0.1325       0
   7950     21904.04   13.5608    13.5108     0.132        0
   8000     22042.29    13.674    13.6235     0.1318       0
   8050     22179.93   13.7874    13.7366     0.1317       0
   8100     22317.41   13.9011    13.8499     0.1311       0
   8150     22455.21   14.0152    13.9636     0.1312       0
   8200     22592.88   14.1297    14.0776     0.1304       0
   8250     22730.54   14.2444    14.1919     0.1302       0
   8300     22868.34   14.3594    14.3066     0.1299       0
   8350     23006.62   14.4748    14.4216     0.1294       0
   8400     23144.87   14.5905    14.5368     0.1293       0
   8450     23282.47   14.7065    14.6524     0.1288       0
   8500     23420.08   14.8228    14.7683     0.1289       0
   8550     23557.73   14.9394    14.8846     0.1282       0
   8600     23695.27   15.0563    15.0011     0.1278       0
   8650     23833.02   15.1736    15.1179     0.1279       0
   8700     23970.66   15.2912    15.2351     0.1275       0
   8750     24108.32    15.409    15.3526     0.1271       0
   8800     24245.99   15.5273    15.4704     0.127        0
   8850     24383.52   15.6458    15.5885     0.1267       0
   8900     24521.19   15.7646    15.7069     0.1267       0
   8950     24658.76   15.8837    15.8256     0.1262       0
   9000     24797.04   16.0031    15.9446     0.1261       0
   9050     24935.41   16.1229    16.0639     0.1255       0
   9100     25073.37   16.2429    16.1835     0.1257       0
   9150     25211.06   16.3632    16.3034     0.125        0
   9200     25348.72   16.4839    16.4237     0.125        0
   9250     25486.22   16.6049    16.5443     0.1244       0
   9300     25623.75   16.7262    16.6652     0.124        0
   9350     25761.25   16.8478    16.7863     0.124        0
   9400     25899.01   16.9697    16.9078     0.1238       0
   9450     26036.67   17.0919    17.0296     0.1233       0
   9500     26174.21   17.2144    17.1516     0.1234       0
   9550     26311.98   17.3372     17.274     0.123        0
   9600     26449.52   17.4603    17.3967     0.1226       0
   9650     26587.4    17.5837    17.5197     0.1224       0
   9700     26725.27   17.7074    17.6429     0.1222       0
   9750     26862.93   17.8314    17.7665     0.1223       0
   9800     27000.6    17.9557    17.8903     0.1217       0
   9850     27138.42   18.0803    18.0145     0.1214       0
   9900     27276.23   18.2052     18.139     0.1215       0
   9950     27413.83   18.3304    18.2637     0.1213       0
  10000     27551.52   18.4558    18.3887     0.1206       0
  10050     27688.93   18.5816    18.5141     0.1204       0
Traceback (most recent call last):
  File "/home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_3D_robust.py", line 33, in <module>
    factorizer.factorize(report=50)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_interface.py", line 98, in factorize
    self.update_natural_param_batch(dim, col, iteration)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_interface.py", line 147, in update_natural_param_batch
    di, Di, si = self.estimate_di_Di_si_complete_conditional_batch(dim, i, coords, ys, m, S)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 152, in estimate_di_Di_si_complete_conditional_batch
    return self.estimate_di_Di_si_batch(dim, i, coords, ys, m, S)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 54, in estimate_di_Di_si_batch
    uis_batch = np.random.multivariate_normal(m, S, size=(num_subsamples,self.k1))
  File "mtrand.pyx", line 4325, in mtrand.RandomState.multivariate_normal (numpy/random/mtrand/mtrand.c:26020)
  File "/home/duc/Documents/Research/SSVI-TF/venv/lib/python3.5/site-packages/scipy/linalg/decomp_svd.py", line 16, in svd
    def svd(a, full_matrices=True, compute_uv=True, overwrite_a=False,
KeyboardInterrupt

Process finished with exit code 1


/home/duc/Documents/Research/SSVI-TF/venv/bin/python3 /home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_2D_robust.py
Generating synthetic data ...
Generating synthetic data took:  0.006300687789916992
Tensor dimensions:  [10, 10]
Optimization metrics:
Using Ada Grad
Mean update scheme:  N
Covariance update :  S
k1 samples =  256  k2 samples =  128
eta =  1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |
    50       16.87      0.1566     0.1812     0.4709       0
   100       33.39      0.1116     0.1324     0.1659       0
   150       49.98      0.0901     0.1093     0.0944       0
   200       66.68      0.0773     0.0944     0.0634       0
   250       83.37      0.0684     0.0838     0.0467       0
   300       100.16     0.0618     0.0756     0.037        0
   350       116.97     0.0565     0.069      0.0283       0
   400       133.82     0.0523     0.0636     0.0252       0
   450       150.69     0.0489     0.059      0.0213       0
   500       167.59     0.0459     0.0553     0.0183       0
   550       184.58     0.0436     0.0522     0.0155       0
   600       201.5      0.0416     0.0494     0.0158       0
   650       218.52     0.0401     0.0471     0.0176       0
   700       235.52     0.0392     0.0451     0.0177       0
   750       252.58     0.0385     0.0435     0.0195       0
   800       269.61     0.0382     0.0423     0.0254       0
   850       286.63     0.0383     0.0413     0.035        0
   900       303.65     0.0385     0.0406     0.0414       0
   950       320.7      0.0395     0.0401     0.0512       0
   1000      337.75     0.0415     0.0401     0.0753       0
   1050      354.87     0.045      0.0408     0.1426       0
   1100      372.14     0.0519     0.0431     0.3045       0
   1150      389.27     0.0853     0.0593     2.3668       0
   1200      406.29     0.4512     0.3997     3.1419       0
   1250      423.12     1.7966     1.7149     3.1342       0
   1300      440.09     3.632      3.4666     2.9771       0
   1350      457.09     5.7949     5.5307     2.8163       0


/home/duc/Documents/Research/SSVI-TF/venv/bin/python3 /home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_2D_robust.py
Generating synthetic data ...
Generating synthetic data took:  0.07818293571472168
Tensor dimensions:  [50, 50]
Optimization metrics:
Using Ada Grad
Mean update scheme:  N
Covariance update :  S
k1 samples =  256  k2 samples =  128
eta =  1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |    dw
    50       70.74      0.3456     0.3432     3.1623       0         0.0
   100       140.24     0.2682     0.2659     1.8021       0         0.0
   150       210.25     0.2277     0.2254      1.02        0         0.0
   200       280.29     0.2019     0.1998     0.6625       0         0.0
   250       350.19     0.1836     0.1816     0.4784       0         0.0
   300       419.85     0.1696     0.1676     0.3649       0         0.0
   350       489.72     0.1585     0.1566     0.2905       0         0.0
   400       559.64     0.1493     0.1474     0.2394       0         0.0
   450       629.58     0.1415     0.1397     0.2041       0         0.0
   500       699.67     0.1348     0.133      0.1758       0         0.0
   550       769.73     0.1289     0.1272     0.1521       0         0.0
   600       839.92     0.1238     0.122      0.1347       0         0.0
   650       910.3      0.1191     0.1174      0.12        0         0.0
   700       980.62     0.1149     0.1132     0.108        0         0.0
   750      1051.07     0.1111     0.1095     0.0983       0         0.0
   800      1121.65     0.1076     0.106      0.0905       0         0.0
   850      1192.22     0.1044     0.1028     0.0821       0         0.0
   900      1263.04     0.1014     0.0998     0.0771       0         0.0
   950      1333.81     0.0986     0.0971     0.0716       0         0.0
   1000     1404.49     0.0961     0.0945     0.0661       0         0.0
   1050     1475.42     0.0936     0.0921     0.0617       0         0.0
   1100     1546.24     0.0913     0.0899     0.0588       0         0.0
   1150     1617.12     0.0892     0.0877     0.0543       0         0.0
   1200      1688.1     0.0872     0.0857     0.0512       0         0.0
   1250     1759.13     0.0853     0.0838     0.0499       0         0.0
   1300     1830.57     0.0834     0.082      0.0467       0         0.0
   1350     1901.78     0.0817     0.0803     0.0432       0         0.0
   1400     1972.93     0.0801     0.0786     0.0422       0         0.0
   1450     2044.24     0.0785     0.0771     0.0401       0         0.0
   1500     2115.58     0.077      0.0756     0.0384       0         0.0
   1550     2186.86     0.0756     0.0741     0.0362       0         0.0
   1600     2258.31     0.0742     0.0728     0.0353       0         0.0
   1650     2330.02     0.0729     0.0715     0.034        0         0.0
   1700     2401.63     0.0716     0.0702     0.0331       0         0.0
   1750     2473.28     0.0704     0.069      0.0315       0         0.0
   1800     2545.01     0.0692     0.0678     0.0302       0         0.0
   1850     2616.68     0.0681     0.0667     0.0287       0         0.0
   1900     2688.38     0.067      0.0656     0.0281       0         0.0
   1950     2760.17     0.0659     0.0646     0.0274       0         0.0
   2000     2831.85     0.0649     0.0635     0.0257       0         0.0
   2050     2903.69     0.0639     0.0626     0.0259       0         0.0
   2100     2975.48     0.0629     0.0616     0.0242       0         0.0
   2150     3047.47     0.062      0.0607     0.0239       0         0.0
   2200     3119.36     0.0611     0.0598     0.0233       0         0.0
   2250     3191.44     0.0602     0.0589     0.0222       0         0.0
   2300     3263.35     0.0594     0.0581     0.0217       0         0.0
   2350     3335.28     0.0585     0.0573     0.0215       0         0.0
   2400     3407.65     0.0577     0.0565     0.0201       0         0.0
   2450     3480.09     0.057      0.0557     0.0194       0         0.0
   2500      3552.4     0.0562     0.0549     0.0197       0         0.0
   2550     3624.83     0.0555     0.0542     0.019        0         0.0
   2600     3697.14     0.0547     0.0535     0.0181       0         0.0
   2650     3769.39     0.054      0.0528     0.0182       0         0.0
   2700     3841.63     0.0534     0.0521     0.0173       0         0.0
   2750     3913.83     0.0527     0.0515     0.0169       0         0.0
   2800     3985.98     0.052      0.0508     0.0168       0         0.0
   2850     4058.37     0.0514     0.0502     0.0167       0         0.0
   2900     4130.64     0.0508     0.0496     0.016        0         0.0
   2950     4202.95     0.0502     0.049      0.016        0         0.0
   3000      4275.3     0.0496     0.0484     0.0154       0         0.0
   3050     4347.67     0.049      0.0479     0.015        0         0.0
   3100      4420.0     0.0484     0.0473     0.0146       0         0.0
   3150     4492.36     0.0479     0.0468     0.014        0         0.0
   3200     4564.78     0.0473     0.0462     0.0139       0         0.0
   3250     4637.23     0.0468     0.0457     0.014        0         0.0
   3300     4709.66     0.0463     0.0452     0.0136       0         0.0
   3350     4782.19     0.0457     0.0447     0.0133       0         0.0
   3400     4854.75     0.0452     0.0442     0.0126       0         0.0
   3450     4927.26     0.0448     0.0437     0.0127       0         0.0
   3500      4999.8     0.0443     0.0433     0.0123       0         0.0
   3550     5072.26     0.0438     0.0428     0.0119       0         0.0
   3600     5144.81     0.0433     0.0424     0.0119       0         0.0
   3650     5217.29     0.0429     0.0419     0.0117       0         0.0
   3700      5289.8     0.0424     0.0415     0.012        0         0.0
   3750     5362.37     0.042      0.0411     0.0114       0         0.0
   3800     5435.05     0.0416     0.0406     0.0113       0         0.0
   3850     5507.72     0.0411     0.0402     0.011        0         0.0
   3900     5580.41     0.0407     0.0398     0.0106       0         0.0
   3950      5653.0     0.0403     0.0394     0.0106       0         0.0
   4000     5725.67     0.0399     0.0391     0.0102       0         0.0
   4050     5798.45     0.0395     0.0387     0.0103       0         0.0
   4100     5871.15     0.0391     0.0383     0.0101       0         0.0
   4150     5944.03     0.0388     0.0379     0.0099       0         0.0
   4200     6016.96     0.0384     0.0376      0.01        0         0.0
   4250      6089.9     0.038      0.0372     0.0099       0         0.0
   4300     6162.81     0.0377     0.0369     0.0099       0         0.0
   4350     6235.77     0.0373     0.0365     0.0103       0         0.0
   4400      6308.6     0.037      0.0362     0.0099       0         0.0
   4450     6381.48     0.0366     0.0359     0.0098       0         0.0
   4500     6454.38     0.0363     0.0356     0.0117       0         0.0
   4550     6527.24     0.036      0.0352     0.0105       0         0.0
   4600     6600.17     0.0357     0.0349     0.0111       0         0.0
   4650     6673.16     0.0353     0.0346     0.011        0         0.0
   4700     6746.14     0.035      0.0343     0.0108       0         0.0
   4750     6819.05     0.0347     0.034      0.0114       0         0.0
   4800     6891.99     0.0344     0.0338     0.0111       0         0.0
   4850     6964.93     0.0341     0.0335     0.0114       0         0.0
   4900     7037.92     0.0338     0.0332     0.0122       0         0.0
   4950     7110.98     0.0336     0.0329     0.0125       0         0.0
   5000     7183.79     0.0333     0.0327     0.0126       0         0.0
   5050     7256.62     0.033      0.0324     0.013        0         0.0
   5100     7329.62     0.0328     0.0322     0.0132       0         0.0
   5150     7402.62     0.0325     0.0319     0.0143       0         0.0
   5200     7475.54     0.0322     0.0317     0.0134       0         0.0
   5250     7548.52     0.032      0.0314     0.0132       0         0.0
   5300     7621.52     0.0317     0.0312     0.0139       0         0.0
   5350     7694.59     0.0315     0.031      0.0139       0         0.0
   5400     7767.51     0.0313     0.0307     0.0153       0         0.0
   5450     7840.63     0.031      0.0305     0.015        0         0.0
   5500     7913.86     0.0308     0.0303     0.0166       0         0.0
   5550     7986.98     0.0306     0.0301     0.0153       0         0.0
   5600     8060.16     0.0304     0.0299     0.0176       0         0.0
   5650     8133.41     0.0302     0.0297     0.0167       0         0.0
   5700     8206.61      0.03      0.0295     0.0167       0         0.0
   5750      8279.6     0.0298     0.0293     0.0173       0         0.0
   5800     8352.76     0.0296     0.0291     0.0184       0         0.0
   5850     8426.03     0.0294     0.0289     0.0186       0         0.0
   5900      8499.3     0.0292     0.0287     0.0183       0         0.0
   5950     8572.46     0.0291     0.0286     0.0191       0         0.0
   6000     8645.66     0.0289     0.0284     0.0208       0         0.0
   6050     8718.85     0.0287     0.0282     0.0212       0         0.0
   6100     8792.01     0.0285     0.0281     0.0205       0         0.0
   6150     8865.25     0.0284     0.0279     0.0208       0         0.0
   6200     8938.44     0.0282     0.0278     0.0233       0         0.0
   6250     9011.66     0.028      0.0276     0.024        0         0.0
   6300     9084.83     0.0279     0.0275     0.0246       0         0.0
   6350     9158.03     0.0277     0.0273     0.0249       0         0.0
   6400     9231.24     0.0276     0.0272     0.0271       0         0.0
   6450     9304.43     0.0274     0.0271     0.0273       0         0.0
   6500     9377.75     0.0273     0.0269     0.029        0         0.0
   6550     9450.78     0.0272     0.0268     0.0282       0         0.0
   6600     9523.97     0.027      0.0267     0.0307       0         0.0
   6650     9596.99     0.0269     0.0266     0.0315       0         0.0
   6700     9670.15     0.0268     0.0265     0.0329       0         0.0
   6750     9743.38     0.0267     0.0264     0.0356       0         0.0
   6800     9816.43     0.0266     0.0263     0.037        0         0.0
   6850     9889.52     0.0264     0.0262     0.0381       0         0.0
   6900     9962.62     0.0263     0.0261     0.0386       0         0.0
   6950     10035.71    0.0262     0.026      0.0426       0         0.0
   7000     10108.88    0.0261     0.026      0.0453       0         0.0
   7050     10181.97    0.0261     0.0259     0.0464       0         0.0
   7100     10255.28    0.026      0.0258     0.0502       0         0.0
   7150     10328.54    0.0259     0.0258     0.0527       0         0.0
   7200     10401.78    0.0258     0.0257     0.0568       0         0.0
   7250     10474.99    0.0258     0.0257     0.0612       0         0.0
   7300     10548.49    0.0257     0.0257     0.065        0         0.0
   7350     10621.92    0.0257     0.0257     0.0686       0         0.0
   7400     10695.38    0.0256     0.0256     0.0751       0         0.0
   7450     10769.13    0.0256     0.0256     0.0833       0         0.0
   7500     10842.37    0.0256     0.0257     0.0896       0         0.0
   7550     10915.51    0.0256     0.0257     0.1015       0         0.0
   7600     10988.65    0.0256     0.0257     0.108        0         0.0
   7650     11061.88    0.0257     0.0258     0.1237       0         0.0
   7700     11134.98    0.0257     0.0259     0.1444       0         0.0
   7750     11208.02    0.0258     0.026      0.1594       0         0.0
   7800     11281.03    0.0259     0.0261     0.1849       0         0.0
   7850     11354.35    0.026      0.0263     0.2159       0         0.0
   7900     11427.62    0.0262     0.0265     0.2564       0         0.0
   7950     11500.82    0.0264     0.0268     0.3188       0         0.0
   8000     11573.81    0.0267     0.0271     0.4108       0         0.0
   8050     11646.98    0.0271     0.0276     0.5592       0         0.0
   8100     11719.99    0.0277     0.0283     0.8124       0         0.0
   8150     11793.2     0.0286     0.0294     1.2782       0         0.0
   8200     11866.37    0.0301     0.0311     2.1006       0         0.0
   8250     11939.48    0.0326     0.0341     2.8529       0         0.0
   8300     12012.59    0.0417     0.0436     3.0571       0         0.0
   8350     12085.38    0.075      0.0784     3.0776       0         0.0
   8400     12157.15    0.1438     0.151      3.0966       0         0.0
   8450     12227.69    0.2505     0.2641     3.1466       0         0.0
   8500     12297.69    0.4235     0.4433     3.1468       0         0.0
   8550     12367.55    0.6517     0.6759     3.1488       0         0.0
   8600     12437.11    0.9095     0.9373     3.1437       0         0.0
   8650     12506.56    1.1896     1.2196     3.1373       0         0.0
   8700     12576.16    1.487      1.5191     3.1451       0         0.0
   8750     12645.85    1.8003     1.8344     3.1317       0         0.0
   8800     12715.47    2.1287     2.1649     3.1048       0         0.0
   8850     12785.09    2.4715     2.5098     3.0743       0         0.0
   8900     12854.73    2.8282     2.8686     3.0389       0         0.0
   8950     12924.4     3.1981     3.2407     3.0052       0         0.0
   9000     12994.12    3.5808     3.6256     2.9731       0         0.0
   9050     13063.87    3.9757     4.0228     2.9359       0         0.0
   9100     13133.42    4.3825     4.4319     2.9039       0         0.0
   9150     13203.0     4.8007     4.8523     2.8724       0         0.0
   9200     13272.51    5.2299     5.2839     2.8389       0         0.0
   9250     13341.95    5.6697     5.7261     2.809        0         0.0
   9300     13411.37    6.1199     6.1786     2.7785       0         0.0
   9350     13480.84    6.5799     6.641      2.7495       0         0.0
   9400     13550.42    7.0495     7.113      2.7188       0         0.0
   9450     13619.96    7.5283     7.5942     2.692        0         0.0
   9500     13689.6     8.0161     8.0845     2.6641       0         0.0
   9550     13759.08    8.5126     8.5835     2.6385       0         0.0
   9600     13828.67    9.0176     9.091      2.6105       0         0.0
   9650     13898.13    9.5307     9.6066     2.5862       0         0.0
   9700     13967.67   10.0517    10.1302      2.56        0         0.0
   9750     14037.14   10.5804    10.6615     2.5364       0         0.0
   9800     14106.71   11.1164    11.2001     2.5124       0         0.0
   9850     14176.23   11.6597     11.746     2.4911       0         0.0
   9900     14245.9     12.21     12.2989     2.4678       0         0.0
   9950     14315.36    12.767    12.8586     2.4442       0         0.0
  10000     14384.83   13.3307    13.4249     2.4245       0         0.0
  10050     14454.55   13.9008    13.9977     2.4022       0         0.0
  10100     14524.08   14.4772    14.5768     2.3839       0         0.0
  10150     14593.55   15.0596    15.1619     2.3619       0         0.0
  10200     14663.11   15.6479    15.7529     2.3416       0         0.0
  10250     14732.65    16.242    16.3497     2.322        0         0.0
  10300     14802.1    16.8416    16.9521     2.305        0         0.0
  10350     14871.62   17.4466    17.5599     2.2844       0         0.0
  10400     14941.08    18.057     18.173     2.2667       0         0.0
  10450     15010.74   18.6725    18.7913     2.2492       0         0.0
  10500     15080.29    19.293    19.4146     2.2315       0         0.0
  10550     15149.77   19.9184    20.0429     2.2141       0         0.0
  10600     15219.32   20.5486    20.6759     2.1976       0         0.0
  10650     15288.88   21.1834    21.3136     2.1812       0         0.0
  10700     15358.28   21.8228    21.9558     2.1646       0         0.0
  10750     15427.9    22.4665    22.6024     2.1499       0         0.0
  10800     15497.61   23.1146    23.2533     2.1335       0         0.0
  10850     15567.17   23.7669    23.9085     2.1184       0         0.0
  10900     15636.76   24.4233    24.5678     2.1033       0         0.0
  10950     15706.24   25.0838    25.2312     2.0889       0         0.0
  11000     15775.79   25.7481    25.8984     2.0741       0         0.0
  11050     15845.2    26.4163    26.5695     2.0598       0         0.0
  11100     15914.73   27.0882    27.2444     2.0459       0         0.0
  11150     15984.39   27.7638    27.9229     2.0318       0         0.0
  11200     16054.15   28.4428    28.6049     2.0178       0         0.0
  11250     16123.58   29.1255    29.2905     2.0061       0         0.0
  11300     16193.28   29.8115    29.9796     1.9929       0         0.0
  11350     16262.74   30.5009    30.6719     1.9806       0         0.0
  11400     16332.28   31.1935    31.3676     1.9675       0         0.0
  11450     16401.83   31.8894    32.0664     1.9552       0         0.0
  11500     16471.25   32.5883    32.7684     1.9429       0         0.0
  11550     16540.75   33.2904    33.4735     1.9312       0         0.0
  11600     16610.34   33.9955    34.1816     1.9191       0         0.0
  11650     16679.87   34.7035    34.8926     1.9071       0         0.0
  11700     16749.43   35.4144    35.6065     1.8964       0         0.0
  11750     16819.13   36.1281    36.3233     1.8846       0         0.0
  11800     16888.68   36.8445    37.0427     1.8735       0         0.0
  11850     16958.24   37.5636    37.7649     1.863        0         0.0
  11900     17027.89   38.2854    38.4898     1.8521       0         0.0
  11950     17097.5    39.0098    39.2173     1.8417       0         0.0
  12000     17166.89   39.7368    39.9473     1.8311       0         0.0
  12050     17236.41   40.4662    40.6798     1.8207       0         0.0
  12100     17306.02    41.198    41.4147     1.8111       0         0.0
  12150     17375.64   41.9323    42.1521     1.8012       0         0.0
  12200     17445.6    42.6689    42.8918     1.7905       0         0.0
  12250     17515.59   43.4078    43.6339     1.7808       0         0.0
  12300     17585.12    44.149    44.3782     1.7716       0         0.0
  12350     17654.66   44.8925    45.1247     1.7619       0         0.0
  12400     17724.18   45.6381    45.8735     1.7538       0         0.0
  12450     17793.63   46.3859    46.6244     1.7445       0         0.0
  12500     17863.23   47.1357    47.3774     1.7356       0         0.0
  12550     17932.75   47.8876    48.1324     1.7265       0         0.0
  12600     18002.31   48.6416    48.8896     1.7174       0         0.0
  12650     18071.8    49.3976    49.6487     1.7089       0         0.0
  12700     18141.34   50.1555    50.4098     1.7005       0         0.0
  12750     18211.17   50.9154    51.1728     1.6923       0         0.0
  12800     18280.91   51.6772    51.9378     1.6835       0         0.0
  12850     18350.57   52.4408    52.7046     1.6756       0         0.0
  12900     18420.2    53.2063    53.4732     1.6667       0         0.0
  12950     18489.82   53.9735    54.2436     1.6599       0         0.0
  13000     18559.73   54.7425    55.0158     1.651        0         0.0
  13050     18629.49   55.5132    55.7897     1.6429       0         0.0
  13100     18699.15   56.2856    56.5653     1.6358       0         0.0
  13150     18768.96   57.0597    57.3427     1.628        0         0.0
  13200     18838.42   57.8355    58.1216     1.6209       0         0.0
  13250     18908.03   58.6129    58.9022     1.613        0         0.0
  13300     18977.51   59.3919    59.6844     1.6058       0         0.0
  13350     19047.18   60.1724    60.4682     1.5996       0         0.0
  13400     19116.65   60.9546    61.2536     1.5917       0         0.0
  13450     19186.19   61.7383    62.0405     1.5854       0         0.0
  13500     19256.08   62.5234    62.8288     1.5782       0         0.0
  13550     19325.75    63.31     63.6187     1.5709       0         0.0
Traceback (most recent call last):
  File "/home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_2D_robust.py", line 34, in <module>
    factorizer.factorize(report=50)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_interface.py", line 98, in factorize
    self.update_natural_param_batch(dim, col, iteration)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_interface.py", line 147, in update_natural_param_batch
    di, Di, si = self.estimate_di_Di_si_complete_conditional_batch(dim, i, coords, ys, m, S)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 152, in estimate_di_Di_si_complete_conditional_batch
    return self.estimate_di_Di_si_batch(dim, i, coords, ys, m, S)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 66, in estimate_di_Di_si_batch
    di, Di, si = self.approximate_di_Di_si_with_second_layer_samplings(ys, mean_batch, vjs_batch, ws_batch)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 83, in approximate_di_Di_si_with_second_layer_samplings
    phi, phi_fst, phi_snd = self.estimate_expected_derivatives_pdf_batch(ys, mean_batch, ws_batch)
  File "/home/duc/Documents/Research/SSVI-TF/SSVI/SSVI_TF_robust.py", line 138, in estimate_expected_derivatives_pdf_batch
    fs = np.random.normal(mean_batch[num], ws_batch[num], size=(self.k2, self.k1))
KeyboardInterrupt

Process finished with exit code 1



/home/duc/Documents/Research/SSVI-TF/venv/bin/python3 /home/duc/Documents/Research/SSVI-TF/Test/SSVI_robust/real/PTF_3D_robust.py
Generating synthetic data ...
Generating synthetic data took:  3.2831714153289795
Tensor dimensions:  [50, 50, 50]
Optimization metrics:
Using Ada Grad
Mean update scheme:  N
Covariance update :  S
k1 samples =  512  k2 samples =  128
eta =  1  cov eta =  1  sigma eta =  1
iteration |   time   | test_err | train_err|  d_mean  |   d_cov  |    dw
    5        87.36      0.3406     0.3354     3.1623       0         0.0
    10       161.21     0.3919     0.3869     3.1623       0         0.0
    15       234.92     0.4467     0.4418     3.1623       0         0.0