Generating synthetic count valued data ... 
Generating synthetic  count valued data took:  38.156530141830444
max_count =  55  min count =  0
Evaluation for true params: 
 test_rsme | train_rsme | rel-te-err | rel-tr-err |  test_nll  |  train_nll |
2.6157905115 2.6387724419   1.50604       1.5161     163434.99    650812.53  
Using  0.05 of training data
Factorizing with max_iteration = 12000  fixing covariance?:  False
Tensor dimensions:  [50, 50, 50]
Optimization metrics: 
Using Ada Grad
Mean update scheme:  S
Covariance update :  N
Using diagonal covariance?:  True
Random start? True
k1 samples =  32  k2 samples =  128
eta =  1.0  cov eta =  1.0  sigma eta =  1
iteration |   time   |test_rsme |rel-te-err|train_rsme|rel-tr-err|   d_mean  |   d_cov  |avg_grad_m|avg_grad_c| test_nll | train_nll |    VLB   |  E-term  |    KL     
    0         2.01     10.3767     6.6565    10.2069     6.5538     3.1623     0.007      0.5921     0.4881   194560.72   38878.93   -79081.0  -79024.279   56.357   
    5        127.87     10.384     6.6593    10.2018     6.5474     3.1623     0.007      5.2866     5.7435    192158.3   38190.17   -78467.0  -78419.753   47.276   
    10       253.3     10.3901     6.662      10.178     6.5294     3.1623     0.007     11.1664    11.7449   188220.38   37168.99   -77526.0  -77485.399   40.488   
    20       369.36     10.363     6.6431    10.0341     6.4368     3.1623     0.007     31.0786    31.1302   179926.93   34764.99   -74511.0  -74477.762   33.043   
    50       512.63     9.7452     6.1808     8.8454     5.5766     3.1623     0.0029    180.3834   139.3316   136659.7   23666.12   -48240.0  -48212.945   26.998   
   100       710.01     6.6476     4.0142     5.1285     3.1772     3.0837     0.0027    234.6869   181.7096   66080.0    11003.99   -14900.0  -14873.249   26.92    
   200       976.64     5.5038     3.2377     3.3898     2.0754     2.5649     0.0038    34.8288    69.7808    56457.02   8841.16    -10983.0  -10957.403    25.3    
   300      1258.13     5.1528     3.0611     2.9842     1.8124     1.9845     0.0033    21.2401    68.4274    54071.83   8310.31    -10079.0  -10054.179   24.657   
   400       1548.0     4.9754     2.9772     2.7615     1.6556     1.5328     0.0033    16.9173    69.3614    53163.28   8056.54    -9588.0    -9564.3     24.187   
   500       1854.5     4.8926     2.9608     2.6722     1.6104     1.1013     0.0033    13.2086    72.1487    52884.29   7946.75    -9355.0   -9330.723    24.03    
   600      2161.93     4.8419     2.9389     2.563      1.5256     1.0679     0.0032    11.4976    73.2409    52780.65   7848.97    -9193.0   -9168.504    24.177   
   700      2468.39     4.814      2.9309     2.4891      1.48      1.093      0.0032    10.7137    74.4298    52657.91   7779.73    -9085.0   -9060.913    24.13    
   800       2771.7     4.7979     2.9265     2.4381     1.446      0.8604     0.0032     9.1164    75.4692    52768.11   7716.52    -9000.0   -8975.328    24.218   
   900      3076.09     4.7895     2.9267     2.3942     1.4156     1.0808     0.0031     8.917     76.7437    52766.12   7685.44    -8961.0   -8936.939    24.034   
   1000     3386.37     4.8045     2.9362     2.3461     1.3856     1.0402     0.0031     8.7702    77.1282    53045.27   7648.56    -8936.0   -8912.196    24.049   
   1100     3654.99     4.8129     2.9421     2.3103     1.3624     0.7338     0.003      8.0217    78.5983    53131.46   7634.88    -8871.0   -8846.828    24.05    
   1200     3905.67     4.8107     2.9424     2.275      1.343      0.6086     0.003      7.6217     79.671    53109.64   7615.99    -8886.0   -8862.299    23.902   
   1300     4153.45     4.8215     2.9536     2.2506     1.339      0.494      0.0031     7.7131    80.2146    53230.98    7600.9    -8867.0   -8843.183    24.11    
   1400     4408.64     4.8279     2.9587     2.2478     1.348      0.5998     0.003      7.8901    81.2757    53274.74   7594.53    -8855.0   -8830.986    24.137   
   1500     4707.56     4.8226     2.9554     2.2145     1.3188     0.4838     0.003      7.5222    81.6697    53361.31   7578.08    -8838.0   -8813.564    24.226   
   1600     5032.36     4.8263     2.9563     2.1791     1.288      0.5416     0.003      6.8154    82.1595    53369.34   7576.17    -8781.0   -8756.443    24.261   
   1700     5354.81     4.8324     2.9635     2.1402     1.2746     0.5239     0.003      7.0932    82.6447    53577.94   7560.73    -8822.0   -8798.295    24.166   
   1800     5686.34     4.8701     2.9868     2.1611     1.2888     0.5745     0.003      6.7927     84.306    53661.5    7552.66    -8795.0   -8771.156    24.112   
   1900      6019.5     4.8635     2.9875     2.1473     1.2782     0.445      0.003      7.1133    84.5949    53838.39   7540.16    -8801.0   -8776.958    24.216   
   2000     6344.41     4.8723     2.9877     2.1437     1.286      0.509      0.003      7.3182    85.3027    53791.28   7551.42    -8821.0   -8796.414    24.245   
   2100     6670.95     4.8946     3.002      2.1413     1.2874     0.5309     0.0029     8.2153    86.4123    53987.93   7552.91    -8806.0   -8781.884    24.19    
   2200     6994.33     4.9201     3.0254     2.1262     1.2864     0.5926     0.003      8.185     86.7777    54160.84   7547.91    -8833.0   -8808.358    24.232   
   2300     7327.02     4.9144     3.011      2.1075     1.2688     0.6059     0.0029     7.6975    87.7752    54242.15   7543.32    -8831.0   -8806.995    24.264   
   2400     7661.93     4.9026     3.0012     2.0557     1.2312     0.7259     0.003      7.7679    88.0859    54191.7    7516.54    -8773.0   -8749.032    24.258   
   2500      7998.9     4.9021     3.0038     2.0681     1.238      0.6878     0.0029     7.9809    88.5658    54354.05   7533.56    -8784.0   -8759.969    24.433   
   2600     8331.38     4.9307     3.0189     2.0584     1.2344     0.6722     0.0028     8.338     88.6976    54454.66   7529.01    -8780.0   -8755.826    24.513   
   2700     8663.88     4.952      3.032      2.0653     1.2462     0.642      0.0029      8.28     89.2488    54489.41   7523.71    -8833.0   -8808.582    24.581   
   2800     8996.67     4.9557      3.04      2.0329     1.2276     0.6516     0.0029     8.2984    89.4031    54606.39   7523.75    -8810.0   -8785.441    24.47    
   2900     9327.91     4.9578     3.0306     2.001      1.2094     0.6439     0.0029     8.2398    89.8841    54553.51   7511.93    -8767.0    -8742.78    24.656   
   3000     9654.23     4.9538     3.0376     2.0007     1.2076     0.4728     0.0029     7.314     90.0203    54505.53   7512.95    -8813.0   -8788.211    24.563   
   3100     9980.99     4.9824     3.0494      1.98      1.186      0.5564     0.0029     7.789     90.3399    54708.69   7501.06    -8765.0   -8740.282    24.625   
   3200     10305.77    4.9666     3.0442     1.9916     1.2004     0.5019     0.0029     7.2401    91.3259    54800.06   7503.23    -8809.0   -8784.023    24.707   
   3300     10636.32    4.9775     3.0491     2.0025     1.2148     0.4651     0.0029     7.3639    91.5928    54596.88   7507.35    -8811.0   -8786.423    24.968   
   3400     10965.63    4.9876     3.0511     1.9729     1.2038     0.5251     0.003      7.5243     92.047    54684.96    7501.2    -8753.0   -8728.275    24.999   
   3500     11288.99    5.0018     3.065      1.9941     1.219      0.4777     0.0028     7.5988    92.5121    54613.72   7503.09    -8788.0   -8762.862    25.153   
   3600     11610.71    4.9959     3.0578     1.9834     1.2048     0.6254     0.0028     8.1571    92.3629    54726.11   7505.23    -8833.0   -8807.536    25.118   
   3700     11933.72    5.0029     3.0603     1.9573     1.1952     0.6552     0.0029     8.2491    92.3814    54790.11    7510.1    -8809.0   -8783.591    25.115   
   3800     12257.63    5.0156     3.0755     1.9433     1.1852     0.5459     0.0027     8.7628    93.1056    54828.07    7495.7    -8803.0   -8778.431    24.968   
   3900     12560.88    5.0006     3.0588     1.937      1.1698     0.6727     0.0028     8.575     93.5684    54702.07   7504.35    -8801.0   -8776.026    25.092   
   4000     12814.71    5.0184     3.0756     1.9324     1.1764     0.4897     0.0029     8.0306    93.8848    54966.92   7495.52    -8807.0   -8781.658    25.054   
   4100     13088.21    5.0125     3.0694     1.9725     1.2126     0.5207     0.0029     8.4527    94.7781    54924.76   7507.09    -8817.0   -8791.944    25.168   
   4200     13373.32    5.0355     3.0813     1.9401     1.201      0.4841     0.0028     8.1812    94.8387    54898.78   7489.95    -8819.0   -8793.294    25.351   
   4300     13683.17    5.0303     3.0818     1.9075     1.165      0.5144     0.0028     7.791     94.6252    54917.62   7484.96    -8780.0   -8754.453    25.433   
   4400     13996.59    5.043      3.0925     1.9184      1.18      0.4786     0.0028     7.3274    95.1221    55105.02   7488.11    -8799.0   -8773.272    25.356   
   4500     14285.61    5.0393     3.0884     1.9002     1.1662     0.4108     0.0027     7.022     95.6828    54999.44   7488.42    -8807.0   -8781.411    25.395   
   4600     14563.29    5.0531     3.0987     1.9014     1.1638     0.5232     0.0028     8.1042    95.7004    55253.11   7507.38    -8774.0   -8748.196    25.541   
   4700     14823.95    5.0639     3.1025     1.9075     1.1692     0.4637     0.0029     8.2625    96.0474    55147.76   7505.26    -8774.0   -8748.744    25.618   
   4800     15084.44    5.0467     3.0904     1.8934     1.1564     0.5206     0.0029     8.6789    96.9485    55149.04   7497.98    -8813.0   -8787.059    25.637   
   4900     15346.25    5.0363     3.0851     1.8877     1.1546     0.4185     0.0028     8.0048    97.0893    55203.91    7493.0    -8836.0   -8810.413    25.734   
   5000     15607.2     5.0387     3.0834     1.8683     1.1494     0.5372     0.0028     8.1731     96.008    55218.05   7471.31    -8787.0   -8761.166    25.666   
   5100     15867.93    5.0748     3.1108     1.877      1.1528     0.5174     0.0028     8.3903    97.6872    55380.63   7488.02    -8783.0   -8757.551    25.748   
   5200     16133.67    5.0714     3.1051     1.8535     1.1412     0.5522     0.0028     8.0333    97.8279    55300.57   7491.35    -8798.0   -8772.342    25.834   
   5300     16384.22    5.0666     3.1028     1.8596     1.141      0.5889     0.0029     8.4486    97.8211    55320.64   7490.87    -8818.0   -8792.632    25.842   
   5400     16653.42    5.0839     3.1156     1.8747     1.1494     0.6902     0.0027     9.3717    97.8789    55380.22   7495.43    -8811.0   -8784.957    25.881   
   5500     16915.64    5.1042     3.1228     1.8597     1.1436     0.6943     0.0028     9.3588    98.5817    55578.89   7492.94    -8840.0   -8814.263    25.958   
   5600     17163.73    5.0989     3.1204     1.8621     1.1506     0.6227     0.0029     9.1382    98.6801    55515.44   7495.06    -8829.0    -8803.37    25.961   
   5700     17412.68    5.1265     3.1362     1.8793     1.1744     0.5275     0.0028     8.5171    99.2543    55494.3    7501.79    -8818.0   -8792.089    25.843   
   5800     17674.7     5.0944     3.1204     1.8294     1.1374     0.4687     0.0029     8.1406    98.8723    55455.31   7481.98    -8832.0   -8805.994    25.909   
   5900     17981.77    5.1105     3.1288     1.8199     1.1228     0.4153     0.0027     7.8502     99.374    55552.46   7496.81    -8823.0   -8797.118    26.054   
   6000     18290.82    5.1062     3.1253     1.822      1.1264     0.4696     0.0028     7.7628    99.6753    55498.41   7485.93    -8812.0    -8785.33    26.186   
   6100     18605.36    5.1169     3.1365     1.8437     1.144      0.4011     0.0028     8.0885    100.546    55632.28   7492.78    -8833.0   -8806.937    26.203   
   6200     18921.07    5.1283     3.1401     1.8271     1.1452     0.4734     0.0029     8.4779    100.7121   55720.4    7491.87    -8825.0   -8798.857    26.18    
   6300     19193.2     5.1255     3.1432     1.864      1.1688     0.5455     0.0028     8.4414    100.7071   55500.47    7490.6    -8802.0   -8776.077    26.123   
   6400     19453.77    5.1207     3.1322     1.8306     1.1274     0.4076     0.0028     7.2118    100.7169   55540.5    7482.64    -8810.0   -8784.208    26.142   
   6500     19771.95    5.1347     3.1421     1.8529     1.155      0.4625     0.0029     8.6609    100.8335   55639.08   7499.29    -8862.0   -8835.655    26.233   
   6600     20036.97    5.1521     3.1534     1.8347     1.1404     0.4559     0.0027     8.4655    100.9435   55632.73   7496.64    -8793.0   -8766.823    26.344   
   6700     20281.66    5.1415     3.1503     1.819      1.139      0.4891     0.0027     8.2669    101.5323   55569.59    7481.5    -8851.0   -8824.924    26.375   
   6800     20526.18    5.1596     3.1623     1.8147     1.128      0.4897     0.0028     7.5237    100.9036   55727.23   7477.24    -8812.0   -8785.803    26.374   
   6900     20770.66    5.1438     3.1543     1.8218     1.1398     0.4097     0.0028     6.7338    102.462    55650.6    7485.27    -8832.0   -8806.003    26.435   
   7000     21017.48    5.1618     3.1637     1.8341     1.1456     0.3671     0.0028     7.8173    102.3554   55844.8    7486.67    -8795.0   -8768.585    26.447   
   7100     21270.39    5.1765     3.1736     1.8433     1.1534     0.392      0.0028     8.0295    103.2312   55844.68   7508.87    -8841.0   -8814.155    26.451   
   7200     21524.19    5.1622     3.1625     1.8452     1.158      0.3894     0.0027     8.4551    103.2635   55780.51   7492.94    -8851.0   -8824.255    26.25    
   7300     21778.0     5.1431     3.1468     1.8132     1.1322     0.4767     0.0028     7.7559    102.5766   55697.77   7491.89    -8853.0   -8826.525    26.477   
   7400     22032.03    5.1613     3.1598     1.8082     1.1248     0.5722     0.0029     8.5363    103.1132   55796.65   7494.11    -8865.0   -8838.752    26.52    
   7500     22285.76    5.1768     3.1647     1.8199     1.1304     0.5922     0.0027     9.2944    102.9591   55911.46   7486.14    -8890.0   -8863.628    26.488   
   7600     22539.6     5.161      3.1564     1.8082     1.1168     0.5081     0.0027     9.6009    103.7458   55866.12   7489.02    -8857.0    -8830.78    26.443   
   7700     22793.56    5.175      3.1646     1.8131     1.1226     0.8455     0.0027    10.2894    104.033    55941.44   7496.93    -8911.0   -8884.743    26.371   
   7800     23047.06    5.1884     3.169      1.8197     1.1266     0.6312     0.0028    10.4409    104.7374   55834.62   7504.99    -8885.0   -8858.554    26.392   
   7900     23301.05    5.1667     3.1621     1.8193     1.134      0.5687     0.0026     9.0381    104.1294   55772.4     7482.1    -8843.0   -8817.112    26.347   
   8000     23555.24    5.1628     3.1597     1.7976     1.1162     0.6429     0.0027     9.9839    104.0596   56030.47   7495.14    -8878.0   -8851.385    26.424   
   8100     23848.34    5.1731     3.1596     1.815      1.1298     0.7112     0.0026    10.2445    104.7133   55946.27   7510.58    -8898.0   -8871.788    26.348   
   8200     24165.81    5.1887     3.1764     1.8012     1.1114     0.469      0.0026     9.6961    104.3301   55918.22   7491.19    -8896.0   -8869.403    26.478   
   8300     24481.32    5.2015     3.181      1.8107      1.13      0.499      0.0027     9.4894    104.914    56126.55   7496.14    -8890.0   -8863.764    26.43    
   8400     24796.1     5.211      3.184      1.8177     1.133      0.5107     0.0027     9.5908    104.9328   56193.87   7502.83    -8879.0   -8852.804    26.397   
   8500     25109.16    5.199      3.1785     1.7849     1.1056     0.5607     0.0027     9.873     105.0162   56198.2    7498.75    -8918.0   -8891.799    26.471   
   8600     25396.89    5.2307      3.2       1.8009     1.1154     0.5689     0.0027     9.639     105.1858   56368.07   7491.75    -8904.0   -8877.423    26.466   
   8700     25713.23    5.2296     3.1993     1.8007     1.1334     0.4637     0.0027     9.0811    106.0022   56170.7    7502.08    -8896.0   -8869.329    26.517   
   8800     26028.73    5.2283     3.2002     1.8309     1.1578     0.382      0.0027     8.9498    106.2831   56121.54   7506.84    -8863.0   -8836.625    26.419   
   8900     26336.31    5.2149     3.1906     1.7913     1.1228     0.4711     0.0028     9.0565    106.0785   56324.61   7498.97    -8882.0   -8855.252    26.601   
   9000     26650.73    5.2326     3.2027     1.7828     1.1192     0.4548     0.0026     8.8475    105.9032   56114.97   7505.35    -8927.0   -8900.642    26.603   
   9100     26985.9     5.2308     3.1932     1.7854     1.1164     0.4902     0.0026     8.2436    105.9885   56254.43   7487.56    -8847.0    -8820.43    26.452   
   9200     27318.58    5.2363     3.2031     1.7992     1.1306     0.492      0.0026     8.523     106.4129   56234.96   7488.67    -8892.0   -8865.733    26.659   
   9300     27648.82    5.2461     3.2092     1.8024     1.1206     0.3898     0.0026     7.9384    106.514    56470.49   7494.13    -8870.0   -8842.769    26.754   
   9400     27980.56    5.2339     3.201      1.7961     1.1284     0.3785     0.0027     8.476     106.9314   56259.52   7501.41    -8900.0   -8873.662    26.825   
   9500     28313.69    5.2351     3.2066     1.7898     1.1278     0.3332     0.0027     8.4138    107.1598   56403.85   7496.06    -8880.0   -8853.191    26.668   
   9600     28640.99    5.2181     3.1933     1.7904     1.1186      0.4       0.0027     7.964     106.977    56107.09   7487.51    -8875.0   -8847.969    26.681   
   9700     28975.15    5.2184     3.1961     1.7663     1.1094     0.3341     0.0026     8.5261    106.667    56277.38   7487.74    -8904.0   -8876.925    26.671   
   9800     29296.71    5.2438     3.2087     1.8055     1.136      0.3275     0.0028     8.258     107.3439   56224.26   7500.18    -8903.0   -8876.164    26.651   
   9900     29596.45    5.2303     3.2004     1.7918     1.1158     0.3529     0.0027     7.5346    107.4566   56235.34    7502.8    -8857.0   -8830.793    26.626   
  10000     29901.82    5.2323     3.199      1.7842     1.1274     0.3585     0.0027     8.1808    107.5801   56203.68   7501.35    -8870.0    -8843.33    26.608   
  10100     30173.93    5.2336     3.2012     1.7943     1.1272     0.3662     0.0025     8.0006    107.884    56063.38   7502.07    -8869.0    -8842.17    26.627   
  10200     30428.0     5.2378     3.2012     1.7969     1.136      0.4379     0.0026     8.1176    107.8481   56140.65   7492.28    -8880.0    -8853.7     26.702   
  10300     30702.34    5.2484     3.2104     1.795      1.1294     0.4107     0.0027     8.3169    108.3999   56270.94   7499.04    -8878.0   -8851.381    26.68    
  10400     31004.15    5.2454     3.204      1.8223     1.1444     0.4974     0.0026     8.4931    108.9258   56171.9    7510.96    -8927.0    -8900.62    26.669   
  10500     31323.34    5.2198     3.1914     1.7851     1.1218     0.3529     0.0026     8.1557    107.7982   56224.64   7494.33    -8946.0   -8919.547    26.672   
  10600     31660.47    5.2609     3.2178     1.7864     1.1248     0.3712     0.0027     8.979     107.3132   56378.35   7491.46    -8887.0   -8860.255    26.719   
  10700     31962.61    5.2479     3.2151     1.7923     1.1166     0.5072     0.0025     9.3838    107.9673   56318.87   7492.98    -8895.0   -8868.024    26.724   
  10800     32255.45    5.2628     3.2233     1.7897     1.127      0.399      0.0025     9.2329    108.2072   56401.27   7490.48    -8896.0   -8869.556    26.829   
  10900     32534.29    5.253      3.2149     1.7972     1.1328     0.3827     0.0028     9.309     108.4221   56497.8    7499.95    -8891.0   -8864.234    26.626   
  11000     32806.44    5.2613     3.2192     1.7827     1.1224     0.3835     0.0028     8.7152    109.0555   56577.55   7493.76    -8877.0   -8850.296    26.598   
  11100     33084.32    5.2785     3.2278     1.7732     1.1008     0.4556     0.0025     8.8638    108.5003   56607.57   7488.38    -8911.0   -8884.925    26.553   
  11200     33403.52    5.2665     3.2212     1.7671     1.1004     0.4402     0.0027     9.3635    108.8058   56582.82   7482.01    -8888.0   -8861.265     26.7    
  11300     33724.19    5.2788     3.2289     1.7914      1.12      0.3402     0.0025     8.6281    109.199    56436.88   7503.37    -8865.0   -8838.006    26.694   
  11400     34047.94    5.2824     3.2317     1.7856     1.1256     0.4151     0.0026     7.9894    109.6825   56726.1    7502.62    -8876.0   -8849.586    26.722   
  11500     34373.18    5.2949     3.2425     1.7889     1.1314     0.3108     0.0026     8.1614    109.8209   56539.97   7503.66    -8886.0    -8859.26    26.852   
  11600     34700.21    5.2664     3.2229     1.7771     1.1166     0.3608     0.0026     7.4748    110.0903   56345.17   7500.86    -8876.0   -8849.264    26.815   
  11700     34965.15    5.2611     3.2201     1.8023     1.136      0.3081     0.0026     7.9949    110.0298   56276.5    7504.78    -8903.0   -8875.962    26.778   
  11800     35211.03    5.2444     3.209      1.7577     1.0926     0.3684     0.0025     8.3556    109.953    56508.58    7487.7    -8879.0   -8852.687    26.786   
  11900     35472.84    5.2536     3.2078     1.7711     1.1148     0.4196     0.0026     8.3716    109.334    56395.5    7484.37    -8906.0   -8879.516    26.69    
  12000     35720.44    5.2698     3.2208     1.7808     1.1256     0.3362     0.0026     8.0011    110.5238   56576.08   7487.39    -8900.0   -8873.698    26.709   
[-1.27577929e+00  7.15327916e-02  3.55290769e-04  3.17037529e+00
  1.32709595e+00  2.03651634e+00  5.79153139e-01  1.97041268e+00
  3.49102817e-01  1.33053646e+00  2.27664697e+00  2.24845318e+00
  3.81633469e-01  1.40421540e+00 -1.16197589e-02 -5.04376338e-01
  2.16294969e-01 -2.21166208e-01  9.08535420e-01  1.08000415e+00]
[ 1.49731351  0.42741687 -0.58395947  0.29040379  1.46396555  0.26366208
  0.91036242  0.99509216  1.29677114  2.54232697 -1.79389466  1.11931765
  1.65561366  0.61805077  1.74537817  1.85708752  1.14805611  2.70374017
  1.08162858 -0.05088518]
[ 1.36894277  1.24760442 -1.0439942  -0.93613842  1.40150507  1.97352314
  1.67213131  0.8696493   0.218179    0.19567781  2.15865078 -0.59886797
 -0.86821564 -1.72060902  0.9919247   0.94530601  1.26929134  1.03302136
  1.9094155   2.44155395]
