Generating synthetic count valued data ... 
Generating synthetic  count valued data took:  16.97127389907837
max_count =  52  min count =  0
Evaluation for true params: 
 test_rsme | train_rsme | rel-te-err | rel-tr-err |  test_nll  |  train_nll |
2.6464995749 2.6289161265   1.51876      1.50536     163417.29    651123.47  
Using  0.05 of training data
Factorizing with max_iteration = 16000  fixing covariance?:  False
Tensor dimensions:  [50, 50, 50]
Optimization metrics: 
Using Ada Grad
Mean update scheme:  S
Covariance update :  N
Using diagonal covariance?:  False
Random start? True
k1 samples =  64  k2 samples =  128
eta =  1.0  cov eta =  1.0  sigma eta =  1
iteration |   time   |test_rsme |rel-te-err|train_rsme|rel-tr-err|   d_mean  |   d_cov  |avg_grad_m|avg_grad_c| test_nll | train_nll |    VLB   |  E-term  |    KL     |   dw   |
    0         5.03     10.4182     6.6654    10.3722     6.6234     3.1623     0.4025     0.3556   3983.5607  113001.78   22428.5    -28436.0  -28376.66    59.724     0.0022  
    5        147.64    10.4098     6.6668    10.3533     6.6194     3.1623     0.621      3.9109   46700.1363 112390.91   22287.71   -28298.0  -28244.74     53.0      0.0001  
    10       292.73    10.3978     6.6648    10.3251     6.6088     3.1623     0.8663     7.2181   80166.0157 112240.94   22244.74   -28112.0  -28065.145   46.557      0.0    
    20       465.23    10.3417     6.6632    10.1747     6.5588     3.1623     3.2853    20.1271   327074.5215 111701.13   21860.52   -27610.0  -27571.978   38.029      0.0    
    50       740.85     9.9363     6.549      9.2561     6.1466     3.1623    147.407    95.1462   3390254.4883  106163.1   19508.6    -24114.0  -24062.323   51.865      0.0    
   100      1122.71     6.9279     4.2082     5.0752     3.2072     3.0508    152.8054   122.9744  133240116732.4236  66984.36   10865.19   -12132.0  -12091.005   40.742      0.0    
   200      1759.94     5.4598     3.2014     3.339      2.0652     2.3615    35.2023    24.1782   10582611.3032  55617.51   8772.77    -10006.0  -9969.706    36.687      0.0    
   300      2468.09     4.9019     2.8709     2.7643     1.6844      1.9       9.4136    15.4128   6129872.6406  51555.79   8090.71    -9363.0   -9330.358    32.347      0.0    
   400      3185.62     4.6549     2.7516     2.5722     1.5644     1.5113     1.2661    11.4498   524636.6836  49946.69   7926.05    -9207.0   -9177.344    29.426      0.0    
   500      3908.06     4.522      2.6901     2.4968     1.5072     1.4358     0.3396    10.3771   38658.713   49309.41   7820.88    -9122.0   -9094.668    27.315      0.0    
   600      4631.71     4.4086     2.634      2.4259     1.461      1.3673     0.1562     9.8023   5677.1148   48603.64   7761.95    -9055.0   -9029.776    25.566      0.0    
   700      5353.29     4.3068     2.5819     2.353      1.4164     1.1541     0.0933     8.8197    543.6605   48055.28   7709.75    -9013.0   -8989.292    24.075      0.0    
   800      6074.61     4.2268     2.5367     2.2983     1.385      0.9357     0.0786     8.0034    505.2526   47531.68   7663.89    -8973.0   -8949.989    23.074      0.0    
   900      6795.78     4.1589     2.5043     2.2869     1.3746     0.9204     0.0823     7.717     341.9025   47192.66   7655.58    -8973.0   -8950.192    22.533      0.0    
   1000     7518.16     4.1166      2.49      2.2508     1.3638     0.9481     0.0813     7.8334   12563.7799  46917.04   7651.83    -8961.0   -8939.257    21.65       0.0    
   1100     8241.34     4.0792     2.4657     2.2418     1.3564     1.0704     0.0845     8.1984   1538.1607   46707.19   7654.01    -8959.0   -8937.069    21.949      0.0    
   1200     8964.57     4.0365     2.4449     2.2319     1.3526     1.0895     0.0719     8.2879   32482.9126  46497.11   7662.03    -8982.0   -8961.154     21.1       0.0    
   1300     9687.17     4.0197     2.4354     2.2262     1.3522     1.5704     0.1161     8.4605   637157.9019  46426.13   7665.88    -8984.0   -8963.411    20.308      0.0    
   1400     10410.46    3.9996     2.4193     2.2135     1.3374     1.3063     0.1267     8.4466   356060.7397  46245.87   7646.79    -8966.0   -8946.523    19.618      0.0    
   1500     11133.99    3.9619     2.3954     2.1814     1.312      0.9298     0.131      7.7955   873003.6105  46039.48   7629.87    -8956.0   -8936.123    19.826      0.0    
   1600     11858.54    3.9307     2.3756     2.1651     1.301      0.8017     0.1065     7.0828   2181.2702   45840.25   7623.31    -8938.0   -8919.015    19.313      0.0    
   1700     12581.81    3.906      2.3632     2.1535     1.288      0.6883     0.0966     6.6768   478444.8545  45708.4    7625.83    -8936.0   -8917.285    18.754      0.0    
   1800     13305.21    3.8952     2.361      2.1662     1.2998     0.7574     0.1895     6.7716   11841.9652  45640.65   7636.86    -8951.0   -8932.649    18.326      0.0    
   1900     14027.8     3.8687     2.342      2.1643     1.3052     0.9784     1.2283     6.9318   56563.5007  45575.65    7634.9    -8957.0   -8937.941    19.239      0.0    
   2000     14751.55    3.8596     2.3366     2.1657     1.2994     0.9556     0.1215     6.8334   14706.5482  45462.98    7629.9    -8949.0   -8929.959    18.807      0.0    
   2100     15474.74    3.8483     2.329      2.1637     1.2958     0.854      0.1099     6.8367   53802.672   45406.25   7636.69    -8955.0   -8936.555    18.363      0.0    
   2200     16196.19    3.8353     2.3273     2.1616     1.2958     0.7948     0.131      6.9344   38691.5963  45352.57   7647.36    -8955.0    -8936.07    18.739      0.0    
   2300     16917.36    3.8354     2.3246     2.1654     1.2984     0.9534     0.1434     6.9307   15732.1022  45332.1     7656.6    -8969.0   -8950.303    18.417      0.0    
   2400     17638.45    3.8109     2.3123     2.1688     1.295      0.848      0.1332     6.8608   196339.3608  45245.6    7660.41    -8961.0   -8942.605    18.003      0.0    
   2500     18359.87    3.7964     2.3017     2.1773     1.2992     0.8249     0.1644     6.6473   95520.6927  45198.51   7654.67    -8962.0   -8943.207    18.544      0.0    
   2600     19081.03    3.7864     2.296      2.1664     1.291      0.8354     0.2339     6.375    56637.7393  45143.76   7656.99    -8969.0   -8951.208    18.21       0.0    
   2700     19801.46    3.7824     2.2946     2.1633     1.2904     0.8377     0.1099     6.2704   31314.3924  45103.3    7661.52    -8962.0   -8943.895    18.098      0.0    
   2800     20521.31    3.7781     2.2898     2.1653     1.2868     0.8132     0.1766     6.1489   2549.2195   45045.73   7663.51    -8980.0   -8960.824    19.633      0.0    
   2900     21240.68    3.7691     2.281      2.1753     1.2828     0.7315     0.1818     5.8727   2757.6284   45009.45   7659.68    -8974.0   -8954.202    19.379      0.0    
   3000     21960.64    3.7642     2.2769     2.1584     1.2812     0.8217     0.2065     5.6687   182754.1672  44961.44   7665.72    -8972.0   -8952.622    19.14       0.0    
   3100     22680.38    3.7546     2.2751     2.1649     1.2886     0.7907     0.1613     5.7857   12442.7261  44955.55   7674.99    -8985.0   -8965.628    18.973      0.0    
   3200     23399.35    3.7523     2.2702     2.1625     1.2774     0.6715     0.1423     5.6516    340.3123   44893.53   7672.89    -8982.0   -8962.945    19.266      0.0    
   3300     24118.27    3.7362     2.2586     2.1556     1.2856     0.6574     0.162      5.4319   4020.9431   44854.18   7679.26    -8987.0    -8967.87    19.044      0.0    
   3400     24835.59    3.7385     2.2651     2.1719     1.2924     0.6628     0.2545     5.3551   66712.425   44793.95   7679.66    -8990.0   -8969.888    20.183      0.0    
   3500     25552.13    3.7282     2.2561     2.1661     1.2894     0.6999     0.2356     5.332    71599.3235  44753.4    7682.66    -8996.0   -8976.161    19.967      0.0    
   3600     26267.76    3.7304     2.2581     2.1732     1.2864     0.6875     0.1711     5.4473   236411.7729  44737.71    7685.1    -8987.0   -8966.994    19.766      0.0    
   3700     26982.16    3.7307     2.2595     2.1958     1.3026     0.584      0.189      5.6301   36740.793   44782.68   7694.51    -9002.0   -8982.077    19.531      0.0    
   3800     27696.31    3.7312     2.2602     2.1926     1.3018     0.7522     0.1021     6.2029   313283.9658  44784.93   7709.05    -9018.0   -8998.667    19.384      0.0    
   3900     28409.99    3.7188     2.2536     2.193      1.3064     0.7457     0.175      6.2491   12556.5154  44759.89   7707.31    -9024.0   -9004.336    19.183      0.0    
   4000     29123.9     3.7138      2.25      2.2024     1.3076     0.6951     0.2025     5.9957   233797.9376  44708.07    7708.0    -9025.0   -9005.904    19.013      0.0    
   4100     29837.29    3.7214     2.2517     2.2055     1.3016     0.7106     0.1791     5.7546   375018.1019  44695.16   7702.33    -9024.0   -9004.793    18.824      0.0    
   4200     30549.17    3.7128     2.2444     2.217      1.3026     0.7152     0.1175     5.9113   12840.689   44659.53   7706.19    -9020.0   -9000.454    19.219      0.0    
   4300     31260.29    3.6941     2.2366     2.2021     1.2964     0.7361     0.1762     5.6545    302.471    44629.1    7708.89    -9021.0   -9001.801    19.05       0.0    
   4400     31970.67    3.702      2.2371     2.1936     1.2912     0.6477     0.2441     5.5451   640142.7775  44639.8    7706.07    -9028.0   -9008.434    19.249      0.0    
   4500     32679.88    3.6934     2.2276     2.1944     1.2944     0.6933     0.8359     5.3065   353022.722  44627.96   7715.32    -9012.0   -8992.614    19.053      0.0    
   4600     33390.3     3.6884     2.2259     2.2179     1.2982     0.7788     0.2104     5.5183   47518.1872  44609.49    7714.5    -9006.0   -8987.255    18.907      0.0    
   4700     34099.48    3.6987     2.2307     2.2047     1.296      0.9145     0.277      5.3737   159629.8568  44585.54   7712.01    -9007.0   -8988.605     18.8       0.0    
   4800     34808.06    3.6885     2.2238     2.1795     1.2794     0.891      0.2177     5.0391    139.0823   44548.89   7712.31    -9019.0   -8999.818    18.816      0.0    
   4900     35515.78    3.6769     2.2201     2.2005     1.2964     0.7503     0.3562     4.6866   128590.0832  44522.65   7712.29    -9018.0   -8998.974    18.661      0.0    
   5000     36223.47    3.6812     2.2234     2.1777     1.2804     0.6667     0.387      4.7405    858.3452   44500.19   7719.08    -9035.0   -9016.708    18.54       0.0    
   5100     36931.44    3.6674     2.2144     2.1718     1.2778     0.5953     0.1223     4.5191    250.185    44461.75   7719.78    -9030.0   -9011.733    18.398      0.0    
   5200     37638.5     3.6775     2.2193     2.1929     1.2914     0.509      0.2501     4.2863   34963.2261  44456.95   7722.38    -9022.0   -9004.025    18.21       0.0    
   5300     38345.77    3.6686     2.2096     2.1816     1.2798     0.523      0.3059     4.2431   33017.2509  44486.08   7726.14    -9031.0   -9012.492    18.103      0.0    
   5400     39053.17    3.6585     2.2124     2.1664     1.2732     0.4741     0.9689     4.3999   2532.0597   44482.36   7729.47    -9028.0   -9009.762    17.962      0.0    
   5500     39759.25    3.6674      2.21      2.184      1.275      0.4335     0.4981     4.3899    637.5598   44458.3    7735.76    -9038.0   -9020.043    17.863      0.0    
   5600     40465.78    3.6627     2.2142     2.1726     1.2798     0.4568     3.1404     4.2911   41111.716   44432.78   7715.96    -9031.0   -9012.834    17.765      0.0    
   5700     41171.37    3.6588     2.2163     2.1711      1.28      0.4756     0.0945     4.0804    417.8535   44438.13    7722.1    -9030.0   -9012.771    17.647      0.0    
   5800     41877.48    3.6521     2.2083     2.1827     1.282      0.5329     0.9088     4.2539    4555.836   44436.29   7732.51    -9043.0   -9025.584    17.511      0.0    
   5900     42583.38    3.6586     2.2125     2.1877     1.299      0.606      0.1708     4.5681   10815.2473  44462.72    7743.3    -9052.0   -9034.455    17.412      0.0    
   6000     43288.72    3.6488     2.2082     2.1921     1.2972     0.5961     0.1936     4.8034   1786431.5621  44459.83   7747.62    -9047.0   -9029.547    17.293      0.0    
   6100     43993.91    3.658      2.2116     2.204      1.3026     0.5422     0.2112     4.8408    6421.267   44401.55   7736.17    -9042.0   -9025.334    17.128      0.0    
   6200     44697.6     3.6513     2.2111     2.1796     1.2864     0.5197     0.2338     4.8013   62979.2322  44397.46   7733.72    -9039.0   -9022.193    17.023      0.0    
   6300     45402.68    3.6543     2.2082     2.2319     1.312      0.5532     0.2063     4.7777    688.6573   44384.9    7734.77    -9050.0   -9033.228    16.94       0.0    
   6400     46106.96    3.6546     2.2122     2.2037     1.2904     0.5444     0.657      4.9073   1696.0714   44366.38   7737.45    -9046.0   -9028.967    16.883      0.0    
   6500     46811.92    3.6484     2.2066     2.1932     1.2964     0.5644     0.1736     5.0452   46006.7775  44362.91   7742.64    -9038.0   -9021.343    16.79       0.0    
   6600     47516.15    3.6438     2.2056     2.2172     1.309      0.5427     0.2219     5.0094   4592.6638   44347.2    7740.07    -9054.0   -9036.934    16.623      0.0    
   6700     48220.49    3.6489     2.2106     2.2083     1.3008     0.5221     0.276      5.0024   1210.9365   44386.65   7745.68    -9054.0   -9037.218    16.517      0.0    
   6800     48924.97    3.649      2.2112     2.1908     1.2934     0.4992     0.2555     4.9579   460896.522  44359.06   7744.36    -9052.0   -9035.132    16.506      0.0    
   6900     49628.45    3.6449     2.2082     2.1939     1.2918     0.4998     0.2955     4.6753   86640.3167  44327.4     7742.7    -9055.0   -9038.496    16.441      0.0    
   7000     50332.43    3.6366     2.2049     2.1971     1.3066     0.5931     0.2608     4.5142    140.3272   44327.28   7746.57    -9068.0   -9051.924    16.41       0.0    
   7100     51036.21    3.6315      2.2       2.1985     1.297      0.6273     0.4292     4.3607   11488.0075  44337.21   7733.44    -9058.0   -9041.427    16.277      0.0    
   7200     51738.71    3.6392     2.2013     2.1946     1.2924     0.5784     1.2181     3.9343   1305.9798   44284.27   7735.21    -9046.0   -9029.797    16.194      0.0    
   7300     52441.76    3.6331     2.1942     2.1797     1.2806     0.5061     0.2226     3.9897   63845.4214  44302.25    7735.3    -9050.0   -9034.089    16.159      0.0    
   7400     53144.51    3.6469     2.2027     2.1766     1.281      0.4812     0.143      3.8205   11854.9496  44307.29   7725.32    -9051.0   -9034.616    16.083      0.0    
   7500     53846.85    3.6402     2.2016     2.1745     1.2814     0.4939     0.252      3.7579   765006.6102  44329.8    7737.54    -9048.0   -9031.691    16.246      0.0    
   7600     54550.05    3.6256     2.1918     2.1846     1.2834     0.4727     0.2266     3.7116    373.0621   44274.71   7735.38    -9046.0   -9030.152    16.245      0.0    
   7700     55252.42    3.6254     2.1905     2.2021     1.2978     0.5536     0.4551     4.0526   1301.6096   44272.57   7742.03    -9057.0   -9040.857    16.124      0.0    
   7800     55954.92    3.6303     2.1939     2.2034     1.297      0.5706     0.2958     4.3496   12334.7523  44323.92    7750.4    -9056.0    -9040.21    15.993      0.0    
   7900     56658.02    3.637      2.1963     2.1892     1.2888     0.5936     0.3231     4.4377   112162.4206  44314.03   7748.46    -9051.0   -9035.174    15.898      0.0    
   8000     57360.74    3.6211     2.1865     2.1923     1.2984     0.5689     0.3118     4.4494   10219.8044  44256.4    7745.37    -9053.0   -9037.227    15.808      0.0    
   8100     58062.18    3.627      2.1898     2.1983     1.2928     0.5577     0.2537     4.6433   2758.9283   44305.24   7759.82    -9063.0   -9046.775    15.753      0.0    
   8200     58763.71    3.6368     2.196      2.1761     1.2842     0.5904     0.3057     4.6315   10031.5666  44283.12   7754.38    -9063.0   -9047.285    15.797      0.0    
   8300     59464.34    3.6276     2.1889     2.1738     1.2738     0.5724     3.5166     4.3853   45271.5319  44257.17   7744.99    -9048.0   -9032.081    15.795      0.0    
   8400     60164.88    3.625      2.1912     2.1894     1.2926     0.4976     0.4749     4.203     510.9844   44267.53   7746.72    -9050.0   -9034.645    15.74       0.0    
   8500     60865.85    3.6309     2.194      2.1667      1.28      0.4367     0.9881     4.2206   31052.083   44281.84   7745.95    -9051.0   -9035.488    15.682      0.0    
   8600     61566.86    3.6172     2.1913     2.1758     1.2804     0.3623     2.7573     4.1706    108.666    44289.12   7746.68    -9059.0   -9043.725    15.663      0.0    
   8700     62268.48    3.6264     2.1835     2.1871     1.2828     1.6966    24.3228     4.1331   79348.0061  44256.33   7737.96    -9049.0    -9033.7     15.546      0.0    
   8800     62968.97    3.6247     2.185      2.1857     1.2786     1.041      0.3031     3.9188   1208.4681   44267.59   7749.13    -9052.0   -9036.803    15.503      0.0    
   8900     63669.97    3.6251     2.1889     2.1838     1.282      0.7294     0.556      3.8509    2269.697   44260.03   7745.83    -9052.0   -9036.676    15.487      0.0    
   9000     64364.41    3.6182     2.185      2.1713     1.2708     0.5092     0.8731     3.5687   13123.0067  44241.21   7748.34    -9052.0   -9036.391    15.411      0.0    
   9100     65044.17    3.621      2.185      2.1628     1.2734     0.4163     0.2269     3.4386   63277.8202  44259.15   7747.46    -9062.0   -9046.715    15.328      0.0    
   9200     65731.17    3.6227     2.1879     2.182      1.2868     0.5249     0.7577     3.6418   1059.4855   44271.76   7753.36    -9064.0   -9047.429    16.326      0.0    
   9300     66419.5     3.6271     2.1931     2.1806     1.2958     0.5491     1.2935     4.0696   1080.1639   44279.75   7757.83    -9070.0   -9053.652    16.561      0.0    
   9400     67099.55    3.6233     2.1912     2.1852     1.2932     0.6027     0.7301     4.1695   36291.7186  44268.95   7761.44    -9066.0   -9049.941    16.484      0.0    
   9500     67785.07    3.632      2.1928      2.19      1.3008     0.4651     0.2115     4.1749   17275.5943  44272.45   7749.26    -9065.0   -9048.013    17.363      0.0    
   9600     68461.57    3.6124     2.182      2.1738     1.2772     0.4678     0.3768     3.9802   108416.1193  44272.11   7754.27    -9057.0   -9039.587    17.271      0.0    
   9700     69143.21    3.6184     2.182      2.1641     1.2752     0.5009     0.4138     3.9426   14880.6427  44252.37   7747.53    -9055.0   -9038.087    17.255      0.0    
   9800     69819.0     3.6345     2.1863     2.1939     1.289      0.4868     0.6168     4.057    3549.8368   44246.44   7748.45    -9056.0    -9038.67    17.126      0.0    
   9900     70495.05     3.61      2.175      2.1713     1.2778     0.5636     2.551      4.2021   9487.4169   44287.39   7744.87    -9047.0    -9030.29    17.152      0.0    
  10000     71172.09    3.6325     2.1893     2.1704     1.2758     0.6344     0.307      4.3045    161.3625   44293.95   7751.71    -9058.0   -9040.767    17.108      0.0    
  10100     71851.17    3.6191     2.1799     2.171      1.277      0.6572     0.7211     4.3135   6771.8843   44278.34   7744.74    -9046.0   -9028.605    17.164      0.0    
  10200     72533.24    3.6396     2.1871     2.1661     1.277      0.6026     0.162      4.1965   18943.9149  44285.21   7737.73    -9045.0   -9028.011    17.104      0.0    
  10300     73210.69    3.6274     2.186      2.1474     1.2668     0.4564     0.2806     3.9639   20786.2223  44283.4    7744.26    -9051.0   -9033.765    17.161      0.0    
  10400     73887.05    3.6252     2.1823     2.1611     1.269      0.4354     0.1789      4.0      712.5041   44276.24   7740.53    -9045.0   -9027.991    17.099      0.0    
  10500     74565.62    3.6357     2.1902     2.1494     1.2628     0.4367     0.2057     3.863    6097.0774   44257.35   7741.42    -9046.0   -9028.627    17.02       0.0    
  10600     75242.24    3.6173     2.1769     2.1678     1.2742     0.5293     0.5365     4.106    92641.2808  44267.17   7738.35    -9046.0   -9028.617    17.434      0.0    
  10700     75917.97    3.625      2.1849     2.147      1.2636     0.4535     0.8299     4.1944    801.2597   44265.85   7742.89    -9044.0   -9026.985    17.393      0.0    
  10800     76594.68    3.6251     2.1833     2.1781     1.2804     0.4277     0.231      4.1911   18286.195   44266.84    7736.8    -9038.0   -9020.218    17.384      0.0    
  10900     77270.04    3.6243     2.1842     2.1565     1.2718     0.3721     0.6922     4.0261   10526.4336  44278.14   7727.28    -9042.0   -9024.319    17.341      0.0    
  11000     77945.11    3.6175     2.1808     2.1707     1.2802     0.4234     0.2947     4.1185   49145.6649  44279.15   7739.81    -9041.0   -9023.685    17.286      0.0    
  11100     78620.47    3.619      2.1843     2.1443     1.2704     0.3929     0.1815     4.1393    658.4689   44265.65   7730.71    -9041.0   -9023.975    17.253      0.0    
  11200     79294.92    3.6224     2.1858     2.1439     1.2662     0.3928     1.6809     4.233    1494.0017   44316.11   7728.87    -9033.0   -9015.335    17.174      0.0    
  11300     79969.64    3.6138     2.1766     2.1503     1.2642     0.4522     0.3165     4.3185    805.4171   44277.96    7725.1    -9032.0   -9014.963    17.211      0.0    
  11400     80646.44    3.6237     2.1841     2.1372     1.2606     0.477      0.2529     3.9712   8450.2118   44253.49    7730.2    -9029.0   -9011.363    17.182      0.0    
  11500     81321.94    3.6292     2.1846     2.1418     1.271      0.4492     0.2523     3.8714   111273.9313  44304.68   7721.61    -9039.0   -9021.689    17.173      0.0    
  11600     81996.79    3.6314     2.188      2.1367     1.2558     0.4802     0.8578     3.847    2936.3899   44312.61   7718.64    -9027.0   -9010.271    17.123      0.0    
  11700     82672.65    3.6273     2.1836     2.1327     1.254      0.4163     0.3009     3.7674   22173.9056  44296.78   7719.74    -9029.0   -9011.659    17.08       0.0    
