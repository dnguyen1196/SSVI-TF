Generating synthetic count valued data ... 
Generating synthetic  count valued data took:  17.081322193145752
max_count =  54  min count =  0
Evaluation for true params: 
 test_rsme | train_rsme | rel-te-err | rel-tr-err |  test_nll  |  train_nll |
2.6301710971 2.6244751856   1.51412      1.50653     162498.41    646060.02  
Using  0.05 of training data
Factorizing with max_iteration = 16000  fixing covariance?:  False
Tensor dimensions:  [50, 50, 50]
Optimization metrics: 
Using Ada Grad
Mean update scheme:  S
Covariance update :  N
Using diagonal covariance?:  False
Random start? True
k1 samples =  64  k2 samples =  128
eta =  1.0  cov eta =  1.0  sigma eta =  1
iteration |   time   |test_rsme |rel-te-err|train_rsme|rel-tr-err|   d_mean  |   d_cov  |avg_grad_m|avg_grad_c| test_nll | train_nll |    VLB   |  E-term  |    KL     |   dw   |
    0         1.8      10.3667      6.65     10.4445     6.651      3.1623     1.1183     0.7347     0.4426   157989.61   31307.96   -83937.0  -83886.234   51.133     0.0266  
    5        127.64    10.3687     6.6509     10.435     6.6474     3.1623     1.1183     5.2371     5.2266   157438.79   31084.15   -83040.0  -82995.041   44.54      0.0017  
    10       264.48    10.3679     6.6525    10.4106     6.6304     3.1623     1.1183    10.5773    10.4565   154934.05   30473.75   -82188.0  -82148.986   39.059     0.0012  
    20       421.34    10.3362     6.6448    10.2864     6.5534     3.1623     1.1183    28.7902    26.8793   151880.03   29483.97   -78482.0  -78449.652   32.375     0.0009  
    50       639.27     9.7562     6.3052     9.1304     5.8316     3.1623     0.921     176.0118   117.744    130715.3   23414.41   -48362.0  -48323.212   38.787     0.0003  
   100       952.6      6.2529     3.7727     5.0155     3.1086     3.0812     0.2863    234.7915   209.7403   66317.99   11031.75   -13749.0  -13714.828   33.836     0.0004  
   200      1365.18     5.1541     3.0394     3.457      2.0962     2.6653     0.1784     33.866    90.2882    55272.15   8784.23    -10472.0  -10442.721   29.063      0.0    
   300      1780.62     4.6867     2.7929     3.064      1.8472     1.5095     0.1332    22.1047    95.1257    51967.26   8311.58    -9737.0   -9710.456    26.414      0.0    
   400      2197.98     4.5145     2.714      2.878      1.728      1.7132     0.1083    19.4444    97.5464    50854.71   8063.27    -9321.0   -9296.439    25.022      0.0    
   500       2616.4     4.3868     2.6548     2.7774     1.6612     1.2795     0.0934    15.5769    100.5739   50236.3    7928.02    -9086.0   -9061.604    24.077      0.0    
   600      3034.63     4.328      2.6284     2.7072     1.6134     1.0306     0.0822    14.5274    102.622    49876.37   7855.99    -8967.0   -8943.631    23.329      0.0    
   700      3454.35     4.297      2.6188     2.6582     1.5896     1.0543     0.0743    14.0295    104.6976   49759.5    7798.92    -8882.0    -8858.81    22.796      0.0    
   800       3874.3     4.2615     2.5993     2.6109     1.5626     1.0081     0.068     13.4044    105.9815   49532.41   7752.45    -8824.0   -8801.285    22.445      0.0    
   900      4294.16     4.2403     2.5895     2.5948     1.5484     0.8823     0.0633    13.1682    107.185    49417.65   7717.38    -8780.0    -8758.16    22.089      0.0    
   1000     4714.72     4.2345     2.5839     2.5821     1.544      0.9109     0.0598    13.2628    108.373    49374.56   7702.12    -8757.0   -8735.537    21.836      0.0    
   1100     5134.23     4.2246     2.5759     2.5628     1.5384     0.9377     0.0572    13.4608    108.8818   49387.03   7680.75    -8740.0   -8718.608    21.617      0.0    
   1200      5553.5     4.2106      2.57      2.5492     1.5208     0.8561     0.0541    13.2606    109.7066   49288.66   7657.13    -8714.0   -8692.535    21.338      0.0    
   1300     5973.26     4.2002     2.5625     2.5363     1.5024     0.8175     0.0532    13.0423    110.3659   49241.72    7631.5    -8661.0   -8639.456    21.13       0.0    
   1400     6390.59     4.1909     2.5548     2.522      1.5046     0.7985     0.0511    12.9148    111.2216   49265.06   7615.66    -8629.0   -8607.775    20.985      0.0    
   1500     6808.66     4.1898     2.5562     2.5154     1.4842     0.7614     0.0505    12.5048    112.058    49295.45   7604.93    -8607.0    -8586.03    20.902      0.0    
   1600     7226.16     4.1866     2.5554     2.4902     1.4754     0.7165     0.0489    12.4824    112.6464   49250.17   7601.37    -8609.0   -8587.957    20.833      0.0    
   1700     7644.45     4.1889     2.5534     2.4952     1.4674     0.7068     0.048     12.3105    113.2471   49273.99    7580.5    -8590.0   -8569.209    20.743      0.0    
   1800      8062.4     4.1795     2.549      2.4746     1.4574     0.6573     0.0474    12.0671    114.1635   49226.86   7577.21    -8557.0   -8536.582    20.603      0.0    
   1900     8479.67     4.1903     2.554      2.4787     1.4646     0.6908     0.0472     12.133    114.8278   49251.98   7570.57    -8567.0   -8546.534    20.588      0.0    
   2000     8897.39     4.1893     2.5548     2.4774     1.4648     0.6926     0.0458     12.361    115.5319   49336.91   7570.65    -8605.0   -8584.942    20.499      0.0    
   2100     9316.07     4.195      2.5558     2.4694     1.471      0.6976     0.0451    12.5971    116.4379   49403.34   7575.27    -8573.0    -8552.05    20.47       0.0    
   2200     9734.02     4.1955     2.558      2.4833     1.4686     0.6818     0.045      13.038    117.3437   49478.24   7571.08    -8589.0    -8568.56    20.485      0.0    
   2300     10151.13    4.2087     2.5682     2.5022     1.479      0.6535     0.0447    13.5663    118.2676   49464.69   7581.37    -8600.0   -8579.597    20.482      0.0    
   2400     10567.3     4.2134     2.5684     2.5071     1.484      0.7346     0.0447    14.2354    119.2515   49567.41    7579.4    -8572.0    -8551.88    20.431      0.0    
   2500     10983.57    4.2229     2.5724     2.5117     1.4864     0.6773     0.0448    14.6649    120.3403   49678.31   7587.78    -8599.0   -8578.418    20.48       0.0    
   2600     11402.22    4.2341     2.5817     2.513      1.4854     0.7258     0.0442    14.8108    121.9062   49751.56   7587.31    -8601.0   -8580.853    20.491      0.0    
   2700     11820.23    4.2395     2.584      2.5286     1.497      0.6656     0.0442    15.3676    123.2118   49865.05   7600.16    -8620.0   -8599.648    20.47       0.0    
   2800     12237.22    4.2597     2.5992     2.5422     1.5082     0.6998     0.044     16.8187    124.7703   50032.97   7618.75    -8668.0   -8647.101    20.55       0.0    
   2900     12655.11    4.2709     2.6064      2.58      1.5318     0.6916     0.0441    18.2229    126.8294   50199.51   7637.98    -8693.0   -8671.873    20.643      0.0    
   3000     13071.33    4.287      2.6141     2.6038      1.54      0.768      0.0443     20.05     128.9198   50367.05   7665.97    -8767.0   -8746.056    20.826      0.0    
   3100     13487.98    4.3359     2.6441     2.6659     1.5834     0.743      0.0448    22.3482    132.3577   50727.09   7712.25    -8843.0   -8821.608    20.976      0.0    
   3200     13904.62    4.411      2.6945     2.7496     1.6298     0.8038     0.0452    25.7155    136.9002   51268.09   7785.45    -9007.0   -8986.046    21.267      0.0    
   3300     14321.26    4.5166     2.7537     2.8889     1.7088     1.0083     0.0462    30.4034    144.0612   51941.28   7885.52    -9203.0   -9180.906    21.659      0.0    
   3400     14737.8     4.6945     2.8642     3.1164     1.8448     1.029      0.0474     38.258    155.7814   53101.26   8086.19    -9559.0   -9537.061    22.339      0.0    
   3500     15153.96    5.0757     3.0883     3.5983     2.1296     1.0563     0.0496    52.2886    179.7864   55514.91   8485.43    -10314.0  -10290.927   23.503      0.0    
   3600     15570.31    6.0845     3.6638     4.7847     2.8018     1.245      0.0542    83.0122    237.1575   60749.18   9458.16    -12008.0  -11982.704   25.151      0.0    
   3700     15987.68    8.3386     4.9125     7.1675     4.072      1.4143     0.0729    147.9194   379.3915   72700.93   11625.79   -15509.0  -15481.172   27.776      0.0    
   3800     16404.42   12.1847     7.1549     10.943     6.2334     1.5413     0.0922    266.7949   664.5395   94418.94   15761.38   -21961.0  -21930.017   30.821      0.0    
   3900     16822.97   18.2368    10.8597    16.7407     9.788      1.689      0.091     415.142    1134.981  127399.83   22187.98   -33530.0  -33495.403   34.28       0.0    
   4000     17242.52   27.7605    16.9724    25.6325     15.493     1.7659     0.0777    560.6648  1655.4093  165336.72   29846.73   -53235.0  -53197.893   37.345      0.0    
   4100     17661.19   39.8886     24.907    36.7818    22.6448     1.9273     0.0676    579.074   2024.3302  199799.84   36487.57   -81470.0  -81429.179   40.429      0.0    
   4200     18077.49   55.1869    33.7322    50.8735    30.4002     2.2215     0.0667    581.4943  2343.2534  219468.58   40532.08  -119631.0  -119587.61   43.114      0.0    
   4300     18490.81   69.4896    40.2284    64.1024    35.9904     2.3091     0.0715    640.7419  2607.5719  225452.34   42045.07  -162566.0  -162519.629   45.877      0.0    
   4400     18904.79   74.7056    38.2212    69.1715    33.9094     2.3052     0.0759    756.162   3011.7878  215039.84   41091.18  -205845.0  -205795.739   48.772      0.0    
   4500     19318.23   69.0637    30.5467    64.1567     27.513     2.2393     0.0713    876.7208  3414.3688  224512.14   43750.86  -279006.0  -278954.465   51.233      0.0    
   4600     19729.82   55.7816    21.6339    51.0646    19.5568     2.078      0.0627    971.9633  3627.5512   231776.8   45424.07  -356222.0  -356169.18   53.245      0.0    
   4700     20141.29   39.4022     14.395    35.6147     13.035     2.0261     0.0506   1017.9672  3523.9837  243252.76   47612.7   -437441.0  -437385.866   55.138      0.0    
   4800     20551.17   25.1232     9.6419    22.1989     8.893      1.8983     0.0491   1078.6634  3486.4097  248537.25   48765.42  -520844.0  -520786.873   56.819      0.0    
   4900     20959.1    17.6943     7.9153    15.5225     7.4358     1.9339     0.0454   1116.7118  3342.3427  257809.72   50577.36  -594616.0  -594557.63   58.367      0.0    
   5000     21364.87   13.3686     7.0906    12.1889     6.8774     1.8992     0.051    1203.7247  3163.7669  262849.43   51935.9   -646660.0  -646600.418   59.889      0.0    
   5100     21768.77   12.6048     7.0013    11.6834      6.87      1.9603     0.0603   1333.2833  2947.6068  266024.98   52795.56  -669814.0  -669752.65   61.375      0.0    
   5200     22173.4    11.9266     6.9205    11.2963     6.8178     2.0367     0.0574   1514.1061  2805.8069  267450.99   53264.13  -681824.0  -681761.369   62.819      0.0    
   5300     22574.26   11.2734     6.8426    11.0798     6.812      2.0665     0.0678   1746.4058  2654.8136  268133.92   53565.37  -689462.0  -689398.183   64.273      0.0    
   5400     22972.67    11.006     6.8208    11.0252     6.814      2.0939     0.0701   2008.2281  2612.1341  268505.09   53641.9   -691972.0  -691906.48   65.686      0.0    
   5500     23369.56   10.9596     6.8168    11.0328     6.8172     2.0712     0.0807   2312.8593  2409.7352  268624.65   53677.86  -692520.0  -692453.373   67.035      0.0    
   5600     23764.75   10.9588     6.8166    11.0328     6.8172     2.0265     0.0887    2645.029  2402.7553  268645.54   53677.86  -692522.0  -692453.373   68.312      0.0    
   5700     24160.29   10.9588     6.8166    11.0328     6.8172     1.9457     0.0873   3006.4655  2435.1447  268647.21   53677.86  -692523.0  -692453.373   69.481      0.0    
   5800     24556.2    10.9588     6.8166    11.0328     6.8172     1.8854     0.1016   3373.8388   2436.94   268647.21   53677.86  -692524.0  -692453.373   70.524      0.0    
   5900     24950.35   10.9588     6.8166    11.0328     6.8172     2.0118     0.1181   3745.4499  2521.8141  268647.21   53677.86  -692525.0  -692453.373   71.529      0.0    
   6000     25345.32   10.9588     6.8166    11.0328     6.8172     1.8351     0.1046   4078.4684  2356.4435  268647.21   53677.86  -692526.0  -692453.373   72.431      0.0    
   6100     25739.09   10.9588     6.8166    11.0328     6.8172     2.2036     0.0959   4389.4037  2450.4695  268647.21   53677.86  -692527.0  -692453.373   73.268      0.0    
   6200     26133.5    10.9588     6.8166    11.0328     6.8172     1.8325     0.1255   4686.6267  2353.6316  268647.21   53677.86  -692527.0  -692453.373   73.979      0.0    
   6300     26526.49   10.9588     6.8166    11.0328     6.8172     1.5184     0.127    4938.7832  2495.1781  268647.21   53677.86  -692528.0  -692453.373   74.661      0.0    
   6400     26919.0    10.9588     6.8166    11.0328     6.8172      1.61      0.1111   5166.9363  2438.1122  268647.21   53677.86  -692529.0  -692453.373   75.299      0.0    
   6500     27312.36   10.9588     6.8166    11.0328     6.8172     1.5371     0.1214   5347.2078  2544.3756  268647.21   53677.86  -692529.0  -692453.373   75.886      0.0    
   6600     27705.12   10.9588     6.8166    11.0328     6.8172     1.3661     0.1045   5476.0857  2499.9694  268647.21   53677.86  -692530.0  -692453.373   76.467      0.0    
   6700     28098.77   10.9588     6.8166    11.0328     6.8172     1.3304     0.1119   5614.7421  2485.5652  268647.21   53677.86  -692530.0  -692453.373   76.972      0.0    
   6800     28491.91   10.9588     6.8166    11.0328     6.8172     1.2938     0.1116   5747.8411  2503.7354  268647.21   53677.86  -692531.0  -692453.373   77.499      0.0    
   6900     28885.31   10.9588     6.8166    11.0328     6.8172     1.2241     0.0971   5904.1611  2545.4569  268647.21   53677.86  -692531.0  -692453.373   77.918      0.0    
   7000     29277.49   10.9588     6.8166    11.0328     6.8172     1.1735     0.1051   6024.9832   2644.713  268647.21   53677.86  -692532.0  -692453.373   78.38       0.0    
   7100     29669.95   10.9588     6.8166    11.0328     6.8172     1.308      0.1448   6174.4766  2698.3024  268647.21   53677.86  -692532.0  -692453.373   78.865      0.0    
   7200     30063.06   10.9588     6.8166    11.0328     6.8172     1.7264     0.1123   6366.4996  2777.4928  268647.21   53677.86  -692533.0  -692453.373   79.262      0.0    
   7300     30456.55   10.9588     6.8166    11.0328     6.8172     1.9347     0.1134   6522.0867  2506.8864  268647.21   53677.86  -692533.0  -692453.373   79.681      0.0    
   7400     30849.05   10.9588     6.8166    11.0328     6.8172     1.1982     0.0952   6646.4734  2796.3957  268647.21   53677.86  -692533.0  -692453.373   80.068      0.0    
   7500     31241.48   10.9588     6.8166    11.0328     6.8172     1.1369     0.1109   6806.7169  2543.9772  268647.21   53677.86  -692534.0  -692453.373   80.422      0.0    
   7600     31633.57   10.9588     6.8166    11.0328     6.8172     1.4125     0.1109   6974.2133  2802.9291  268647.21   53677.86  -692534.0  -692453.373   80.668      0.0    
   7700     32024.31   10.9588     6.8166    11.0328     6.8172     1.4926     0.0915   7183.0851  2400.2739  268647.21   53677.86  -692534.0  -692453.373   80.812      0.0    
   7800     32414.82   10.9588     6.8166    11.0328     6.8172     2.4045     0.1288   7439.2293  3050.9878  268647.21   53677.86  -692534.0  -692453.373   81.083      0.0    
   7900     32805.82   10.9588     6.8166    11.0328     6.8172     1.1677     0.1022   7674.5617  2963.5602  268647.21   53677.86  -692535.0  -692453.373   81.38       0.0    
   8000     33198.64   10.9588     6.8166    11.0328     6.8172     1.0529     0.1131   7927.4147  2815.2948  268647.21   53677.86  -692535.0  -692453.373   81.564      0.0    
   8100     33589.18   10.9588     6.8166    11.0328     6.8172     1.2446     0.1107    8216.331  2799.6839  268647.21   53677.86  -692535.0  -692453.373   81.858      0.0    
   8200     33979.59   10.9588     6.8166    11.0328     6.8172     1.5007     0.1039    8532.932  2198.5831  268647.21   53677.86  -692536.0  -692453.373   82.211      0.0    
   8300     34370.37   10.9588     6.8166    11.0328     6.8172     2.6237     0.1156   8868.0932  2772.1378  268647.21   53677.86  -692536.0  -692453.373   82.549      0.0    
   8400     34760.48   10.9588     6.8166    11.0328     6.8172     1.589      0.1015   9149.9099  2576.1037  268647.21   53677.86  -692536.0  -692453.373   82.808      0.0    
   8500     35151.08   10.9588     6.8166    11.0328     6.8172     2.7293     0.1683   9521.2966  3068.6482  268647.21   53677.86  -692536.0  -692453.373   83.044      0.0    
   8600     35540.25   10.9588     6.8166    11.0328     6.8172     1.4937     0.1375   9801.2417  3087.0427  268647.21   53677.86  -692537.0  -692453.373   83.304      0.0    
   8700     35929.19   10.9588     6.8166    11.0328     6.8172     2.4702     0.104    10211.7556 3037.3535  268647.21   53677.86  -692537.0  -692453.373   83.502      0.0    
   8800     36318.06   10.9588     6.8166    11.0328     6.8172     2.6242     0.1479   10613.7807 2926.9641  268647.21   53677.86  -692537.0  -692453.373   83.685      0.0    
   8900     36706.77   10.9588     6.8166    11.0328     6.8172     2.8525     0.0972   11028.4684 3550.4044  268647.21   53677.86  -692537.0  -692453.373   83.993      0.0    
   9000     37095.44   10.9588     6.8166    11.0328     6.8172     2.5811     0.1039   11364.0958 2394.7132  268647.21   53677.86  -692538.0  -692453.373   84.279      0.0    
   9100     37483.19   10.9588     6.8166    11.0328     6.8172     3.0981     0.1897   12241.6738 3064.1981  268647.21   53677.86  -692538.0  -692453.373   84.523      0.0    
   9200     37870.53   10.9588     6.8166    11.0328     6.8172     1.9546     0.1203   12028.2277  2925.853  268647.21   53677.86  -692538.0  -692453.373   84.769      0.0    
   9300     38257.39   10.9588     6.8166    11.0328     6.8172     1.3554     0.1204   12325.6007  2990.529  268647.21   53677.86  -692538.0  -692453.373   84.921      0.0    
   9400     38645.13   10.9588     6.8166    11.0328     6.8172     2.9909     0.0841   13042.828   2921.282  268647.21   53677.86  -692538.0  -692453.373   85.102      0.0    
   9500     39033.3    10.9588     6.8166    11.0328     6.8172     2.7045     0.1029   13311.0435 3164.8261  268647.21   53677.86  -692539.0  -692453.373   85.337      0.0    
   9600     39420.88   10.9588     6.8166    11.0328     6.8172     1.9443     0.0985   13681.3826 3140.7583  268647.21   53677.86  -692539.0  -692453.373   85.501      0.0    
   9700     39808.45   10.9588     6.8166    11.0328     6.8172     1.7254     0.0948   14154.0221 2898.8507  268647.21   53677.86  -692539.0  -692453.373   85.805      0.0    
   9800     40196.56   10.9588     6.8166    11.0328     6.8172     2.6935     0.1106   15067.5136 3540.8341  268647.21   53677.86  -692539.0  -692453.373   85.965      0.0    
   9900     40584.25   10.9588     6.8166    11.0328     6.8172     3.1407     0.1359   16063.8562 3283.3984  268647.21   53677.86  -692540.0  -692453.373   86.173      0.0    
  10000     40971.23   10.9588     6.8166    11.0328     6.8172     2.5545     0.103    15733.7187 3401.4166  268647.21   53677.86  -692540.0  -692453.373   86.136      0.0    
  10100     41358.52   10.9588     6.8166    11.0328     6.8172     2.3889     0.105    16115.0225 3358.4534  268647.21   53677.86  -692540.0  -692453.373   86.352      0.0    
  10200     41745.81   10.9588     6.8166    11.0328     6.8172     3.065      0.0957   16797.4269 3164.3239  268647.21   53677.86  -692540.0  -692453.373   86.455      0.0    
  10300     42133.29   10.9588     6.8166    11.0328     6.8172     2.5249     0.148    16983.5692 3436.0421  268647.21   53677.86  -692540.0  -692453.373   86.684      0.0    
  10400     42520.84   10.9588     6.8166    11.0328     6.8172     3.0337     0.1453   17908.6124 3810.4867  268647.21   53677.86  -692540.0  -692453.373   86.99       0.0    
  10500     42906.99   10.9588     6.8166    11.0328     6.8172     2.1535     0.1675   18178.6275 4027.4204  268647.21   53677.86  -692541.0  -692453.373   87.337      0.0    
  10600     43292.15   10.9588     6.8166    11.0328     6.8172     2.9782     0.1352   18734.4192 4563.8091  268647.21   53677.86  -692541.0  -692453.373   87.551      0.0    
  10700     43677.36   10.9588     6.8166    11.0328     6.8172     2.4749     0.1294   19294.0474 3263.4591  268647.21   53677.86  -692541.0  -692453.373   87.92       0.0    
  10800     44063.22   10.9588     6.8166    11.0328     6.8172     2.6154     0.167    20177.0437  3715.253  268647.21   53677.86  -692541.0  -692453.373   88.06       0.0    
  10900     44448.33   10.9588     6.8166    11.0328     6.8172     2.0247     0.1114   20174.9978  3589.208  268647.21   53677.86  -692542.0  -692453.373   88.233      0.0    
  11000     44832.92   10.9588     6.8166    11.0328     6.8172     2.8723     0.2587   21974.6596 3831.9024  268647.21   53677.86  -692542.0  -692453.373   88.392      0.0    
  11100     45217.58   10.9588     6.8166    11.0328     6.8172     2.7974     0.2053   23642.9604 4676.7012  268647.21   53677.86  -692542.0  -692453.373   88.585      0.0    
  11200     45602.04   10.9588     6.8166    11.0328     6.8172     2.6631     0.4808   22121.4719 4273.6831  268647.21   53677.86  -692542.0  -692453.373   88.745      0.0    
  11300     45986.92   10.9588     6.8166    11.0328     6.8172     2.917      0.5106   25333.5363 4020.2535  268647.21   53677.86  -692542.0  -692453.373   88.927      0.0    
