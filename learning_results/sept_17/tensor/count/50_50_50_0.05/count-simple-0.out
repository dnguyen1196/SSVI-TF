Generating synthetic count valued data ... 
Generating synthetic  count valued data took:  16.857232093811035
max_count =  52  min count =  0
Evaluation for true params: 
 test_rsme | train_rsme | rel-te-err | rel-tr-err |  test_nll  |  train_nll |
2.6464995749 2.6289161265   1.51876      1.50536     163417.29    651123.47  
Using  0.05 of training data
Factorizing with max_iteration = 16000  fixing covariance?:  False
Tensor dimensions:  [50, 50, 50]
Optimization metrics: 
Using Ada Grad
Mean update scheme:  S
Covariance update :  N
Using diagonal covariance?:  False
Random start? True
k1 samples =  64  k2 samples =  128
eta =  1.0  cov eta =  1.0  sigma eta =  1
iteration |   time   |test_rsme |rel-te-err|train_rsme|rel-tr-err|   d_mean  |   d_cov  |avg_grad_m|avg_grad_c| test_nll | train_nll |    VLB   |  E-term  |    KL     |   dw   |
    0         1.84      10.42      6.666     10.3752     6.6254     3.1623     1.0744     0.548      0.4465   156834.21   31258.28   -83546.0  -83487.116   58.822     0.0262  
    5        130.68    10.4223     6.6678    10.3713     6.6244     3.1623     1.0744     4.7066     5.1768   157127.35   31100.79   -82739.0  -82687.491   51.459     0.0016  
    10       270.66    10.4223     6.6674     10.351     6.6106     3.1623     1.0744     9.547     10.4486   154769.67   30535.25   -82100.0  -82056.098   44.113     0.0014  
    20       431.76     10.402     6.6589    10.2354     6.5344     3.1623     1.0744    27.3663     26.602   151783.97   29483.15   -78502.0  -78466.077   36.115     0.0009  
    50       655.85     9.8996     6.293      9.1878     5.8006     3.1623     0.9009    154.0244   116.7069  131287.14   23468.09   -50995.0  -50957.583   37.389     0.0003  
   100       975.44     6.5463     3.9462     5.4062     3.3476     3.1047     0.3019    237.4535   221.4247   68532.33   11771.25   -14710.0  -14679.535   30.926     0.0004  
   200      1393.59     5.4089     3.1793     3.6333     2.2252     2.5332     0.1931    35.9583    90.0687    57525.77   9093.28    -11043.0  -11016.975   26.315      0.0    
   300      1815.84     4.8485     2.8555     3.0354     1.8414     1.6886     0.1401    21.9114    90.2956    52614.15   8215.32    -9514.0   -9490.016    24.425      0.0    
   400      2237.96     4.6207     2.7472     2.8556     1.7408     1.2327     0.1126    17.0011    94.5394    51292.41   8004.16    -9204.0   -9181.247    23.147      0.0    
   500       2661.5     4.5083     2.6948     2.7276     1.6532     1.2311     0.0976    15.5055    96.0332    50740.8    7872.94    -9020.0   -8997.666    22.326      0.0    
   600      3085.45     4.4399     2.6582     2.6591     1.6012     1.127      0.0871    14.4936    97.1609    50325.45   7791.19    -8884.0   -8862.156    21.802      0.0    
   700      3510.25     4.3809     2.6321     2.6145     1.5718     1.1807     0.0797     13.61     98.4015    49995.69   7712.53    -8772.0   -8750.593    21.422      0.0    
   800      3935.08     4.3396     2.6143     2.5777     1.5566     0.9636     0.075     12.9425    100.0796   49876.79   7681.58    -8718.0   -8696.659    21.281      0.0    
   900      4356.38     4.3209     2.6041     2.5514     1.5322     0.8636     0.0701    12.7745    101.1222   49745.51   7647.31    -8689.0   -8667.507    21.11       0.0    
   1000     4778.58     4.3022     2.5972     2.5316     1.5238     0.888      0.0668     12.795    102.0314   49680.46   7629.69    -8658.0   -8636.861    20.974      0.0    
   1100     5201.65     4.2919     2.5914     2.5181     1.5018     0.8619     0.064     12.8554    103.0764   49604.95   7610.65    -8636.0    -8614.58    20.936      0.0    
   1200     5625.72     4.2776     2.5828     2.523      1.511      0.7621     0.0624     13.025    104.2426   49675.13    7608.4    -8613.0   -8592.482     20.9       0.0    
   1300     6048.27     4.2649     2.5818     2.5066     1.4996     0.7189     0.0603    13.4027    105.449    49651.97   7594.91    -8614.0   -8592.972    20.769      0.0    
   1400     6470.02     4.2703     2.5842     2.5215     1.5054     0.8233     0.0592    13.6935    106.4977   49651.25   7602.29    -8616.0   -8595.306    20.773      0.0    
   1500     6892.79     4.2524     2.571      2.5192     1.5026     0.7844     0.0573    13.5388    107.2197   49610.61    7588.4    -8575.0   -8554.349    20.754      0.0    
   1600     7314.45     4.2517     2.5714     2.5176     1.5004     0.8963     0.0566    13.5818    108.0584   49622.21   7581.94    -8594.0   -8573.324    20.792      0.0    
   1700     7736.01     4.2514     2.5751     2.5107     1.4956     0.8677     0.0564    13.7727    108.9867   49572.28   7566.72    -8585.0    -8564.54    20.75       0.0    
   1800     8158.11     4.2409     2.5692     2.4934     1.489      0.7862     0.0552    13.7739    109.6542   49605.25   7566.65    -8579.0   -8557.722    20.786      0.0    
   1900     8580.61     4.2374     2.5682     2.5061     1.4932     0.7342     0.055     13.8479    110.6225   49541.09   7563.81    -8583.0   -8562.767    20.69       0.0    
   2000     9002.71     4.239      2.5694     2.5017     1.4944     0.7623     0.0544    14.0282    111.5269   49611.78   7565.14    -8568.0   -8547.159    20.804      0.0    
   2100     9424.74     4.2434     2.5784     2.5106      1.5       0.7185     0.0545    13.9947    112.6216   49630.66   7567.32    -8577.0   -8555.929    20.79       0.0    
   2200     9845.96     4.2498     2.5827     2.5095     1.5074     0.7196     0.0539    14.5687    114.097    49647.5    7580.22    -8606.0   -8584.814    20.868      0.0    
   2300     10267.79    4.2495     2.589      2.547      1.528      0.7093     0.0535    15.3429    115.1795   49697.75   7587.92    -8618.0   -8597.393    20.874      0.0    
   2400     10689.7     4.2574     2.5942     2.5273     1.5142     0.7586     0.0535    16.1235    116.3087   49839.69   7588.68    -8630.0   -8609.306    20.949      0.0    
   2500     11112.03    4.2665     2.602      2.5641     1.5382     0.7475     0.0532     17.117    117.3957   49911.95   7606.13    -8685.0   -8663.939    21.181      0.0    
   2600     11534.07    4.2866     2.6129     2.6012     1.5656     0.7447     0.0536    17.6749    119.0844   50002.21   7626.59    -8699.0   -8678.152    21.209      0.0    
   2700     11955.42    4.3184     2.6388     2.6301     1.5818     0.8241     0.0532    19.1547    121.2855   50246.23   7666.37    -8767.0   -8745.109    21.404      0.0    
   2800     12376.82    4.3543     2.6588     2.6746     1.608      0.7662     0.0536    20.8167    122.9853   50437.8     7687.9    -8822.0   -8800.854    21.527      0.0    
   2900     12798.31    4.4005     2.6932     2.7473     1.6554     0.8935     0.0536    22.6842    125.8533   50766.37   7748.16    -8911.0    -8889.78    21.661      0.0    
   3000     13219.83    4.4506     2.7212     2.832      1.7098     1.0418     0.0542    24.8981    129.5188   51063.73   7804.11    -9057.0   -9035.177    22.066      0.0    
   3100     13641.41    4.5107     2.7635     2.9115     1.7652     0.8842     0.0541    27.6291    133.628    51437.13   7887.49    -9173.0   -9150.429    22.33       0.0    
   3200     14062.92    4.6437     2.8487     3.0846     1.8778     0.9598     0.0544     32.355    139.882    52242.17   8025.76    -9423.0   -9400.176    22.866      0.0    
   3300     14483.83    4.8481     2.9778     3.3372     2.0406     1.014      0.055     38.9475    149.6813   53434.99   8247.94    -9794.0   -9770.789    23.474      0.0    
   3400     14905.96    5.2126     3.2042     3.8067     2.3244     1.107      0.0555    49.6177    167.0539   55604.09   8671.29    -10506.0  -10481.652   24.525      0.0    
   3500     15327.57    6.0047     3.6864     4.7223     2.862      1.2922     0.0573    69.1528    201.276    60021.73   9498.25    -11903.0  -11876.464   26.254      0.0    
   3600     15750.14    8.0953     4.9204     6.9618     4.1808     1.5135     0.0673    115.6254   287.6234   71738.43   11761.12   -15493.0  -15463.679   28.865      0.0    
   3700     16171.92   12.6435     7.5694    11.4955     6.8364     1.8907     0.093     217.6016   488.4081   97995.08   16921.56   -23178.0   -23145.6    32.459      0.0    
   3800     16595.19   18.8959    11.4031    17.5173    10.5592     2.0667     0.1091    368.6817   822.6176  133559.38   24336.48   -35901.0  -35864.499   36.474      0.0    
   3900     17019.0    30.1164     18.29     27.9668    17.0544     2.1593     0.096     581.0529  1294.5026  172259.76   32288.27   -59611.0  -59570.691   40.267      0.0    
   4000     17440.88   42.0407     25.687    39.0072    23.8412     2.1551     0.0883    680.9352  1636.1053  196481.98   37001.94   -88218.0  -88174.158   43.773      0.0    
   4100     17859.94   59.8334    35.5051    54.9683    32.4758     2.2463     0.0778    736.8403  2051.6246   214820.2   40600.48  -128964.0  -128916.792   47.069      0.0    
   4200     18277.57    72.821    41.2523    66.6055    37.1052     2.3084     0.077     744.8011  2539.6822  221523.73   41522.55  -168590.0  -168539.778   49.984      0.0    
   4300     18696.95   75.4266    38.5185    68.3407    34.0032     2.3073     0.0806    811.5956  2984.0492  216891.67   41705.01  -210643.0  -210590.871   52.578      0.0    
   4400     19113.44   63.9047    27.5404    57.2766    24.4008     2.2258     0.0694    894.9226   3355.926  220350.25   43541.74  -290364.0  -290309.332   54.822      0.0    
   4500     19528.57   46.9689    18.3529     40.973    16.1352     2.1573     0.0637    931.4208  3513.0744  240917.63   47355.02  -400601.0  -400544.583   56.87       0.0    
   4600     19944.82   27.6244    10.8554    24.0828     9.6388     2.0176     0.0533    964.1636  3409.0631  243555.81   48241.03  -476076.0  -476017.411   58.661      0.0    
   4700     20358.96   17.4085     7.8732    16.2917      7.51      1.9232     0.0517    920.9294  3383.6041  250562.47   49829.98  -570349.0  -570288.472   60.067      0.0    
   4800     20772.72   13.4662     7.1165    13.1723     6.9564     1.7511     0.0497    925.3551  3233.3911   259336.4   51500.23  -623038.0  -622976.303   61.338      0.0    
   4900     21183.81   11.8231     6.8902    11.6569     6.7998     1.7893     0.0551   1025.6014  3092.9018  263898.68   52531.58  -661464.0  -661401.608   62.502      0.0    
   5000     21591.51   11.3073     6.8556     11.253     6.785      1.8108     0.0541   1152.4391  3008.9787  265844.96   53047.01  -676526.0  -676461.903   63.654      0.0    
   5100     21996.23   11.0448     6.826     11.0757     6.7898     1.8166     0.0591   1313.6053  2834.2232   266503.1   53310.98  -684982.0  -684917.506   64.793      0.0    
   5200     22400.68   11.0031     6.8222    10.9553     6.7822     1.8343     0.072    1514.7734  2694.7391  266962.35   53449.52  -688257.0  -688191.393   65.888      0.0    
   5300     22803.9    11.0099     6.8258    10.9641     6.787      1.8801     0.0749   1747.0232  2687.6946  267088.66   53493.66  -689253.0  -689185.932   66.961      0.0    
   5400     23206.26   11.0099     6.8258    10.9646     6.7872     1.877      0.0778   2014.0912  2627.9259  267099.87   53493.66  -689254.0  -689185.932   67.985      0.0    
   5500     23612.44   11.0099     6.8258    10.9646     6.7872     1.8899     0.0928   2320.6114  2613.9423  267099.87   53493.66  -689255.0  -689185.932   68.981      0.0    
   5600     24018.51   11.0099     6.8258    10.9646     6.7872     1.8893     0.0797   2678.1384  2533.9024  267099.87   53493.66  -689256.0  -689185.932   69.94       0.0    
   5700     24423.33   11.0099     6.8258    10.9646     6.7872     1.8752     0.0889   3063.9236   2608.346  267099.87   53493.66  -689257.0  -689185.932   70.861      0.0    
   5800     24829.19   11.0099     6.8258    10.9646     6.7872     1.8504     0.1221   3434.5449   2572.42   267099.87   53493.66  -689258.0  -689185.932   71.722      0.0    
   5900     25233.88   11.0099     6.8258    10.9646     6.7872     1.838      0.1198   3843.2385  2408.0371  267099.87   53493.66  -689258.0  -689185.932   72.553      0.0    
   6000     25639.29   11.0099     6.8258    10.9646     6.7872     1.8082     0.1219   4282.9887  2571.0074  267099.87   53493.66  -689259.0  -689185.932   73.335      0.0    
   6100     26044.59   11.0099     6.8258    10.9646     6.7872     1.7363     0.1072   4694.1307   2524.352  267099.87   53493.66  -689260.0  -689185.932   74.067      0.0    
   6200     26449.5    11.0099     6.8258    10.9646     6.7872     1.6961     0.1082   5085.2481  2565.4551  267099.87   53493.66  -689261.0  -689185.932   74.767      0.0    
   6300     26854.81   11.0099     6.8258    10.9646     6.7872     1.5683     0.1353   5469.9582  2492.2059  267099.87   53493.66  -689261.0  -689185.932   75.463      0.0    
   6400     27260.3    11.0099     6.8258    10.9646     6.7872     1.5167     0.1478   5825.5108  2451.7041  267099.87   53493.66  -689262.0  -689185.932   76.097      0.0    
   6500     27665.12   11.0099     6.8258    10.9646     6.7872     1.4586     0.1322   6137.6405  2630.7291  267099.87   53493.66  -689263.0  -689185.932   76.687      0.0    
   6600     28069.5    11.0099     6.8258    10.9646     6.7872     1.4883     0.1497   6452.9088  2578.1083  267099.87   53493.66  -689263.0  -689185.932   77.252      0.0    
   6700     28474.98   11.0099     6.8258    10.9646     6.7872     1.4909     0.1272   6754.6297  2693.9943  267099.87   53493.66  -689264.0  -689185.932   77.736      0.0    
   6800     28878.28   11.0099     6.8258    10.9646     6.7872     1.3797      0.13    7091.7066  2615.8446  267099.87   53493.66  -689264.0  -689185.932   78.174      0.0    
   6900     29279.44   11.0099     6.8258    10.9646     6.7872     1.3591     0.1077   7396.5064  2753.9927  267099.87   53493.66  -689265.0  -689185.932   78.589      0.0    
   7000     29683.14   11.0099     6.8258    10.9646     6.7872     1.3522     0.1099    7725.974  2617.4985  267099.87   53493.66  -689265.0  -689185.932   78.994      0.0    
   7100     30086.61   11.0099     6.8258    10.9646     6.7872     1.7352     0.1383   8068.8573   2685.701  267099.87   53493.66  -689265.0  -689185.932   79.345      0.0    
   7200     30490.19   11.0099     6.8258    10.9646     6.7872     1.2789     0.1114   8402.0246  2481.1875  267099.87   53493.66  -689266.0  -689185.932   79.704      0.0    
   7300     30895.19   11.0099     6.8258    10.9646     6.7872     1.6074     0.1211   8780.2651  2820.1731  267099.87   53493.66  -689266.0  -689185.932   80.04       0.0    
   7400     31299.05   11.0099     6.8258    10.9646     6.7872     1.3037     0.1197   9212.1249  3132.1855  267099.87   53493.66  -689266.0  -689185.932   80.362      0.0    
   7500     31700.57   11.0099     6.8258    10.9646     6.7872     1.9884     0.1229   9639.1137  2723.0144  267099.87   53493.66  -689267.0  -689185.932   80.779      0.0    
   7600     32102.84   11.0099     6.8258    10.9646     6.7872     2.2144     0.2246   10018.4449 2667.2845  267099.87   53493.66  -689267.0  -689185.932   81.023      0.0    
   7700     32505.08   11.0099     6.8258    10.9646     6.7872     2.3144     0.1272    10457.03   2670.623  267099.87   53493.66  -689267.0  -689185.932   81.256      0.0    
   7800     32906.87   11.0099     6.8258    10.9646     6.7872     2.9723     0.1622   11123.6546 2596.9831  267099.87   53493.66  -689268.0  -689185.932   81.589      0.0    
   7900     33308.75   11.0099     6.8258    10.9646     6.7872     2.0259     0.1327    11348.52  2861.5155  267099.87   53493.66  -689268.0  -689185.932   81.967      0.0    
   8000     33707.69   11.0099     6.8258    10.9646     6.7872     1.8753     0.1244   11820.933  2791.8619  267099.87   53493.66  -689268.0  -689185.932   82.23       0.0    
   8100     34106.47   11.0099     6.8258    10.9646     6.7872     2.6423     0.1131   12311.8247 2765.7379  267099.87   53493.66  -689269.0  -689185.932   82.579      0.0    
   8200     34504.05   11.0099     6.8258    10.9646     6.7872     2.8003     0.1816   12888.1986 2985.7637  267099.87   53493.66  -689269.0  -689185.932   82.889      0.0    
   8300     34901.69   11.0099     6.8258    10.9646     6.7872     2.7823     0.1147   13333.6585 2942.8674  267099.87   53493.66  -689269.0  -689185.932   83.163      0.0    
   8400     35299.01   11.0099     6.8258    10.9646     6.7872     3.0173     0.1704   14147.8655 3400.5748  267099.87   53493.66  -689269.0  -689185.932   83.516      0.0    
   8500     35696.15   11.0099     6.8258    10.9646     6.7872     1.5234     0.1473   14277.3178 3118.6174  267099.87   53493.66  -689270.0  -689185.932   83.804      0.0    
   8600     36093.0    11.0099     6.8258    10.9646     6.7872     2.5611     0.1165   15019.6812 2849.5576  267099.87   53493.66  -689270.0  -689185.932   84.043      0.0    
   8700     36489.98   11.0099     6.8258    10.9646     6.7872     2.6328     0.1525   15353.8394 3088.0798  267099.87   53493.66  -689270.0  -689185.932   84.298      0.0    
   8800     36885.86   11.0099     6.8258    10.9646     6.7872     2.7036     0.1903   16044.7977 3015.3239  267099.87   53493.66  -689270.0  -689185.932   84.314      0.0    
   8900     37281.94   11.0099     6.8258    10.9646     6.7872     2.8804     0.0881   16383.6242  2974.256  267099.87   53493.66  -689271.0  -689185.932   84.586      0.0    
   9000     37677.41   11.0099     6.8258    10.9646     6.7872     2.1741     0.1694   17068.4147 3576.8669  267099.87   53493.66  -689271.0  -689185.932   84.918      0.0    
   9100     38073.05   11.0099     6.8258    10.9646     6.7872     2.3099     0.1331   17412.8028 3313.9496  267099.87   53493.66  -689271.0  -689185.932   85.06       0.0    
   9200     38469.38   11.0099     6.8258    10.9646     6.7872     2.944      0.0958   18691.5422 2750.1507  267099.87   53493.66  -689271.0  -689185.932   85.26       0.0    
   9300     38863.94   11.0099     6.8258    10.9646     6.7872     3.1314     0.1812   19545.2179 3416.9218  267099.87   53493.66  -689271.0  -689185.932   85.475      0.0    
   9400     39259.49   11.0099     6.8258    10.9646     6.7872     3.0527     0.0775   19502.3652 3058.8803  267099.87   53493.66  -689272.0  -689185.932   85.662      0.0    
   9500     39655.35   11.0099     6.8258    10.9646     6.7872     2.0602     0.1087   20024.5492 3373.4579  267099.87   53493.66  -689272.0  -689185.932   85.79       0.0    
   9600     40049.38   11.0099     6.8258    10.9646     6.7872     3.0709     0.2938   21968.6327 3440.0532  267099.87   53493.66  -689272.0  -689185.932   86.023      0.0    
   9700     40445.02   11.0099     6.8258    10.9646     6.7872     2.9617     0.177    21942.2275 3166.2403  267099.87   53493.66  -689272.0  -689185.932   86.223      0.0    
   9800     40839.42   11.0099     6.8258    10.9646     6.7872     2.7221     0.1885   23044.4364 3611.7048  267099.87   53493.66  -689272.0  -689185.932   86.376      0.0    
   9900     41233.56   11.0099     6.8258    10.9646     6.7872     1.8636     0.1366   22812.3501 3837.0722  267099.87   53493.66  -689272.0  -689185.932   86.526      0.0    
  10000     41627.3    11.0099     6.8258    10.9646     6.7872     1.6999     0.3571   23066.4283 3624.2273  267099.87   53493.66  -689273.0  -689185.932   86.708      0.0    
  10100     42021.8    11.0099     6.8258    10.9646     6.7872     2.9644     0.117    24085.3973 3553.4366  267099.87   53493.66  -689273.0  -689185.932   86.869      0.0    
  10200     42416.68   11.0099     6.8258    10.9646     6.7872     2.2683     0.3886   25434.801  4312.1128  267099.87   53493.66  -689273.0  -689185.932   86.993      0.0    
  10300     42810.32   11.0099     6.8258    10.9646     6.7872     2.0288     0.4604   25720.7602 3400.2695  267099.87   53493.66  -689273.0  -689185.932   87.225      0.0    
  10400     43203.58   11.0099     6.8258    10.9646     6.7872     2.6781     0.1121   26724.7091 4990.9931  267099.87   53493.66  -689273.0  -689185.932   87.433      0.0    
  10500     43595.84   11.0099     6.8258    10.9646     6.7872     2.9325     0.1047   27357.2693 4331.9378  267099.87   53493.66  -689274.0  -689185.932   87.576      0.0    
  10600     43989.77   11.0099     6.8258    10.9646     6.7872     1.8436     0.2834   27600.4028 3459.7482  267099.87   53493.66  -689274.0  -689185.932   87.69       0.0    
  10700     44382.39   11.0099     6.8258    10.9646     6.7872     1.889      0.1783   28162.6181  4133.872  267099.87   53493.66  -689274.0  -689185.932    87.9       0.0    
  10800     44775.68   11.0099     6.8258    10.9646     6.7872     2.9956      0.31    30932.4357 3462.0649  267099.87   53493.66  -689274.0  -689185.932   88.148      0.0    
  10900     45168.4    11.0099     6.8258    10.9646     6.7872     2.7633     0.1373   33653.834  3416.5326  267099.87   53493.66  -689274.0  -689185.932   88.264      0.0    
  11000     45561.4    11.0099     6.8258    10.9646     6.7872     2.9635     0.2065   32383.2107 4094.5245  267099.87   53493.66  -689274.0  -689185.932   88.39       0.0    
  11100     45955.68   11.0099     6.8258    10.9646     6.7872     2.5125     0.1471   33565.3801 3719.3887  267099.87   53493.66  -689275.0  -689185.932   88.603      0.0    
