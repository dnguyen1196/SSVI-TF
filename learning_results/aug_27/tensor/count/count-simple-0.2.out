Generating synthetic count valued data ... 
Generating synthetic  count valued data took:  17.02745032310486
max_count =  39.0  min count =  0.0
Evaluation for true params: 
 test_rsme | train_rsme | rel-te-err | rel-tr-err |  test_nll  |  train_nll |
0.3122819239 0.3088850919   0.09752      0.09541     163511.02    651763.96  
Factorizing with max_iteration = 16000  fixing covariance?:  False
Tensor dimensions:  [50, 50, 50]
Optimization metrics: 
Using Ada Grad
Mean update scheme:  S
Covariance update :  N
Using diagonal covariance?:  False
Random start? True
k1 samples =  64  k2 samples =  64
eta =  1.0  cov eta =  1.0  sigma eta =  1
iteration |   time   |test_rsme |rel-te-err|train_rsme|rel-tr-err|  d_mean  |   d_cov  | test_nll | train_nll |    VLB   |  E-term  |    KL     |   dw   |
    0         1.68      8.7641     6.7171     8.7869     6.7074     3.1623     4.4274    70291.6   281539.87  -1230949.0 -1230936.347   12.647     0.0345  
    5        578.55     8.8718     6.6871     8.8846     6.6689     3.1623     4.4274    73768.71  294096.63  -1219229.0 -1219216.625   12.875     0.0001  
    10      1166.77      8.95      6.6817     8.9641     6.6655     3.1623     4.4274    77026.91  306017.41  -1206227.0 -1206213.628   13.054     0.0003  
    20      1771.17     9.1716     6.6461     9.1421     6.5983     3.1623     4.4274    89387.2   354410.15  -1180814.0 -1180800.507   13.624     0.0002  
    50      2433.82     9.3903     6.2621     9.3116     6.1805     3.1623     4.4274   161510.45  637614.56  -1027310.0 -1027251.934   57.745     0.0063  
   100      3193.79     7.4184     4.4091     7.3664     4.3658     3.1476     0.0956   101965.98  404109.09  -537456.0  -537399.696   56.804     0.0002  
   200      4006.14     4.5313     2.6903     4.4941     2.6577     2.1428     0.061     56470.24  223390.96  -253636.0  -253585.902   49.73      0.0001  
   300      4990.82     3.7586     2.2346     3.7217     2.2148     1.7856     0.0552    49926.4   197631.53  -223738.0  -223691.273   47.216     0.0001  
   400      6042.01     3.3045     1.9886     3.2602     1.9667     1.3282      0.05     45603.96  180363.57  -208739.0  -208692.175   46.482     0.0001  
   500      7117.67     3.0213     1.8414     2.9761     1.8136     1.3358     0.0452    43800.73   173543.7  -201306.0  -201260.69   45.173      0.0    
   600      8195.84     2.8978     1.7886     2.8512     1.7618     1.2173     0.0402    43110.86  170610.72  -200100.0  -200055.823   43.941      0.0    
   700      9278.67     2.7759     1.7139     2.7364     1.6925     1.3743     0.0363    42275.2   167888.49  -196815.0  -196771.861   43.219      0.0    
   800      10378.58    2.6748     1.6495     2.6353     1.6252     0.7272     0.0327    41488.47  164330.22  -193741.0  -193699.462   41.956      0.0    
   900      11501.65    2.6142     1.6201     2.5726     1.5959     0.9498     0.031     41241.09  163539.63  -192710.0  -192668.872   41.378      0.0    
   1000     12624.7     2.6122     1.6174     2.5663     1.5935     1.0753     0.028     40974.08  162444.08  -191706.0  -191664.621   41.058      0.0    
   1100     13745.11    2.4985     1.5326     2.451      1.5077     0.7783     0.0265    40081.31  158757.88  -187608.0  -187567.492   40.526      0.0    
   1200     14863.1     2.4572     1.5059     2.4077     1.4786     0.8289     0.0241    39792.84   157632.8  -186429.0  -186388.292   40.592      0.0    
   1300     15977.51    2.4428     1.5076     2.3889     1.4759     0.6809     0.0231    39853.24  157716.88  -186698.0  -186658.896   39.549      0.0    
   1400     17090.48    2.4064     1.4824     2.3561     1.4536     0.883      0.0208    39497.8   156405.42  -185668.0  -185628.173   39.62       0.0    
   1500     18202.45    2.3611     1.4479     2.3084     1.4164     0.5762     0.0197    39050.36  154623.13  -183620.0  -183580.194   39.445      0.0    
   1600     19308.9     2.3607     1.4612     2.3077     1.431      0.7489     0.0183    39198.35  155038.84  -184457.0  -184417.931   38.622      0.0    
   1700     20410.5     2.3102     1.4164     2.2582     1.3871     0.7832     0.0181    38719.92  153255.33  -182459.0  -182420.304   38.655      0.0    
   1800     21510.38    2.2862     1.3904      2.23      1.3587     0.7906     0.017     38378.9   151827.26  -180789.0  -180749.278   39.267      0.0    
   1900     22607.51     2.27      1.3818     2.2114     1.3485     0.9684     0.0163    38182.06  151184.07  -180244.0  -180205.075   38.816      0.0    
   2000     23704.39    2.2043     1.3355     2.151      1.3056     0.7007     0.0168    37823.83  149697.82  -178806.0  -178767.077   38.549      0.0    
   2100     24799.4     2.1832     1.3206     2.1309     1.2927     0.5874     0.015     37696.23  149224.69  -178269.0  -178230.001   38.751      0.0    
   2200     25886.48    2.1513     1.3042     2.1049     1.2768     0.6066     0.0153    37550.29  148649.33  -177586.0  -177547.481   38.356      0.0    
   2300     26971.74    2.1341     1.2892     2.081      1.2564     1.0472     0.0147    37420.25  148100.22  -177004.0  -176966.324   38.026      0.0    
   2400     28054.86    2.0998     1.2657     2.0503     1.2341     0.465      0.0136    37159.25  147075.42  -176016.0  -175978.014   37.888      0.0    
   2500     29134.03    2.0845     1.2574     2.035      1.2236     0.5038     0.0134    36990.6   146494.36  -175522.0  -175483.589   37.947      0.0    
   2600     30211.88    2.0588     1.234      2.0053     1.1986     0.4655     0.0126    36809.67  145695.91  -174636.0  -174597.535   38.401      0.0    
   2700     31284.06    2.0391     1.2282     1.9823     1.1884     0.614      0.0121    36746.75  145524.85  -174541.0  -174502.271   38.284      0.0    
   2800     32356.62    2.0242     1.2203     1.9686     1.1844     0.5314     0.0128    36670.08  145240.58  -174300.0  -174261.833   38.487      0.0    
   2900     33424.92    2.0077     1.207      1.9521     1.1683     0.6998     0.012     36495.69   144484.5  -173460.0  -173421.233   38.572      0.0    
   3000     34490.34    1.9803     1.1872     1.9243     1.1451     0.4118     0.0118    36318.76  143817.76  -172505.0  -172466.18   38.489      0.0    
   3100     35550.93    1.9681     1.1796     1.9171      1.14      0.7156     0.011     36282.9   143811.49  -172376.0  -172338.027   38.454      0.0    
   3200     36613.0     1.9563     1.1779     1.8959     1.1325     0.7114     0.0114    36250.45  143583.63  -172450.0  -172411.552   38.568      0.0    
   3300     37676.1     1.9521     1.1702     1.8901     1.1246     0.577      0.0115    36161.7   143072.31  -171741.0  -171702.774   38.623      0.0    
   3400     38730.05    1.9406     1.1592     1.8809     1.1179     0.4171     0.0106    36107.15  142842.44  -171453.0  -171413.952   39.043      0.0    
   3500     39787.21    1.9314     1.1627     1.8718     1.1188     0.5242     0.0105    36100.97  142928.32  -171765.0  -171725.912   39.568      0.0    
   3600     40840.3     1.888      1.1328     1.8419     1.0937     0.5482     0.0109    35937.19  142170.32  -170854.0  -170814.277   39.44       0.0    
   3700     41887.33    1.8839     1.1268     1.8249     1.0838     0.4139     0.0105    35838.17  141807.79  -170381.0  -170341.851   39.476      0.0    
   3800     42937.23    1.8671     1.1156     1.8103     1.0714     0.4047     0.0108    35767.47  141504.19  -170110.0  -170070.512   39.311      0.0    
   3900     43983.8     1.8602     1.1119     1.7999     1.0667     0.4664     0.0098    35693.32  141240.76  -169898.0  -169859.027   39.433      0.0    
   4000     45037.63    1.8493     1.1096     1.7933     1.0641     0.5254     0.0103    35678.72  141162.27  -169929.0  -169889.974   39.128      0.0    
   4100     46085.67    1.8277     1.0962     1.7679     1.052      1.1127     0.0092    35635.37  141000.88  -169847.0  -169807.942   39.049      0.0    
   4200     47125.68    1.822      1.0941     1.7689     1.0519     0.5031     0.0092    35608.08  140897.26  -169742.0  -169702.455   39.427      0.0    
   4300     48165.33    1.8097     1.0795     1.7539     1.034      0.9878     0.0094    35479.63   140299.8  -168917.0  -168877.102   39.79       0.0    
   4400     49201.37    1.8085     1.079      1.7521     1.0326     0.9253     0.0089    35481.26  140414.86  -168961.0  -168921.48   39.924      0.0    
   4500     50234.77    1.7864     1.0686     1.7336     1.0232     0.6346     0.0092    35340.38  139893.44  -168514.0  -168473.865   40.064      0.0    
   4600     51262.78    1.7799     1.0624     1.7233     1.0194     0.5277     0.0087    35334.59  139841.53  -168569.0  -168529.425   39.877      0.0    
   4700     52286.17    1.7748     1.0604     1.7191     1.0155     0.7593     0.0086    35332.01  139773.63  -168486.0  -168445.93   39.935      0.0    
   4800     53310.83    1.7618     1.0512     1.7079     1.0086     0.4383     0.009     35282.14  139540.95  -168130.0  -168089.802   40.029      0.0    
   4900     54308.58    1.748      1.0357     1.6989     0.9996     0.4949     0.009     35162.49  139286.77  -167784.0  -167743.094   40.453      0.0    
   5000     55302.81    1.7415     1.0325     1.6871     0.9929     0.466      0.0085    35142.76  139074.67  -167588.0  -167547.076   40.481      0.0    
   5100     56295.1     1.7391     1.0297     1.6825     0.9907     0.4631     0.0085    35104.08  138939.75  -167451.0  -167410.602   40.299      0.0    
   5200     57286.67    1.7157     1.0186     1.6696     0.9849     0.4637     0.0087    35066.95  138883.09  -167475.0  -167434.91   40.399      0.0    
   5300     58280.14    1.716      1.0215     1.6657     0.9853     0.5968     0.0081    35090.18  138961.75  -167571.0  -167531.388   40.107      0.0    
   5400     59266.08    1.7056     1.0138     1.6569     0.9755     0.5118     0.0081    35033.77  138755.45  -167325.0  -167284.4    40.302      0.0    
   5500     60252.41    1.7123     1.025      1.6603     0.9869     0.4921     0.0085    35116.41   139037.6  -167710.0  -167669.455   40.27       0.0    
   5600     61235.47    1.7059     1.0198     1.654       0.98      0.8251     0.0078    35059.28  138823.84  -167361.0  -167321.03   40.165      0.0    
   5700     62215.58    1.6909     1.0047     1.6321     0.9613     0.418      0.0077    34920.38  138263.85  -166808.0  -166767.71   40.599      0.0    
   5800     63203.58    1.6767     0.9942     1.6368     0.9636     0.6065     0.0077    34891.17  138278.05  -166835.0  -166794.885   40.311      0.0    
   5900     64208.35    1.6538     0.9759     1.6154     0.9457     0.479      0.0076    34779.65  137885.16  -166190.0  -166149.759   40.482      0.0    
   6000     65212.34    1.649      0.9719     1.6087     0.9385     0.4245     0.0079    34725.7   137693.23  -165970.0  -165929.796   40.537      0.0    
   6100     66215.74    1.6481     0.9742     1.5996     0.9363     0.5032     0.0076    34720.59  137579.78  -165954.0  -165913.197   40.723      0.0    
   6200     67218.26    1.6351     0.9652     1.5904     0.9318     0.576      0.0078    34704.78  137563.19  -165944.0  -165903.663   40.501      0.0    
   6300     68222.27    1.6406     0.9712     1.5953     0.9366     0.6585     0.0072    34733.97  137662.78  -166100.0  -166059.485   40.341      0.0    
   6400     69223.34    1.6258     0.9592     1.5859     0.9264     0.5303     0.0077    34663.02  137377.92  -165649.0  -165608.812   40.286      0.0    
   6500     70222.31    1.6198     0.9518     1.5741     0.9157     0.3849     0.0074    34608.32   137157.8  -165468.0  -165427.168   40.509      0.0    
   6600     71221.12    1.6105     0.9498     1.5708     0.918      0.3928     0.0071    34595.77  137110.69  -165536.0  -165495.591   40.854      0.0    
   6700     72220.14    1.6164     0.9526     1.568      0.9171     0.4213     0.0069    34620.98   137162.5  -165663.0  -165622.93   40.557      0.0    
   6800     73220.59    1.6103     0.9472     1.5679     0.9159     0.5463     0.0072    34604.84  137165.62  -165648.0  -165607.026   40.716      0.0    
   6900     74223.12    1.6064     0.9442     1.5619     0.9113     0.546      0.0071    34567.02  136988.45  -165560.0  -165519.646   40.707      0.0    
   7000     75221.12    1.5995     0.937      1.5568     0.9036     0.5708     0.0068    34519.24  136888.19  -165215.0  -165174.744   40.648      0.0    
   7100     76221.59    1.5942     0.9302     1.5567     0.9009     0.4392     0.0064    34475.86  136713.11  -164867.0  -164826.534   40.752      0.0    
   7200     77215.61    1.5844     0.9259     1.5508     0.8988     0.5889     0.0064    34466.07  136690.32  -164901.0  -164860.011   40.684      0.0    
   7300     78208.88    1.5931     0.9342     1.5548     0.9038     0.3467     0.0071    34468.56  136721.16  -165101.0  -165060.376   40.623      0.0    
   7400     79200.93    1.5874     0.9274     1.5477     0.8996     0.4716     0.0067    34468.89  136632.99  -164979.0  -164938.415   40.762      0.0    
   7500     80192.98    1.574      0.922      1.5343     0.8929     0.346      0.0069    34446.72  136606.66  -165065.0  -165023.705   40.918      0.0    
   7600     81185.29     1.58      0.9246     1.5378     0.8949     0.4286     0.0068    34431.22   136492.0  -164884.0  -164842.679   40.993      0.0    
   7700     82180.54    1.5783     0.9245     1.5405     0.8969     0.497      0.0068    34448.38  136615.85  -164955.0  -164913.527   40.983      0.0    
   7800     83173.86    1.5737     0.9185     1.5315     0.8882     0.444      0.0063    34414.09  136389.45  -164689.0  -164647.869   41.076      0.0    
   7900     84162.42    1.5693     0.9161     1.5291     0.8872     0.4434     0.0063    34407.3   136398.76  -164707.0  -164666.473   40.808      0.0    
   8000     85157.03    1.5634     0.9147     1.5249     0.8874     0.4976     0.0063    34413.85  136491.17  -165004.0  -164963.003   40.911      0.0    
   8100     86149.2     1.5632     0.9121     1.5203     0.8832     0.5455     0.0065    34400.14  136283.06  -164591.0  -164550.357   40.909      0.0    
   8200     87141.92    1.5609     0.9143     1.5275     0.8908     0.5648     0.0064    34404.59   136501.2  -164788.0  -164746.95   40.886      0.0    
   8300     88134.21    1.5613     0.9147     1.5262     0.8904     0.6738     0.0066    34420.39  136463.82  -164672.0  -164631.305   40.811      0.0    
   8400     89125.82    1.553      0.9072     1.5173     0.8812     0.459      0.0064    34333.07  136239.08  -164618.0  -164577.747   40.616      0.0    
   8500     90116.42    1.551      0.9028     1.5151     0.8784     0.4489     0.006     34327.3   136197.83  -164632.0  -164591.108   40.89       0.0    
   8600     91099.81    1.5405     0.8935     1.506      0.8687     0.4425     0.0061    34266.32  135988.73  -164241.0  -164199.998   40.731      0.0    
   8700     92086.8     1.5418     0.9041      1.51      0.8779      0.42      0.0061    34317.67  136203.51  -164656.0  -164615.129   40.799      0.0    
   8800     93075.26    1.5403     0.8962     1.5003     0.8663     0.4012     0.0063    34266.81  135951.25  -164163.0  -164122.556   40.876      0.0    
   8900     94067.3     1.5306     0.8903     1.4939     0.8633     0.3113     0.006     34243.57  135832.54  -164127.0  -164085.518   41.278      0.0    
   9000     95051.95    1.5307     0.8938     1.4973     0.866      0.3885     0.0059    34251.13  135886.46  -164123.0  -164081.972   41.414      0.0    
   9100     96010.23    1.537      0.8968     1.5003     0.868      0.6392     0.006     34272.29  135924.14  -164175.0  -164133.647   41.77       0.0    
   9200     96965.61    1.5368     0.8982     1.4991     0.8684     0.635      0.0057    34274.59   135957.2  -164202.0  -164160.922   41.373      0.0    
   9300     97923.3     1.5289     0.8893     1.4887     0.8591     0.7073     0.0061    34275.35  135911.09  -163898.0  -163856.51   41.112      0.0    
   9400     98895.97    1.5321     0.8898     1.4905     0.8589     0.5605     0.0058    34247.01  135758.03  -163854.0  -163813.084   41.205      0.0    
   9500     99879.06    1.5302     0.8945     1.4918     0.8625     0.3631     0.0055    34274.34  135860.61  -164146.0  -164104.965   40.915      0.0    
   9600    100863.74    1.5353     0.8963     1.498      0.8704     0.6119     0.0053    34306.64  135965.88  -164480.0  -164438.396   41.227      0.0    
   9700    101845.66    1.5296     0.8892     1.4931     0.8638     0.5331     0.0055    34216.28  135745.07  -164110.0  -164068.71   41.081      0.0    
   9800    102831.51    1.5226     0.8891     1.4862     0.8593     0.5181     0.0055    34202.65  135677.97  -163966.0  -163925.085   41.345      0.0    
   9900    103813.16    1.528      0.8882     1.493      0.8634     0.6192     0.0057    34205.94  135741.66  -163925.0  -163883.852   41.435      0.0    
  10000    104795.29    1.5207     0.8865     1.4868     0.8598     0.4413     0.0056    34195.09  135717.94  -164030.0  -163988.644   41.693      0.0    
  10100    105779.66    1.5102     0.8773     1.4789     0.8524     0.6138     0.0058    34195.09  135638.72  -163770.0  -163728.504   41.52       0.0    
  10200    106760.96    1.5079     0.8778     1.4754     0.854      0.5163     0.0056    34175.29  135600.35  -163985.0  -163942.834   41.684      0.0    
  10300    107739.35    1.5137     0.8792     1.4743     0.8533     0.4657     0.0059    34182.0   135628.27  -163995.0  -163953.056   41.493      0.0    
  10400     108719.3    1.5157     0.8792     1.4841     0.8603     0.4292     0.0057    34171.28  135668.99  -164077.0  -164035.468   41.709      0.0    
  10500    109695.77    1.5203     0.892      1.4818     0.8658     0.4843     0.0053    34243.85   135857.0  -164547.0  -164505.348   41.471      0.0    
  10600    110674.28    1.5269     0.8972     1.4927     0.8698     0.5458     0.0055    34287.48  136016.95  -164556.0  -164514.309   41.788      0.0    
  10700    111655.23    1.5214     0.8914     1.4817     0.8612     0.7009     0.0055    34289.52  135909.84  -164340.0  -164298.596   41.608      0.0    
  10800    112636.19    1.5111     0.8799     1.4758     0.8551     0.515      0.0053    34196.37   135651.0  -164049.0  -164007.801   41.559      0.0    
  10900    113602.65    1.5254     0.893      1.491      0.8658     0.6096     0.0053    34226.06   135840.0  -164240.0  -164198.16   41.473      0.0    
