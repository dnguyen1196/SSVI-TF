Generating synthetic count valued data ... 
Generating synthetic  count valued data took:  17.444227933883667
max_count =  52  min count =  0
Evaluation for true params: 
 test_rsme | train_rsme | rel-te-err | rel-tr-err |  test_nll  |  train_nll |
2.6464995749 2.6289161265   1.51876      1.50536     163417.29    651123.47  
Using  0.05 of training data
Factorizing with max_iteration = 12000  fixing covariance?:  False
Tensor dimensions:  [50, 50, 50]
Optimization metrics: 
Using Ada Grad
Mean update scheme:  S
Covariance update :  N
Using diagonal covariance?:  True
Random start? True
k1 samples =  32  k2 samples =  128
eta =  1.0  cov eta =  1.0  sigma eta =  1
iteration |   time   |test_rsme |rel-te-err|train_rsme|rel-tr-err|   d_mean  |   d_cov  |avg_grad_m|avg_grad_c| test_nll | train_nll |    VLB   |  E-term  |    KL     
    0         0.77     10.4224     6.6663    10.3777     6.6258     3.1623     0.0061     0.5524     0.5036    194212.0   38695.5    -80419.0  -80359.545   59.381   
    5        77.52     10.4328     6.6699    10.3733     6.6222     3.1623     0.0061     4.9832     5.685    192273.92   38169.16   -79849.0  -79798.677   50.716   
    10       155.09     10.441     6.6745    10.3618     6.6058     3.1623     0.0061     9.8622    11.5276   188809.93   37272.37   -79124.0  -79081.042   43.152   
    20       236.69    10.4347     6.6709    10.2422     6.523      3.1623     0.0061    28.7552    29.9814   181168.89   35078.16   -75818.0  -75782.585   35.389   
    50       333.83     9.8331     6.2708     9.1514     5.782      3.1623     0.0029    161.4866   135.5479  138394.33   24541.47   -50454.0  -50421.91    31.727   
   100       446.97     6.3475     3.836      5.1162     3.159      3.1177     0.0031    235.6603   174.8982   64348.3    10884.35   -15073.0  -15046.107   26.807   
   200       599.08     5.4433     3.2016     3.5579     2.1658     2.6037     0.004     41.2692     63.565    56673.45   8919.82    -11120.0  -11095.949   24.505   
   300       751.45     4.9021     2.8963     2.9448     1.7748     1.8488     0.0039    18.5636    63.7866    52800.36   8157.05    -9874.0   -9849.704    23.944   
   400       903.9      4.7548     2.8367     2.7409     1.6438     1.0829     0.0037    15.1139    64.8193    51944.93   8013.69    -9474.0   -9450.458    23.413   
   500      1056.11     4.6894     2.8156     2.634      1.5762     1.1331     0.0036    13.9491     67.129    51847.76   7897.61    -9332.0   -9309.251    23.123   
   600      1206.36     4.6371     2.7976     2.5608     1.5346     1.0202     0.0037    12.9403    68.9332    51717.26   7818.77    -9145.0   -9121.808    22.741   
   700      1359.58     4.6172     2.7912     2.4682     1.465      0.7336     0.0037    10.5901     70.29     51570.13    7725.6    -9004.0   -8981.883    22.23    
   800      1509.58     4.5855     2.7788     2.4363     1.4474     0.5356     0.0035     9.0824    71.6401    51470.93   7684.96    -8922.0   -8899.852    21.906   
   900      1660.45     4.5831     2.7791     2.3899     1.4278     0.647      0.0034     8.4202    73.1179    51656.32   7646.08    -8891.0   -8869.129    21.429   
   1000     1817.09     4.5923     2.7862     2.3585     1.4014     0.7962     0.0034     8.1312    74.4592    51828.85   7629.27    -8886.0   -8864.268    21.523   
   1100     1976.69     4.5916     2.7911     2.3295     1.386      0.864      0.0033     8.3196    75.4585    51863.68   7610.14    -8860.0   -8838.999    21.233   
   1200     2132.18     4.5928     2.8024     2.3013     1.3782     0.7453     0.0032     8.3902    76.5624    51913.96   7591.01    -8828.0   -8807.111    21.133   
   1300     2287.66     4.623      2.8149     2.2976     1.373      0.7304     0.0031     9.3636    78.3239    52313.43   7583.64    -8856.0   -8834.798    21.408   
   1400     2443.77     4.629      2.8217     2.2802     1.372      0.8627     0.0033     9.2644    79.2733    52235.5     7581.4    -8850.0   -8828.655    21.158   
   1500     2605.39     4.6183     2.8199     2.2348     1.341      0.6801     0.0033     8.8727    79.9218    52383.18   7559.26    -8815.0   -8793.794    21.227   
   1600      2767.4     4.6365     2.8345     2.2076     1.3346     0.5513     0.0031     8.7196    80.7673    52543.18   7553.41    -8791.0   -8770.069    21.318   
   1700     2923.44     4.6544     2.8444     2.2177     1.338      0.5865     0.0031     8.1172    81.7299    52693.68   7550.46    -8783.0   -8762.056    21.384   
   1800     3074.31     4.6635     2.8491     2.1958     1.3202     0.6491     0.003      7.8674    82.9181    52751.21   7542.08    -8795.0   -8773.386    21.403   
   1900     3225.24     4.6659     2.8526     2.1962     1.3226     0.5683     0.003      8.0237    84.4149    52736.95   7536.89    -8803.0   -8781.632    21.451   
   2000     3376.01     4.6617     2.8537     2.147      1.2954     0.4249     0.0032     7.1137    84.5505    52821.01   7522.88    -8774.0   -8752.774    21.636   
   2100     3528.48     4.6803     2.8594     2.1253     1.2826     0.4917     0.003      7.5371    85.5024    53079.41   7512.89    -8806.0   -8784.106    21.448   
   2200     3681.55     4.6898     2.864      2.1358     1.289      0.5107     0.0029     7.5219     85.555    53060.86   7512.01    -8798.0   -8776.329    21.498   
   2300     3838.81     4.7175     2.8876     2.1555     1.3122     0.644      0.0028     7.4631    87.7154    53234.26   7530.43    -8827.0   -8805.543    21.789   
   2400     3993.21     4.6966     2.867      2.1378     1.2856     0.5356     0.0028     8.0154    87.7481    53238.56   7503.62    -8812.0    -8789.9     21.853   
   2500     4143.76     4.7148     2.8813     2.1233     1.2856     0.5969     0.0029     7.8547    88.0511    53257.06   7513.33    -8798.0   -8776.346    21.695   
   2600     4294.35     4.731      2.8898     2.1183     1.2932     0.522      0.0029     7.9718    89.0074    53369.55   7514.11    -8816.0   -8794.146    22.018   
   2700     4448.26     4.7166     2.8832     2.0799     1.2606     0.5026     0.003      7.7288    88.9155    53532.31   7513.45    -8788.0   -8766.019    21.761   
   2800     4601.96     4.7282     2.8902     2.0681     1.2566     0.8233     0.003      7.4897    89.4234    53558.75    7493.6    -8812.0   -8789.709    21.919   
   2900     4755.83     4.746      2.8976     2.0687     1.2528     0.4058     0.0029     7.7385    90.0999    53400.08   7509.79    -8837.0   -8815.298    22.052   
   3000     4915.25     4.7451     2.8987     2.0816     1.2538     0.5722     0.003      8.4627    90.4345    53597.66   7496.64    -8824.0   -8801.905    22.058   
   3100     5075.63     4.7658     2.9066     2.0398     1.2374     0.4432     0.0029     7.8341    90.7778    53642.22   7499.25    -8764.0    -8741.54    22.183   
   3200     5234.56     4.777      2.9154     2.0607     1.2594     0.5164     0.003      8.269     91.8089    53663.05   7508.95    -8784.0   -8761.499    22.302   
   3300     5391.72     4.7756     2.9184     2.0735      1.26      0.631      0.003      8.9355     92.425    53760.39   7509.48    -8855.0   -8832.839    22.265   
   3400     5556.09     4.7574     2.905      2.0202     1.2342     0.5374     0.0029     8.655     92.4703    53534.07   7498.96    -8828.0   -8806.086    22.204   
   3500     5718.53     4.7932     2.9326     2.0561     1.266      0.6269     0.0029     8.6058     92.907    53732.1    7504.27    -8864.0   -8841.344    22.385   
   3600     5881.35     4.7916     2.928      2.0224     1.2488     0.6415     0.0028     8.398     93.8352    53719.91   7508.83    -8874.0   -8851.725    22.345   
   3700     6046.59     4.7947     2.9262     2.0201     1.2454     0.7034     0.0028     9.0763    93.6727    53605.01   7505.66    -8837.0   -8814.567    22.517   
   3800     6208.06     4.7924     2.921      2.0201     1.2336     0.5471     0.0029     9.0857    93.7977    53634.42   7492.43    -8830.0    -8806.99    22.637   
   3900     6363.99     4.7952     2.9224     1.9789     1.2066     0.6881     0.0028     9.1043    93.7514    53698.47   7486.62    -8834.0   -8810.804    22.856   
   4000     6520.97     4.8099     2.9343     1.9977     1.226      0.5198     0.0027     8.1806     93.962    53937.69    7490.6    -8827.0   -8803.954    22.885   
   4100     6677.93     4.8085     2.9318     1.9578     1.1962     0.4663     0.0027     7.767     94.7953    53901.03   7485.13    -8835.0   -8811.802    22.896   
   4200     6834.89     4.8182     2.9369     1.9658     1.2088     0.4442     0.0028     8.1668    94.7588    53757.18   7477.84    -8844.0   -8821.019    22.998   
   4300      6992.7      4.82      2.9406     1.9822     1.2174     0.5868     0.0029     8.3579    95.4361    53893.05   7479.24    -8818.0   -8794.618    23.083   
   4400     7151.97     4.843      2.9572     1.9864     1.2082     0.7883     0.0027     9.1796    95.3378    54150.3    7490.09    -8843.0   -8819.411    23.214   
   4500     7307.68     4.8351     2.9463     1.9798     1.2026     0.7772     0.0028     9.1431    95.9004    53956.35   7487.64    -8863.0   -8840.033    23.171   
   4600      7466.7     4.8447     2.956      1.9564     1.203      0.5797     0.0028     8.9988    95.9465    54052.87   7482.42    -8821.0    -8797.39    23.322   
   4700     7623.86     4.8478     2.9546     1.9467     1.1942     0.4937     0.0028     7.7947    95.7532    53991.65   7466.38    -8832.0   -8809.021    23.302   
   4800      7784.2     4.8479     2.9527     1.9404     1.1864     0.4232     0.0027     8.1539     97.519    54140.85   7482.11    -8865.0    -8841.94    23.214   
   4900     7938.93     4.8608     2.9601     1.9233     1.176      0.3918     0.0027     8.3059    96.7727    54031.45    7471.8    -8804.0   -8780.739    23.35    
   5000     8094.05     4.8612     2.962      1.9357     1.166      0.4385     0.0027     8.6258    96.6684    54051.96   7476.58    -8856.0    -8832.53    23.374   
   5100     8248.66     4.884      2.9773     1.9378     1.1822     0.5427     0.0026     9.0127    97.9765    54028.9    7480.32    -8846.0   -8822.363    23.412   
   5200     8405.61     4.8777     2.9744     1.9492     1.1892     0.7096     0.0026     9.274     98.0708    54028.82   7472.62    -8842.0   -8818.085    23.439   
   5300     8561.86     4.8994     2.9868     1.9333     1.1804     0.6016     0.0026    10.0993    98.4597    54194.51   7489.38    -8905.0   -8881.952    23.525   
   5400     8715.18     4.8722     2.9695     1.9097     1.1578     0.5652     0.0027     9.5736    97.8659    54167.81   7469.26    -8823.0   -8799.893    23.483   
   5500     8868.73     4.8631     2.9613     1.9012     1.1566     0.4643     0.0028     9.3419    97.9991    54013.55   7465.47    -8846.0    -8822.7     23.725   
   5600     9019.25     4.8895     2.9775     1.8977     1.1546     0.6451     0.0026     9.6905    98.0642    54375.75   7467.89    -8850.0   -8826.557    23.775   
   5700     9172.69     4.8919     2.9808     1.9081     1.1644     0.4028     0.0025     8.659     98.8197    54179.98   7467.93    -8875.0   -8851.103    23.858   
   5800     9324.33     4.8878     2.9766     1.8766     1.1504     0.4902     0.0027     8.3664    99.5598    54060.4    7466.09    -8834.0   -8810.538    23.934   
   5900     9475.03     4.8937     2.9788     1.8933     1.1434     0.4862     0.0025     9.3326    99.7153    54307.14   7475.52    -8841.0   -8816.752     23.9    
   6000      9625.6     4.9039     2.991      1.9277     1.177      0.4903     0.0026     9.2468    99.8551    54081.84    7473.7    -8835.0   -8811.204    23.783   
   6100     9778.47     4.8972     2.9874     1.9288     1.1876     0.4853     0.0027     9.0255    100.2315   54066.94   7479.57    -8863.0   -8839.135    23.901   
   6200     9932.06      4.91       2.99      1.9028     1.1682     0.5432     0.0026     8.5229    100.8635   54079.08   7486.97    -8832.0   -8807.816    24.08    
   6300     10088.19    4.8971     2.9806     1.8825     1.1486     0.569      0.0027     9.1721    100.2317   54077.59    7481.0    -8837.0   -8813.143    24.088   
   6400     10245.55    4.9282     2.9992     1.8935     1.1666     0.7103     0.0025     9.8162    100.2438   54251.78   7487.91    -8858.0   -8833.642    24.023   
   6500     10400.88    4.9301     3.0024     1.8824     1.1608     0.6763     0.0026     9.5504    100.7063   54108.05   7471.52    -8839.0   -8814.457    24.104   
   6600     10551.34    4.9165     2.9931     1.8933     1.1602     0.6579     0.0027     10.105    101.8941   54099.77   7462.13    -8867.0   -8842.604    24.131   
   6700     10702.92    4.8977     2.9832     1.8644     1.1432     0.6255     0.0027     9.8346    100.6461   53986.85   7461.77    -8841.0    -8817.12    24.138   
   6800     10858.21    4.9381     3.0077     1.8935     1.173      0.6161     0.0024     9.6745    101.3994   54229.27   7470.33    -8844.0   -8819.633    24.301   
   6900     11016.93    4.9286     3.0005     1.8599     1.1466     0.6643     0.0025     9.1632    101.3397   54295.66   7475.33    -8875.0   -8850.208    24.453   
   7000     11167.19    4.9359     2.9979     1.8909     1.1658     0.4946     0.0025     9.1453    101.3518   54301.29   7461.45    -8854.0   -8829.292    24.389   
   7100     11321.46    4.9285     3.0022     1.8532      1.14      0.4584     0.0026     8.9681    101.8754   54320.64   7460.73    -8813.0   -8788.168    24.346   
   7200     11480.45    4.941      3.0083     1.8579     1.1458     0.4353     0.0025     8.9737    102.2555   54364.14   7467.51    -8854.0   -8830.075    24.412   
   7300     11633.57    4.9176     2.9898     1.8757      1.15      0.5151     0.0026     8.9129    102.1807   54285.61   7466.87    -8846.0   -8821.242    24.355   
   7400     11790.43    4.9381     3.006      1.8686     1.144      0.508      0.0027     8.8809    101.6692   54245.74   7460.21    -8850.0   -8825.264    24.415   
   7500     11946.83    4.9401     3.0066     1.853      1.1388     0.413      0.0026     9.3326    102.1635   54403.87   7450.36    -8851.0   -8826.427    24.399   
   7600     12102.48    4.9428     3.0106     1.8577     1.1414     0.4394     0.0027     8.2897    102.0424   54183.5    7469.18    -8815.0   -8791.043    24.396   
   7700     12257.18    4.9377     3.0086     1.8414     1.133      0.3526     0.0025     8.1074    102.2887   54213.05   7456.73    -8835.0   -8810.962    24.432   
   7800     12411.32    4.9324     3.0032     1.8541     1.1426     0.3312     0.0025     7.2603    102.736    54037.74   7451.54    -8876.0   -8851.573    24.549   
   7900     12567.8     4.9441     3.0116     1.8623     1.1486     0.3738     0.0025     7.9206    102.9736   54210.94   7470.26    -8806.0   -8781.434    24.669   
   8000     12721.74    4.9216     2.994      1.8359     1.1198     0.3574     0.0027     8.0794    102.8945   54244.4    7465.03    -8803.0   -8778.213    24.794   
   8100     12876.4     4.9405     3.0043     1.8154     1.1124     0.3889     0.0026     7.9957    102.739    54180.39   7445.71    -8867.0   -8842.219    24.747   
   8200     13033.42    4.9217     2.9981     1.8549     1.1416     0.3104     0.0024     7.8439    103.7621   54182.09   7451.52    -8824.0   -8799.311    24.79    
   8300     13189.32    4.943      3.0069     1.8354     1.1242     0.4705     0.0025     8.4324    103.2211   54286.5    7443.06    -8827.0   -8802.214    24.855   
   8400     13342.24    4.9542     3.018      1.8443     1.1376     0.4021     0.0025     9.0066    104.0517   54321.73   7461.42    -8843.0   -8818.112    24.844   
   8500     13494.87    4.9508     3.0174     1.8734     1.1554     0.4218     0.0026     8.8156    103.9444   54249.47   7468.86    -8809.0   -8783.678    24.896   
   8600     13647.38    4.9658     3.0256     1.8696     1.149      0.3926     0.0025     9.0885    104.0319   54218.49    7467.3    -8851.0   -8825.879    24.936   
   8700     13801.87    4.9668     3.0221     1.8441     1.1264     0.4212     0.0026     8.939     104.5928   54264.75    7458.5    -8827.0   -8802.546    24.88    
   8800     13956.72    4.9723     3.0283     1.8427     1.1336     0.4321     0.0026     9.4206    104.3902   54117.12   7477.41    -8891.0   -8866.423    24.93    
   8900     14112.04    4.9783     3.0276     1.8603     1.1442     0.4583     0.0025    10.1924    104.4569   54370.68   7469.35    -8838.0   -8813.504    24.973   
   9000     14267.97    4.9564      3.02      1.8461     1.1452     0.4993     0.0026    10.0112    104.6219   54170.75   7466.79    -8837.0   -8811.722    24.905   
   9100     14423.38    4.9674     3.0284     1.8347     1.1386     0.4073     0.0024     9.6072    104.1786   54251.43   7470.69    -8845.0   -8819.701    24.993   
   9200     14578.74    4.9751     3.0319     1.8556     1.1468     0.4272     0.0024     9.7195    104.7978   54215.08   7470.94    -8841.0   -8816.411    25.089   
   9300     14735.67    4.9749     3.032      1.8482     1.1482     0.4222     0.0026     9.7446    105.7142   54188.35    7468.7    -8845.0   -8820.433    25.037   
   9400     14891.36    4.9736     3.0328     1.8578     1.1452     0.4009     0.0026     8.6446    106.1886   54342.62   7468.09    -8843.0   -8818.108    25.047   
   9500     15046.85    4.9739     3.0338     1.8761     1.1686     0.4163     0.0025     8.5612    105.8491   54047.45   7475.72    -8846.0   -8820.904    25.02    
   9600     15200.13    4.9724     3.0347     1.8453     1.1444     0.375      0.0024     8.4786    106.3799   54225.67   7463.95    -8828.0   -8802.815    24.996   
   9700     15355.75    4.9932     3.0428     1.8709     1.1686     0.4016     0.0023     9.0273    107.1875   54217.98   7482.47    -8842.0   -8817.399    24.998   
   9800     15510.4     4.9878     3.0407     1.8498     1.1612     0.4513     0.0025     9.329     106.122    54173.3     7479.2    -8848.0   -8822.964    24.982   
   9900     15665.85    4.9785     3.0278     1.8078     1.1094     0.445      0.0025     8.8274    106.2838   54339.64   7456.08    -8841.0   -8815.612    25.08    
  10000     15818.65    4.9821     3.0321     1.832       1.13      0.3544     0.0024     8.9473    105.9533   54421.7    7460.25    -8804.0   -8778.744    25.122   
  10100     15968.74    4.9821     3.0414     1.8142     1.1274     0.4505     0.0024     8.847     106.4371   54424.42    7457.1    -8849.0   -8823.504    25.111   
  10200     16122.67    4.9705     3.027      1.7912     1.1096     0.301      0.0023     8.2549    106.1154   54345.44   7450.34    -8809.0   -8783.902    24.986   
  10300     16279.81    4.9746     3.0274     1.8156     1.1296     0.397      0.0023     8.1434    106.3339   54313.83   7453.18    -8813.0   -8787.974    24.97    
  10400     16441.52    4.9885     3.0394     1.8289     1.1376     0.3703     0.0025     8.3747    106.9528   54282.08   7464.21    -8835.0   -8810.263    25.004   
  10500     16598.92    4.9983     3.0411     1.8328     1.1368     0.377      0.0024     9.1659    107.2635   54399.17    7475.6    -8830.0   -8804.507    25.046   
  10600     16754.57    5.0085     3.0504     1.8476     1.1552     0.5314     0.0024     9.8379     107.81    54439.81   7480.51    -8873.0   -8847.798    25.082   
  10700     16909.19    4.9985     3.0438     1.8424     1.1544     0.6305     0.0027     9.4671    108.517    54469.47   7475.26    -8881.0   -8856.005    25.125   
  10800     17065.98    4.9838     3.0297     1.843       1.14      0.4796     0.0024     9.604     107.8666   54432.65   7465.77    -8841.0   -8815.562    25.132   
  10900     17219.13    4.9926     3.0336     1.8535     1.149      0.5118     0.0025    10.0039    107.8059   54415.79   7469.98    -8884.0    -8859.15    25.108   
  11000     17371.19    4.9985     3.0386     1.8559     1.1538     0.536      0.0024     9.4847    108.2003   54453.75   7469.55    -8865.0   -8839.958    25.13    
  11100     17524.26    5.003      3.0425     1.8642     1.1574     0.5442     0.0026     9.776     109.2088   54379.81   7461.99    -8888.0   -8862.966    25.171   
  11200     17677.36    4.9953     3.0414     1.8642     1.1604     0.5894     0.0025     9.8978    109.1666   54553.83   7487.53    -8864.0   -8839.105    25.153   
  11300     17832.28    4.9772     3.0336     1.8283     1.1334     0.4955     0.0026    10.0338    108.2537   54300.19    7469.6    -8883.0   -8857.647    25.121   
  11400     17987.41    4.9845     3.0364     1.8432     1.1398     0.4965     0.0026     9.5182    108.4014   54504.3    7450.84    -8867.0   -8842.299    25.177   
  11500     18145.24    4.9801     3.0384     1.8179     1.129      0.3439     0.0022     9.2033    108.0982   54204.25   7464.81    -8822.0   -8796.645    25.282   
  11600     18303.7     4.9907     3.0433     1.822      1.124      0.3811     0.0023     9.1472    108.2069   54252.75    7471.9    -8830.0   -8804.968    25.17    
  11700     18459.88    4.9777     3.0268     1.8283     1.1346     0.4022     0.0024     9.8255    109.202    54317.65   7446.83    -8825.0   -8799.578    25.138   
  11800     18617.86    4.9758     3.0322     1.8128     1.1256     0.3555     0.0025     9.5991    108.6681   54314.45   7448.33    -8811.0   -8786.038    25.165   
  11900     18778.0     4.9957     3.0456     1.835      1.1494     0.3537     0.0025     9.1045    109.2116   54272.51   7467.79    -8835.0   -8810.208    25.138   
  12000     18942.43    4.9955     3.0457     1.8415     1.151      0.3486     0.0026     9.5189    110.001    54267.22   7465.15    -8838.0   -8813.174    25.08    
