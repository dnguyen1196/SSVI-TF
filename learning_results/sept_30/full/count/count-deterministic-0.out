Generating synthetic count valued data ... 
Generating synthetic  count valued data took:  99.43867707252502
max_count =  71  min count =  0
Evaluation for true params: 
 test_rsme | train_rsme | rel-te-err | rel-tr-err |  test_nll  |  train_nll |
2.6875602319 2.6812497086   1.51845      1.516555    1476249.34   5913509.14 
Using  0.05 of training data
Factorizing with max_iteration = 12000  fixing covariance?:  False
Tensor dimensions:  [100, 100, 100]
Optimization metrics: 
Using Ada Grad
Mean update scheme:  S
Covariance update :  N
Using diagonal covariance?:  False
Random start? True
k1 samples =  32  k2 samples =  128
eta =  1.0  cov eta =  1.0  sigma eta =  1
iteration |   time   |test_rsme |rel-te-err|train_rsme|rel-tr-err|   d_mean  |   d_cov  |avg_grad_m|avg_grad_c| test_nll | train_nll |    VLB   |  E-term  |    KL     
    0         1.55     11.1658     6.9937     11.145     6.9883     2.2361     0.1838     0.6422     0.6294   1560537.86  312241.3  -692920.0  -692894.872   25.468   
    5        430.39    11.1686     6.9945    11.1462     6.988      2.2361     0.2696     4.8336     5.0543   1557263.68 311531.03  -692695.0  -692671.106   23.891   
    10       871.76    11.1717     6.996     11.1486     6.9892     2.2361     0.2696    10.1169     10.241   1551257.72 310239.82  -692640.0  -692618.099   22.306   
    20      1329.86    11.1811     6.9988    11.1539     6.9888     2.2361     0.2846     24.125    24.9484   1543523.93 308474.15  -692506.0  -692486.496   19.788   
    50      1839.06    11.2138     7.0107    11.1702     6.9842     2.2361     0.2846    87.1987    88.5976   1522804.5  303663.49  -692248.0  -692232.538   15.804   
   100       2426.3    11.2131     6.9771    11.1164     6.916      2.2361     0.2846    310.3685   305.5622  1519999.51 301785.68  -672423.0  -672398.952   24.322   
   200      3136.91     10.451     6.3004    10.2878     6.2019     2.2209     0.1759   1229.8549   813.6253  1291731.66 254210.96  -461611.0  -461590.414   20.931   
   300      3820.21     8.6305     4.9915     8.3982     4.8664     2.0135     0.0669   1551.4902   1333.377  891153.76  172496.01  -233454.0  -233433.779   20.405   
   400      4523.71     6.9738     3.9277     6.687      3.7796     1.6563     0.0383    970.7593  1237.2679  640673.36   121980.2  -138195.0  -138174.323   20.561   
   500       5260.1     5.9917     3.4282     5.6722     3.2587     1.662      0.037     510.9695   969.3411  541107.56  102084.59  -109945.0  -109924.999   19.99    
   600      6004.02     5.3842     3.078      5.0411     2.8966     1.4859     0.0417    338.7962   821.5112  488401.55   91845.14   -97957.0  -97936.881   20.024   
   700      6753.38     4.9899     2.9074     4.6463     2.7271     1.2987     0.0355    268.4221   885.139   461569.82   87054.3    -91978.0  -91958.125   19.815   
   800      7501.98     4.7081     2.7482     4.3611     2.5684     1.397      0.0337    219.6488   827.0509  442048.08   83310.57   -88057.0  -88036.932   19.816   
   900      8251.03     4.5079     2.6787     4.1728     2.5028     1.2782     0.0315    187.9144   868.7093  430223.02   81351.65   -85417.0  -85397.292   19.549   
   1000     9000.48     4.355      2.5758     4.0236     2.3984     1.1933     0.029     162.6318   827.5079  418649.16   79105.22   -83257.0  -83237.735   19.407   
   1100     9750.17     4.2399     2.5388      3.92      2.3672     1.0676     0.0291    141.9299   874.6449  413617.76   78362.06   -82115.0  -82095.84    18.999   
   1200     10501.42    4.1584     2.4742     3.8403     2.3017     1.154      0.0273    125.1389   818.3974  407581.23   77042.55   -81081.0  -81062.638   18.794   
   1300     11251.32    4.1099     2.4823     3.7977     2.3084     1.2054     0.0258    121.8322   893.2444  407210.49   77175.3    -80787.0  -80768.753   18.138   
   1400     12000.83    4.0411     2.4141     3.7293     2.2425     0.8213     0.0251    117.6285   812.4987   400313.3   75761.13   -79706.0  -79688.297   17.731   
   1500     12751.65    4.0006     2.434      3.6922     2.2591     1.0858     0.0246    108.3405   893.5124  400982.31   75883.43   -79311.0  -79293.125   17.902   
   1600     13501.39    3.9683     2.3813     3.6657     2.2109     0.9301     0.0237    94.4658    833.0823  397045.52   74966.08   -78740.0  -78722.556   17.72    
   1700     14250.3     3.9406     2.3868     3.6403     2.2138     0.7942     0.0237    86.3504    864.5607  396190.18   74824.73   -78347.0  -78329.673   17.225   
   1800     14999.42    3.9127     2.3522     3.6186     2.1826     0.6991     0.0222    88.5462    850.7829  394373.69   74357.86   -78117.0  -78099.943   17.352   
   1900     15749.15    3.9081     2.3751     3.6094     2.1993     0.8741     0.0217    85.9855    877.1194   395031.6   74421.91   -78016.0  -77998.417   17.113   
   2000     16499.75    3.8947     2.3571     3.5931     2.1799     0.7293     0.0214    84.1424    868.8777   394917.1   74245.2    -77988.0  -77971.172   17.203   
   2100     17250.67    3.8728     2.357      3.5775     2.1786     0.6555     0.0204    87.8061    858.657   393349.84   73938.8    -77486.0  -77469.443   16.865   
   2200     18001.16    3.8556     2.3362     3.5627     2.158      0.6505     0.0205    79.9061    863.8719  391965.37   73543.59   -77292.0  -77274.267   17.297   
   2300     18750.72    3.8614     2.3533     3.5664     2.1722     0.6956     0.0197    82.4071    879.3062  392876.38   73750.81   -77288.0  -77271.045   17.102   
   2400     19501.4     3.849      2.337      3.5555     2.1553     0.6832     0.0191    84.8855    843.781   392538.73   73404.55   -77203.0  -77186.367   16.979   
   2500     20252.2     3.8446     2.3407     3.544      2.153      0.7653     0.0181    79.1619    869.3715  391599.74   73198.35   -76845.0  -76828.193   16.733   
   2600     21003.47    3.8281     2.3236     3.5332     2.141      0.703      0.0178    71.2474    866.0966  390601.53   72872.14   -76586.0  -76569.82    16.518   
   2700     21754.08    3.8319     2.3325     3.5311     2.1425     0.7602     0.0176     67.65     853.0694  390967.19   72861.06   -76566.0  -76549.523   16.975   
   2800     22503.24    3.8241     2.3179     3.5247     2.1269     0.6556     0.018     70.3809     858.81   390341.01   72591.55   -76402.0  -76385.443   16.934   
   2900     23252.76    3.8179     2.3244     3.5147     2.1314     0.6388     0.0177     75.287    869.148    390875.5   72600.65   -76342.0  -76325.31    16.941   
   3000     24003.0     3.8231     2.3255     3.5147     2.1266     0.9444     0.0168    72.6022    865.3729   390728.0   72469.17   -76198.0  -76181.389   16.963   
   3100     24753.51    3.8202     2.3253     3.5057     2.1205     0.9546     0.0162    70.2275    857.3364  390875.26   72354.76   -76072.0  -76055.036   16.941   
   3200     25502.67    3.8141     2.3155     3.5036     2.1142     0.609      0.0159    68.2342    837.6873   390394.3   72141.53   -75995.0  -75977.345   17.167   
   3300     26252.13    3.8144     2.3225     3.4956     2.1137     0.6181     0.0156    68.6695    857.7621  390626.38   72067.08   -75899.0  -75881.611   17.076   
   3400     27002.69    3.811      2.3218     3.496      2.1112     0.7147     0.0153    64.6716    861.4172  390387.74   71934.56   -75737.0  -75720.197   16.781   
   3500     27752.72    3.8087     2.3119     3.489      2.0997     0.6893     0.0152    66.6297    848.4562   390342.0   71801.27   -75672.0  -75655.479   16.949   
   3600     28503.0     3.8132     2.3276     3.4866     2.1056     0.809      0.0147    70.2481    861.148   390712.04   71868.47   -75583.0  -75565.974   16.813   
   3700     29253.59    3.8003     2.309      3.4837     2.0968     0.8668     0.0146    73.0706    843.0833  390282.66   71610.11   -75579.0  -75562.287   16.718   
   3800     30002.32    3.7959     2.3104     3.4731     2.0896     0.7387     0.015      68.39     844.5779  389804.04   71448.54   -75312.0  -75295.716   16.711   
   3900     30751.72    3.7991     2.3135     3.4793     2.0945     0.7199     0.014     70.7157    862.8215  389939.96   71554.29   -75386.0  -75369.555   16.452   
   4000     31500.52    3.7958     2.3097     3.4771     2.0903     0.511      0.014     66.8014    847.4155  389653.62   71368.13   -75209.0  -75192.624   16.461   
   4100     32247.74    3.7911     2.3065     3.4659     2.0852     0.545      0.0134     66.872    855.6766  389323.89   71237.47   -75063.0  -75046.789   16.592   
   4200     32995.65    3.799      2.3221     3.4683     2.096      0.5334     0.0135    67.6549    852.9325  390179.21   71350.67   -75095.0  -75078.314   16.687   
   4300     33743.57    3.797      2.3152     3.4696     2.0878     0.5042     0.0134     65.025    840.8867  389952.28   71260.62   -75028.0  -75012.049   16.449   
   4400     34492.96    3.7926      2.31      3.4594     2.0781     0.7739     0.0132    64.3249    847.3613  389457.02   70999.48   -74840.0  -74823.401   16.522   
   4500     35242.04    3.7953     2.3123     3.4593     2.078       0.52      0.013     66.3962    838.952    390231.0   71046.28   -74876.0  -74859.351   16.933   
   4600     35991.66    3.7916     2.3115     3.4556     2.0791     0.5998     0.0126    71.3303    843.5615   390248.4   71006.72   -74918.0  -74900.972   17.118   
   4700     36739.5     3.7924     2.3108     3.4548     2.0743     0.4768     0.0131    71.8639    845.0067  389894.94   70866.34   -74737.0  -74720.822    16.6    
   4800     37489.31    3.7933     2.314      3.4516     2.0754     0.8032     0.0131    70.3258    839.3346  390357.49   70856.82   -74780.0  -74763.757   16.658   
   4900     38236.12    3.7896     2.3102     3.4515     2.0745     0.4451     0.0142     68.642    847.9841  389936.42   70763.67   -74622.0  -74605.708   16.771   
   5000     38985.44    3.7952     2.3141     3.4486     2.0711     0.6826     0.0121    66.0755    840.3002  389841.94   70707.14   -74561.0  -74544.226   17.108   
   5100     39732.75    3.7901     2.3092     3.4444     2.0622     0.491      0.0123    67.6455    851.8262  389821.54   70544.65   -74434.0  -74417.448   16.638   
   5200     40481.66    3.7828     2.3017     3.4372     2.0564     0.7132     0.012     61.9903    838.9568  389701.76   70484.17   -74441.0  -74424.405   16.465   
   5300     41230.04    3.788      2.3165     3.4442     2.0687     0.5562     0.012     73.6908    858.0951  390062.27   70595.11   -74433.0  -74416.987   16.386   
   5400     41978.91    3.7823     2.3031     3.4353     2.0595     0.5425     0.0114    66.1273    833.1024  389154.99   70324.53   -74252.0  -74235.367   16.607   
   5500     42727.11    3.7771     2.3021     3.4324     2.0546     0.5309     0.0113    62.9516    843.6985  388773.21   70245.66   -74143.0  -74125.866   16.651   
   5600     43472.98    3.7758     2.3029     3.4302     2.0544     0.4929     0.0117    62.7215    848.3937  389400.64   70210.65   -74117.0  -74100.081   16.608   
   5700     44220.38    3.7753     2.3069     3.4274     2.056      0.4865     0.0113    68.4771    855.3018  389389.46   70336.27   -74186.0  -74169.824   16.431   
   5800     44975.98    3.7718     2.3042     3.4284     2.0558     0.5474     0.0112    66.3644    845.6194  388550.56   70197.7    -74042.0  -74025.514   16.783   
   5900     45732.08    3.771      2.2983     3.4193     2.0455     0.4337     0.0113    63.3809    834.6091  388325.78   70070.5    -73931.0  -73913.774   16.799   
   6000     46480.69    3.7674     2.2976     3.4171     2.0465     0.5378     0.0111    59.4826    842.5687  388483.77   70008.05   -73868.0  -73851.672   16.707   
   6100     47228.93    3.7697     2.2974     3.4224     2.0476     0.608      0.0106    62.8911    848.137   388351.06   69984.45   -73839.0  -73822.109   16.997   
   6200     47976.28    3.7651     2.2947     3.4162     2.0406     0.5718     0.0127    63.4589    832.1577  388610.74   69902.16   -73741.0  -73723.598   16.931   
   6300     48726.01    3.7659     2.2993     3.4109     2.0416     0.5356     0.0106    65.1982    853.2905  388341.72   69955.67   -73784.0  -73767.564   16.878   
   6400     49478.52    3.7607     2.2929     3.4133     2.0404     0.4563     0.0108    63.3176    839.381   388125.72   69824.16   -73682.0  -73664.974   17.023   
   6500     50232.78    3.7584     2.2945     3.4114     2.0416     0.5895     0.0109    60.9491    836.7833   387964.4   69836.06   -73664.0  -73647.111   17.013   
   6600     50986.36    3.7631     2.2957     3.4092     2.0382     0.4482     0.0103    63.8271    838.9253  387856.63   69776.77   -73578.0  -73561.516   16.981   
   6700     51741.9     3.7567     2.292      3.4088     2.0409     0.4339      0.01      62.119    848.5877  387793.24   69724.01   -73554.0  -73537.15    16.708   
   6800     52496.72    3.7569     2.2915     3.4067     2.0362     0.4735     0.0102    63.3262    842.7833  387988.22   69732.99   -73629.0  -73612.513   16.524   
   6900     53251.69    3.755      2.289      3.4042     2.0372     0.5246     0.0097     66.568    850.2202  387694.19   69713.28   -73586.0  -73569.686   16.508   
   7000     54004.24    3.7549     2.2871     3.402      2.0322     0.4591     0.0098    67.0655    832.1768  387905.63   69638.89   -73497.0  -73479.782    16.8    
   7100     54757.53    3.7523     2.288      3.397      2.0292     0.5309     0.0097     65.435    833.0658  387503.12   69570.05   -73409.0  -73392.098   16.875   
   7200     55510.92    3.7526     2.2862     3.3967     2.026      0.5547     0.0096    62.9414    843.1882  387775.21   69501.98   -73342.0  -73325.204   16.991   
   7300     56263.45    3.7454     2.2794     3.3932     2.0228     0.477      0.0099    58.2451    830.2249  387015.76   69409.95   -73286.0  -73269.23    17.185   
   7400     57015.89    3.7502     2.2885     3.3938     2.0268     0.4507     0.0101    60.1244    850.5121  387310.92   69446.0    -73244.0  -73226.734   17.194   
   7500     57767.23    3.7468     2.2805     3.3887     2.017      0.3876     0.0094     58.843    832.3138  387072.56   69339.81   -73195.0  -73177.662   17.198   
   7600     58516.71    3.749      2.2829     3.3918      2.02      0.4363     0.0101    61.1692    843.119   386904.43   69319.7    -73153.0  -73136.202   17.088   
   7700     59267.24    3.7403     2.2789     3.3838     2.0163     0.5147     0.0106    61.3375    838.7937  386379.13   69291.42   -73137.0  -73120.326   16.992   
   7800     60018.48    3.7403     2.2822     3.3892     2.0227     0.494      0.0095    63.1939    851.4074  386428.84   69360.46   -73096.0  -73079.124   16.925   
   7900     60768.88    3.7362     2.2756     3.3793     2.0116     0.4611     0.009     65.3977    831.0097  386549.12   69186.51   -73067.0  -73050.527   16.859   
   8000     61519.37    3.7389     2.2837     3.3799     2.0193     0.5516     0.0091     59.606    850.0559  386279.53   69320.51   -73062.0  -73044.644   17.079   
   8100     62269.15    3.7324     2.2717     3.3786     2.0132     0.6683     0.0092    65.9417    828.7158  386111.46   69186.21   -73044.0  -73026.718   16.793   
   8200     63020.54    3.7296     2.273      3.3767      2.01      0.4948     0.0089    65.5532    841.9714  385875.77   69097.48   -72937.0  -72920.379   16.587   
   8300     63771.42     3.73      2.2716     3.3776     2.0096     0.4781     0.0086    63.4309    843.0981  385670.35   69074.75   -72912.0  -72895.212   16.584   
   8400     64522.14    3.7239     2.269      3.3711     2.0084     0.4395     0.0088    61.7414    846.1099   385250.3   69038.73   -72837.0  -72820.09    16.545   
   8500     65274.94    3.7288     2.2751     3.369      2.0099     0.4502     0.0086    59.5764    853.1255  385235.93   69056.75   -72752.0  -72735.914   16.444   
   8600     66026.6     3.7228     2.2624      3.37      2.0018     0.3859     0.0089    62.4873    818.3903  385367.53   68872.91   -72803.0  -72785.994   16.52    
   8700     66775.68    3.7282     2.2742     3.3705     2.0103     0.5021     0.0082    65.8346    862.6711  385419.18   69039.88   -72780.0  -72764.086   16.251   
   8800     67527.14    3.7247     2.2672     3.3642      2.0       0.3741     0.0083    62.6053    825.8274  384997.85   68847.64   -72655.0  -72638.265   16.57    
   8900     68276.98    3.7226     2.2674     3.3644     2.0002     0.4917     0.0086    57.7598    841.7085  385121.02   68880.07   -72636.0  -72619.412   16.704   
   9000     69024.95    3.7202     2.2651     3.3608     2.0007     0.4043     0.0084    61.6043    835.3714  384589.94   68788.52   -72588.0  -72571.076   16.623   
   9100     69772.75    3.7207     2.2624     3.3611     1.9974     0.4598     0.0085     63.747    841.3108   384966.3   68761.93   -72613.0  -72596.699   16.588   
   9200     70521.78    3.7214     2.2682     3.3597     1.9996     0.4196     0.0082    63.7054    854.9719   384737.1   68799.6    -72563.0  -72546.09    16.531   
   9300     71268.6     3.7193     2.2668     3.3543     1.9973     0.5137     0.0084    60.1959    853.6392  384802.69   68786.89   -72542.0  -72525.688   16.657   
   9400     72018.28    3.7141     2.2565     3.3543     1.9893     0.439      0.008     62.1692    830.7667  384643.52   68674.62   -72561.0  -72544.567   16.711   
   9500     72766.67    3.7174     2.2599     3.3562     1.9919     0.4805     0.0081    63.7111    841.9116  384287.45   68657.66   -72500.0  -72483.666   16.776   
   9600     73517.77    3.7158     2.259      3.3477     1.985      0.4613     0.008     58.8274    839.1095  384154.97   68583.64   -72347.0  -72330.91    16.415   
   9700     74267.11    3.7127     2.2587     3.3486     1.9854     0.5005     0.0088    57.6566    844.1093  384336.25   68561.09   -72376.0  -72359.556   16.396   
   9800     75016.67    3.7121     2.2593     3.3455     1.9876     0.411      0.0074    63.5374    858.5817  383905.06   68583.06   -72289.0  -72272.598   16.683   
   9900     75767.05    3.7056     2.2519     3.3465     1.9834     0.4265     0.0084    56.7783    829.0467  383580.03   68428.78   -72247.0  -72230.098   16.832   
  10000     76516.93    3.709      2.2589     3.3442     1.9875     0.4421     0.0083    59.0905    854.5481  383944.97   68518.71   -72327.0  -72310.599   16.728   
  10100     77266.24    3.7072     2.2542     3.3436     1.9841     0.4526     0.0078    62.3212    840.238   383317.65   68477.62   -72276.0  -72259.029   16.626   
  10200     78015.9     3.7114     2.2608     3.3454     1.988      0.4312     0.008     66.5654    851.9814  383922.31   68555.48   -72305.0  -72289.006   16.465   
  10300     78765.14    3.707      2.2548     3.3445     1.9842     0.4153     0.0083    61.1151    832.9076   383498.9   68442.11   -72219.0  -72202.738   16.527   
  10400     79516.74    3.7045     2.2519     3.3419     1.9827     0.5699     0.0083    59.8372    838.9421  383155.52   68387.67   -72150.0  -72133.654   16.691   
  10500     80265.19    3.705      2.256      3.3437     1.988      0.4377     0.0075    61.5988    852.0213  383312.15   68468.85   -72223.0  -72205.884   16.686   
  10600     81015.37    3.6988     2.2421     3.3381     1.976      0.5297     0.0073    62.7584    833.1254  383009.61   68310.54   -72117.0  -72100.305   16.794   
  10700     81766.9     3.7001     2.2513     3.3417     1.9829     0.433      0.0075     59.631    847.9293  382691.62   68398.4    -72077.0  -72060.22    16.95    
  10800     82517.04    3.698      2.2482     3.3379     1.981      0.3582     0.0069    59.4804    841.3678  382496.15   68346.05   -72089.0  -72072.504   16.743   
  10900     83268.93    3.6992     2.2482     3.333      1.9749     0.4524     0.0069    61.8877    844.3466  382817.47   68310.23   -72055.0  -72037.668   16.913   
  11000     84018.89    3.6985     2.2457     3.3282     1.9714     0.5207     0.0109    56.4423    834.7992   382492.2   68274.79   -72031.0  -72014.005   17.166   
  11100     84768.61    3.6961     2.2468     3.3287     1.9734     0.449      0.0103    56.7001    846.2391  382173.32   68261.97   -71905.0  -71888.117   16.786   
